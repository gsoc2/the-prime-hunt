(()=>{"use strict";var e,t={5673:(e,t,r)=>{var n,o;r.d(t,{$b:()=>o,H$:()=>s,Kt:()=>n}),function(e){e.production="production",e.development="development"}(n||(n={})),function(e){e.info="info",e.debug="debug",e.error="error",e.warn="warn"}(o||(o={}));const s=e=>e},9896:(e,t,r)=>{r.d(t,{Mq:()=>s,dm:()=>a});var n=r(2167),o=r(5673);Object.values(n.bA).includes(null),Object.values(n.bA).includes(null);const s="production"===o.Kt.production?o.Kt.production:o.Kt.development,a=Object.keys(o.$b).includes("info")?"info":o.$b.info},5656:(e,t,r)=>{r.d(t,{C$:()=>s,pM:()=>i});var n=r(5673),o=r(9896);let s,a=o.Mq===n.Kt.development||o.dm===n.$b.debug;const i=e=>{a=e};class c{prefix="";level=n.$b.info;createInstance(e="",t=n.$b.info){return new c(e,t)}constructor(e="",t=n.$b.info){this.prefix=e,this.level=t}log(...e){(this.level!==n.$b.debug||a)&&console[this.level===n.$b.error?"error":this.level===n.$b.warn?"warn":"log"](this.prefix||"==>",...e)}error(){return this.createInstance(`ERROR: ${this.prefix}`,n.$b.error)}warn(){return this.createInstance(`WARN: ${this.prefix}`,n.$b.warn)}info(){return this.createInstance(`INFO: ${this.prefix}`,n.$b.info)}debug(){return this.createInstance(`DEBUG: ${this.prefix}`,n.$b.debug)}addPrefix(e){return this.createInstance([this.prefix,e].join(" "),this.level)}setLevel(e){return this.createInstance(this.prefix,e)}setPrefix(e){return s=this.addPrefix(e),s}}s=new c},5745:(e,t,r)=>{r.d(t,{Nm:()=>s,a9:()=>n,oZ:()=>o});const n=e=>"background"===e?"bg ==>":"content"===e?"cs ==>":"inline"===e?"is ==>":"app"===e?"app ==>":"unknown ==>",o=e=>{let t=(e||"").slice(0,3).toLowerCase();return"app"===t?"app":(t=t.slice(0,2),"bg"===t?"background":"cs"===t?"content":"is"===t?"inline":"unknown")},s="debug-external-der3edc3op3e4dde44rt"},2167:(e,t,r)=>{var n,o,s,a,i;r.d(t,{TT:()=>i,bA:()=>o,by:()=>a}),function(e){e.chrome="chrome",e.firefox="firefox",e.edge="edge"}(n||(n={})),function(e){e.MicrosoftSentinel="MicrosoftSentinel",e.MicrosoftDefender="MicrosoftDefender",e.Splunk="Splunk",e.QRadar="QRadar",e.Elastic="Elastic",e.OpenSearch="OpenSearch",e.ArcSight="ArcSight",e.Athena="Athena",e.LogScale="LogScale",e.Chronicle="Chronicle"}(o||(o={})),function(e){e.ElasticEQl="ElasticEql"}(s||(s={})),function(e){e.Sentinel="ala",e.Defender="mdatp",e.Splunk="splunk",e.Qradar="qradar",e.ElasticEQL="es-eql",e.ElasticLucene="elasticsearch",e.ArcSight="arcsight-keyword",e.Athena="athena",e.LogScale="humio",e.Chronicle="chronicle-query",e.OpenSearch="opendistro-query"}(a||(a={})),function(e){e.MicrosoftSentinel="Microsoft Sentinel",e.MicrosoftDefender="Microsoft Defender For Endpoint",e.Splunk="Splunk",e.QRadar="IBM QRadar",e.Elastic="Elastic",e.OpenSearch="OpenSearch",e.ArcSight="ArcSight",e.Athena="Amazon Athena",e.LogScale="Falcon LogScale",e.Chronicle="Chronicle"}(i||(i={}))}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=n(5745),n(5656).C$.setPrefix((0,e.a9)("inline")),(()=>{var e;!function(e){e.OnMessage="OnMessage"}(e||(e={}));var t,r=n(2167);!function(e){e.Accounts="Accounts",e.Assets="Assets"}(t||(t={}));Object.keys(t);const o=(e,t,r)=>{const n=document.createElement(e);return r?.attributes&&Object.keys(r.attributes).forEach((e=>{var t;n.setAttribute(e,"style"===e?(t=r.attributes[e],Object.keys(t).reduce(((e,r)=>e+`${r}:${t[r]};`),"")):r.attributes?.[e]||"")})),r?.innerHtml&&(n.innerHTML=r.innerHtml),r?.innerText&&(n.innerText=r.innerText),t&&t.append(n),n};var s=n(5673);const a=()=>Math.random().toString(36).substring(5)+Date.now().toString(36)+Math.random().toString(36).substring(5),i=(e,t)=>e>t?1:e<t?-1:0,c=e=>{if("number"==typeof e)return!0;if("string"!=typeof e)return!1;const t=e.trim();return!(!/^[-.0-9]*$/.test(t)||((e,t)=>{const r=[];let n=-1;for(;(n=e.indexOf(t,n+1))>=0;)r.push(n);return r})(t,".").length>1)&&!Number.isNaN(parseFloat(t))};var d,p=n(5745);!function(e){e[e.debugIDExternal=(0,s.H$)(p.Nm)]="debugIDExternal"}(d||(d={}));const u=()=>"undefined"!=typeof browser?browser:chrome,l=n(5656).C$.addPrefix("api-support"),g=(...e)=>!!window?.postMessage||(l.warn().log("API window.postMessage is not supported",...e),!1),f=(...e)=>!!u()?.runtime?.sendMessage||(l.warn().log("API runtime.sendMessage is not supported",...e),!1),S=(...e)=>!!u()?.runtime?.getURL||(l.warn().log("API runtime.getURL is not supported",...e),!1),b={},h=[];b[e.OnMessage]=(e,...t)=>{if(((...e)=>!!u().runtime?.onMessage?.addListener||(l.warn().log("API runtime.onMessage.addListener is not supported",...e),!1))()){const r=u().runtime.onMessage;h.push((()=>{r.removeListener(e)})),r.addListener(((...t)=>{e(...t)}),...t)}if(!((...e)=>!!window?.addEventListener||(l.warn().log("API window.addEventListener is not supported",...e),!1))())return;const r=r=>{const n=r.data;r.origin!==window.location.origin||"content"!==(0,p.oZ)(n.type)&&n.externalType!==d.debugIDExternal||e(r.data,...t)};h.push((()=>{window.removeEventListener("message",r)})),window.addEventListener("message",r)};const y="inline-qradar.js";r.bA.MicrosoftSentinel,r.bA.MicrosoftDefender,r.bA.Splunk,r.bA.QRadar,r.bA.Elastic,r.bA.ArcSight,r.bA.Athena,r.bA.OpenSearch,r.bA.LogScale,r.bA.Chronicle;var m=n(5656);const A=(e,t,...r)=>!!e()&&(m.C$.debug().log(`got ${t.type} message`,t,...r),!0);var M;!function(e){e.CSConnectPlatform="CSConnectPlatform",e.CSSetDebugMode="CSSetDebugMode",e.CSDirectMessageToApp="CSDirectMessageToApp",e.CSDirectMessageToInline="CSDirectMessageToInline"}(M||(M={})),Object.values(M).forEach((e=>{if("content"!==(0,p.oZ)(e))throw new Error(`Wrong content message type "${e}"`)}));const w=n(5656).C$.addPrefix("services"),$=(e,t,r=!0)=>{t.id=`${t.id?`${t.id}--`:""}${a()}`;const n="sendMessage";try{return r||g(t)?r?f()?(u().runtime.sendMessage(t)?.catch((r=>e.error().addPrefix(n).log(r,t))),e.debug().addPrefix(n).log(t),t):t:(window.postMessage(t),e.debug().log("postMessage",t),t):t}catch(r){return e.error().addPrefix(n).log(r,t),t}},v=(e,t=!0)=>$(w.addPrefix("message-from-content"),e,t);var x,I;!function(e){e.ISModifyQuery="ISModifyQuery",e.ISSetQuery="ISSetQuery",e.ISGetQuery="ISGetQuery",e.ISSetDebugMode="ISSetDebugMode",e.ISRemoveHash="ISRemoveHash",e.ISRemoveFieldSpecification="ISRemoveFieldSpecification"}(x||(x={})),Object.values(x).forEach((e=>{if("inline"!==(0,p.oZ)(e))throw new Error(`Wrong inline message type "${e}"`)})),function(e){e.BGDirectMessageToApp="BGDirectMessageToApp",e.BGDirectMessageToInline="BGDirectMessageToInline",e.BGSetWatchers="BGSetWatchers",e.BGRegisterPlatformTab="BGRegisterPlatformTab",e.BGToggleShowExtension="BGToggleShowExtension",e.BGSetDebugMode="BGSetDebugMode",e.BGTakeCallbackMessage="BGTakeCallbackMessage"}(I||(I={})),Object.values(I).forEach((e=>{if("background"!==(0,p.oZ)(e))throw new Error(`Wrong background message type "${e}"`)}));class E{fields=new Set;static processInlineListeners(e){if(A((()=>M.CSSetDebugMode===e.type),e)){const{debugMode:t}=e.payload;n(5656).pM(t),v({...e,id:`${e.id}--${e.type}`,type:x.ISSetDebugMode},!1)}if(A((()=>M.CSDirectMessageToApp===e.type),e)&&v({id:`${e.id}--${e.type}`,type:I.BGDirectMessageToApp,payload:e.payload}),A((()=>M.CSDirectMessageToInline===e.type),e)){const{type:t,payload:r}=e.payload;v({id:`${e.id}--${e.type}`,type:t,payload:r},!1)}}}let D;class T extends E{static normalizedValue(e){const t=c(e)?parseFloat(e):e;return"number"==typeof t?t:`'${t.replace(/'/g,'"')}'`}buildQueryParts(e,t,r=!1){return((e,t,r,n,o,s)=>{const a=[];Object.keys(e).forEach((n=>{a.push(e[n].map((e=>`${o.leftOperand(n)}${t(n,e)}${o.rightOperand(e)}`)).join(r))}));const i=a.join(n);return s?`${s} ${i}`:i})(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>`"${e}"`,rightOperand:e=>T.normalizedValue(e)},r?"where":void 0)}connect(){T.setListeners(),D.debug().log("connected")}static setListeners(){((e,t,...r)=>{b[e]?.(((...e)=>{t(...e)}),...r)})(e.OnMessage,(async e=>{if(!document.querySelector("#aceEditor"))return;const t=`script[src$="${y}"]`;document.querySelector(t)||(T.connectInlineListener(),await(async(e,t=document)=>new Promise((r=>{new MutationObserver(((n,o)=>{const s=t.querySelector(e);s&&(o.disconnect(),r(s))})).observe(t,{childList:!0,subtree:!0})})))(t)),E.processInlineListeners(e)}))}static connectInlineListener(){var e;o("script",document.body,{attributes:{src:(e=y,S(e)?u().runtime.getURL(e):""),type:"text/javascript","data-type":"inline-listener"}})}static extensionDefaultPosition={top:0,left:0,width:500,height:400};defaultWatchers={[t.Accounts]:["Account Name","Recipients","Sender","Target Username","Username"],[t.Assets]:["Client Hostname","Destination Hostname","Destination IP","Hostname","Machine Identifier","Recipient Host","Sender Host","Source Hostname","Source Workstation","Source IP","Source Asset Name","Destination Asset Name"]};extensionDefaultPosition=T.extensionDefaultPosition;static id=r.bA.QRadar;getID(){return r.bA.QRadar}getName(){return r.TT.QRadar}getType(){return r.by.Qradar}}D=n(5656).C$.addPrefix(T.id);var k;!function(e){e.AppShowExtension="AppShowExtension",e.AppTakeResourceData="AppTakeResourceData",e.AppTakeNewResourceData="AppTakeNewResourceData",e.AppSyncWatchers="AppSyncWatchers",e.AppQueryHasHash="AppQueryHasHash",e.AppQueryHasSpecifyFields="AppQueryHasSpecifyFields",e.AppSetLoadingState="AppSetLoadingState",e.AppToggleShowExtension="AppToggleShowExtension",e.AppSendToBackground="AppSendToBackground",e.AppSendMessageOutside="AppSendMessageOutside",e.AppTakeQuery="AppTakeQuery",e.AppSetDebugMode="AppSetDebugMode",e.AppTakeCallbackMessageResult="AppTakeCallbackMessageResult"}(k||(k={})),Object.values(k).forEach((e=>{if("app"!==(0,p.oZ)(e))throw new Error(`Wrong app message type "${e}"`)}));const O=new T,R=n(5656).C$.addPrefix(O.getID()),L=()=>(e=>{try{return ace.edit(e)}catch(e){return null}})(document.querySelector("#aceEditor"));window.addEventListener("message",(e=>{const t=e.data;if(A((()=>x.ISModifyQuery===t.type),t,e)){const e=L();if(!e)return void R.error().log("editor not found",ace);const{resources:n,modifyType:a}=t.payload;let c=(e=>{const t=(e=>e.replace(/ +/g," "))((r=e,r.trim().replace(/(\r\n|\n|\r)/gm," "))).trim();var r;const{indexes:n,mappedIndexes:o}=["select","where","from","last","start","stop","limit","like","order by","group by","having","ilike"].reduce(((e,r)=>{const n=t.search(new RegExp(`${"select"===r?"^":"(\\s|\\t)"}${r}(\\s|\\t)`,"gi"));return n>-1&&(e.indexes.add(n),e.mappedIndexes.set(n,r)),e}),{indexes:new Set,mappedIndexes:new Map}),s=Array.from(n).sort(i);return s.reduce(((e,r,n)=>{const a=o.get(r),i=r,c=s[n+1]||t.length;return e[a]=t.substring(i,c).replace(new RegExp(a,"gi"),"").trim(),e}),{})})(e.getValue());"show all"===a&&(c={select:c.select,from:c.from}),c.where=(r=c.where||"",o=O.buildQueryParts(a,n),s="AND",r.length<1?o:`(${r}) ${s} ${o}`),e.setValue((e=>{let t=`SELECT ${e.select}`;return e.from&&(t+=` FROM ${e.from}`),e.where&&(t+=` WHERE ${e.where}`),e["group by"]&&(t+=` GROUP BY ${e["group by"]}`),e.having&&(t+=` HAVING ${e.having}`),e["order by"]&&(t+=` ORDER BY ${e["order by"]}`),e.like&&(t+=` LIKE ${e.like}`),e.ilike&&(t+=` ILIKE ${e.ilike}`),e.limit&&(t+=` LIMIT ${e.limit}`),e.last&&(t+=` LAST ${e.last}`),e.start&&(t+=` START ${e.start}`),e.stop&&(t+=` STOP ${e.stop}`),t})(c))}var r,o,s,c,d;if(A((()=>x.ISSetQuery===t.type),t,e)){const e=L();if(!e)return;const{value:r}=t.payload;e.setValue(r)}if(A((()=>x.ISGetQuery===t.type),t,e)){const e=L();if(!e)return;((c=e.getValue())||d)&&window.postMessage({id:a(),type:M.CSDirectMessageToApp,payload:{type:k.AppTakeQuery,payload:{queryValue:c,queryMeta:d}}})}if(A((()=>x.ISSetDebugMode===t.type),t,e)){const{debugMode:e}=t.payload;n(5656).pM(e)}})),R.debug().log("mounted")})()})();