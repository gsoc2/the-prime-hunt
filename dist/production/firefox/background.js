(()=>{"use strict";var e={4470:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.http=t.Http=void 0;class s{request(e,t,s){const r=(null==s?void 0:s.onJSONSuccess)?"json":"text";fetch(e,t).then((e=>"json"===r?e.json():e.text())).then((e=>{var t,o;return"json"===r?null===(t=null==s?void 0:s.onJSONSuccess)||void 0===t?void 0:t.call(s,e):null===(o=null==s?void 0:s.onTextSuccess)||void 0===o?void 0:o.call(s,e)})).catch((e=>{var t;null===(t=null==s?void 0:s.onError)||void 0===t||t.call(s,e)}))}get(e,t){return this.request(e.url,{headers:(null==e?void 0:e.headers)||{},method:"GET"},t)}post(e,t){return this.request(e.url,{headers:(null==e?void 0:e.headers)||{},method:"POST",body:e.body||""},t)}}t.Http=s,t.http=new s},5747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Register=void 0;t.Register=class{constructor(){this.storage=new Map}set(e,t){return this.storage.set(e,t),t}get(e){return this.storage.get(e)}remove(e){return!!this.storage.has(e)&&(this.storage.delete(e),!0)}has(e){return this.storage.has(e)}}},7838:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAllowedProtocol=t.isNumberInString=t.isNotEmpty=t.isString=void 0;const r=s(9068);t.isString=e=>"string"==typeof e;t.isNotEmpty=e=>!!(0,t.isString)(e)&&""!==e.trim();t.isNumberInString=e=>{if("string"!=typeof e)return!1;const t=e.trim();return!!/^[.0-9]*$/.test(t)&&!Number.isNaN(parseFloat(t))};t.isAllowedProtocol=(e,t)=>{if(t===r.Mode.development)return!0;const s=e.trim().toLowerCase();return"https:"===s||"https"===s}},412:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.capitalizeFirstLetter=t.formatString=t.deduplicateArray=t.parseJSONSafe=t.clearExtraSpaces=t.uuid=t.isFlatObjectsEqual=void 0;t.isFlatObjectsEqual=(e,t)=>{const s=Object.keys(e),r=Object.keys(t);return s.length===r.length&&!s.some((s=>e[s]!==t[s]))};t.uuid=()=>Math.random().toString(36).substring(5)+Date.now().toString(36)+Math.random().toString(36).substring(5);t.clearExtraSpaces=e=>e.replace(/ +/g," ");t.parseJSONSafe=(e,t)=>{try{return JSON.parse(e)}catch(e){return t}};t.deduplicateArray=e=>[...Array.from(new Set([...e]))];t.formatString=(e,t,s)=>Object.keys(t||{}).map((e=>({value:t[e],key:s?s(e):`%${e}`}))).reduce(((e,t)=>e.replace(new RegExp(t.key,"g"),t.value)),e)||e;t.capitalizeFirstLetter=e=>`${e.charAt(0).toUpperCase()}${e.slice(1)}`},9068:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapType=t.LogLevel=t.Mode=void 0,function(e){e.production="production",e.development="development"}(t.Mode||(t.Mode={})),function(e){e.info="info",e.debug="debug",e.error="error",e.warn="warn"}(t.LogLevel||(t.LogLevel={}));t.mapType=e=>e},7413:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingKey=void 0,function(e){e.resourcesAdding="resourcesAdding",e.fieldAdding="fieldAdding",e.fieldRemoving="fieldRemoving"}(t.LoadingKey||(t.LoadingKey={}))},2545:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToApp=void 0;const r=s(332);var o;!function(e){e.AppShowExtension="AppShowExtension",e.AppTakeResourceData="AppTakeResourceData",e.AppTakeNewResourceData="AppTakeNewResourceData",e.AppClearResourceData="AppClearResourceData",e.AppAddFieldToWatch="AppAddFieldToWatch",e.AppSetLoadingState="AppSetLoadingState"}(o=t.MessageToApp||(t.MessageToApp={})),Object.values(o).forEach((e=>{if("app"!==(0,r.getExecutingContextByMessageType)(e))throw new Error(`Wrong app message type "${e}"`)}))},9273:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(9624),o=s(926),n=s(9148),i=s(2545),a=s(3799),d=s(8918),l=s(8312),u=s(7217),c=s(7413),p=s(1846),g=s(412),f=s(5482).loggers.addPrefix((0,p.getDebugPrefix)("background")).addPrefix("listeners");r.addListener(o.BGListenerType.OnExtensionIconClicked,(e=>{if(!e.id)return f.error().log(`${o.BGListenerType.OnExtensionIconClicked}: there is no tab id`,e);(0,n.sendMessageFromBackground)(e.id,{type:i.MessageToApp.AppShowExtension}),(0,n.sendMessageFromBackground)(e.id,{type:l.MessageToContent.CSConnectPlatform})})),r.addListener(o.BGListenerType.OnBrowserTabRemoved,(e=>{(0,n.unregisterPlatformTabs)([e])})),r.addListener(o.BGListenerType.OnBeforeRequest,(()=>{}),{urls:["<all_urls>"]},["requestBody"]),r.addListener(o.BGListenerType.OnBeforeSendHeaders,(()=>{}),{urls:["<all_urls>"]},["requestHeaders"]),r.addListener(o.BGListenerType.OnMessage,((e,t)=>{var s,r;if(!(null===(s=t.tab)||void 0===s?void 0:s.id))return f.error().log(`${o.BGListenerType.OnMessage} ${e.type}: there is no tab id`,t,e);if((0,a.isMessageMatched)((()=>d.MessageToBackground.BGRunClearData===e.type),e,t)&&(0,n.sendMessageFromBackground)(t.tab.id,{type:i.MessageToApp.AppClearResourceData}),(0,a.isMessageMatched)((()=>d.MessageToBackground.BGModifyQuery===e.type),e,t)&&(0,n.sendMessageFromBackground)(t.tab.id,Object.assign(Object.assign({},e),{id:`${e.id}--background-modify-query`,type:l.MessageToContent.CSModifyQuery})),(0,a.isMessageMatched)((()=>d.MessageToBackground.BGSetWatchers===e.type),e,t)){const{platformID:s,watchers:o,action:a}=e.payload;null===(r=u.platformResolver.resolve(s))||void 0===r||r.setWatchers(o,t.tab.id),(0,n.sendMessageFromBackground)(t.tab.id,{id:`background-set-watchers--${(0,g.uuid)()}`,type:i.MessageToApp.AppSetLoadingState,payload:{loading:!1,key:"add"===a?c.LoadingKey.fieldAdding:c.LoadingKey.fieldRemoving}})}if((0,a.isMessageMatched)((()=>d.MessageToBackground.BGAddFieldToWatch===e.type),e,t)&&(0,n.sendMessageFromBackground)(t.tab.id,Object.assign(Object.assign({},e),{id:`${e.id}--background-add-field`,type:i.MessageToApp.AppAddFieldToWatch})),(0,a.isMessageMatched)((()=>d.MessageToBackground.BGRegisterPlatformTab===e.type),e,t)){const{platformID:s}=e.payload;(0,n.registerPlatformTab)(s,t.tab.id)}})),f.debug().log("mounted")},6122:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPlatform=void 0;const r=s(9624),o=s(9148),n=s(2545),i=s(412);t.AbstractPlatform=class{constructor(){this.lastResponse=null,this.watchingResources={},this.emptyFieldValue="",this.interceptorsIDs=new Set}addValueToResource(e,t,s){var r;const o=e[t]||new Set,n="number"==typeof s?String(s):null===(r=null==s?void 0:s.trim)||void 0===r?void 0:r.call(s);n&&n!==this.emptyFieldValue&&o.add(n),o.size&&(e[t]=o)}unregister(){Array.from(this.interceptorsIDs).forEach((e=>{(0,r.removeBGInterceptor)(e),this.interceptorsIDs.delete(e)}))}setWatchers(e,t){if(this.watchingResources=e,!this.lastResponse)return;const s=this.parseResponse(this.lastResponse);(0,o.sendMessageFromBackground)(t,{id:`re-parsed-last-response--${(0,i.uuid)()}`,type:n.MessageToApp.AppTakeResourceData,payload:{services:(0,o.normalizeParsedResource)(s.services),assets:(0,o.normalizeParsedResource)(s.assets),accounts:(0,o.normalizeParsedResource)(s.accounts)}})}}},7217:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.platformResolver=t.PlatformResolver=void 0;const r=s(5747),o=s(3319),n=s(5864),i=s(1595),a=s(3548),d=s(4643);class l{constructor(){this.platforms=new r.Register}getPlatform(e){if(!this.platforms.has(e))switch(e){case o.PlatformID.MicrosoftSentinel:this.platforms.set(e,new n.MicrosoftSentinelPlatform);break;case o.PlatformID.MicrosoftDefender:this.platforms.set(e,new a.MicrosoftDefenderPlatform);break;case o.PlatformID.Splunk:this.platforms.set(e,new d.SplunkPlatform)}return this.platforms.get(e)}resolve(e){return i.backgroundPlatformIDFromENV?this.getPlatform(i.backgroundPlatformIDFromENV):this.getPlatform(e)}}t.PlatformResolver=l,t.platformResolver=new l},8222:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNormalizedWatchers=t.removeFieldFromWatching=t.addFieldToWatch=void 0;const r=s(412);t.addFieldToWatch=(e,t,s)=>{const o=e[s]||[];return o.includes(t)||o.push(t),e[s]=(0,r.deduplicateArray)(o),e};t.removeFieldFromWatching=(e,t,s)=>(e[s]=(e[s]||[]).filter((e=>e!==t)),e);t.getNormalizedWatchers=e=>{const t=new Set,s=new Map;return Object.keys(e).forEach((r=>{e[r].forEach((e=>{t.add(e);const o=s.get(e)||[];o.push(r),s.set(e,o)}))})),{fieldsNames:t,mapFieldNameToType:s}}},3548:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftDefenderPlatform=void 0;const r=s(6122),o=s(3319),n=s(1846),i=s(9624),a=s(926),d=s(1820),l=s(8222),u=s(9148),c=s(2545),p=s(7413),g=s(412),f=s(4470),m=s(5482).loggers.addPrefix((0,n.getDebugPrefix)("background")).addPrefix(o.PlatformID.MicrosoftDefender);class v extends r.AbstractPlatform{constructor(){super(),this.watchingResources=d.microsoftDefenderWatchers,this.emptyFieldValue=""}static sendLoading(e,t){(0,u.sendMessageFromBackground)(e,{type:c.MessageToApp.AppSetLoadingState,payload:{loading:t,key:p.LoadingKey.resourcesAdding}})}getID(){return v.id}parseResponse(e){const t=(0,g.uuid)();m.debug().log("started parse response...",t,this.watchingResources);const s={assets:{},accounts:{},services:{}},{mapFieldNameToType:r,fieldsNames:o}=(0,l.getNormalizedWatchers)(this.watchingResources);return((null==e?void 0:e.Results)||[]).forEach((e=>{Array.from(o).forEach((t=>{if(null==e?void 0:e[t]){r.get(t).forEach((r=>{this.addValueToResource(s[r],t,e[t])}))}}))})),m.debug().log("finished parse response",t),{services:s.services,accounts:s.accounts,assets:s.assets}}register(){const e=new Set,t=new Map;this.interceptorsIDs.add((0,i.setBGInterceptor)(a.BGListenerType.OnBeforeRequest,((s,r,o)=>{const n=r.listenerParams[0],{href:i}=new URL(n.url);o((()=>{var t,s,r,o;return!(e.has(n.url)||"POST"!==n.method||!d.microsoftDefenderPostsUrls.some((e=>i.indexOf(e)>-1))||!(null===(o=null===(r=null===(s=null===(t=n.requestBody)||void 0===t?void 0:t.raw)||void 0===s?void 0:s[0])||void 0===r?void 0:r.bytes)||void 0===o?void 0:o.byteLength)||n.requestBody.raw[0].bytes.byteLength<5)}),r,s)&&t.set(n.url,n.requestBody.raw[0].bytes)}))),this.interceptorsIDs.add((0,i.setBGInterceptor)(a.BGListenerType.OnBeforeSendHeaders,((s,r,o)=>{const n=r.listenerParams[0],{href:i}=new URL(n.url);if(!o((()=>!(e.has(n.url)||"POST"!==n.method||!d.microsoftDefenderPostsUrls.some((e=>i.indexOf(e)>-1))||!t.has(n.url)||!n.requestHeaders)),r,s))return;const a=t.get(n.url),l=(new TextDecoder).decode(a);e.add(n.url);const p=()=>{e.delete(n.url),t.delete(n.url)};v.sendLoading(n.tabId,!0),f.http.post({url:n.url,body:a,headers:n.requestHeaders.reduce(((e,t)=>(e[t.name]=t.value,e)),{})},{onJSONSuccess:e=>{const t=this.parseResponse(e);(0,u.sendMessageFromBackground)(n.tabId,{id:`parsed-response--${(0,g.uuid)()}`,type:c.MessageToApp.AppTakeNewResourceData,payload:{services:(0,u.normalizeParsedResource)(t.services),assets:(0,u.normalizeParsedResource)(t.assets),accounts:(0,u.normalizeParsedResource)(t.accounts)}}),this.lastResponse=e,p()},onError:e=>{m.error().addPrefix("failed webRequest post").log(e,n.method,n.url,l),v.sendLoading(n.tabId,!1),p()}})}))),m.debug().log("registered")}unregister(){super.unregister(),m.debug().log("unregistered")}}t.MicrosoftDefenderPlatform=v,v.id=o.PlatformID.MicrosoftDefender},1820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.microsoftDefenderPostsUrls=t.microsoftDefenderWatchers=void 0,t.microsoftDefenderWatchers={accounts:["AccountName"],assets:["DeviceName"],services:[]},t.microsoftDefenderPostsUrls=["https://api-eu.securitycenter.windows.com/api/","https://security.microsoft.com/apiproxy/mtp/huntingService/queryExecutor"]},5864:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftSentinelPlatform=void 0;const r=s(926),o=s(3319),n=s(9624),i=s(1846),a=s(6122),d=s(9119),l=s(8222),u=s(9148),c=s(2545),p=s(7413),g=s(4470),f=s(412),m=s(5482).loggers.addPrefix((0,i.getDebugPrefix)("background")).addPrefix(o.PlatformID.MicrosoftSentinel);class v extends a.AbstractPlatform{constructor(){super(),this.watchingResources=d.microsoftSentinelWatchers,this.emptyFieldValue="-"}static sendLoading(e,t){(0,u.sendMessageFromBackground)(e,{type:c.MessageToApp.AppSetLoadingState,payload:{loading:t,key:p.LoadingKey.resourcesAdding}})}getID(){return v.id}register(){const e=new Set,t=new Map;this.interceptorsIDs.add((0,n.setBGInterceptor)(r.BGListenerType.OnBeforeRequest,((s,r,o)=>{const n=r.listenerParams[0],{href:i}=new URL(n.url);o((()=>{var t,s,r,o,a;return!(e.has(n.url)||"POST"!==n.method||!d.microsoftSentinelPostsUrls.some((e=>i.indexOf(e)>-1))||!(null===(o=null===(r=null===(s=null===(t=n.requestBody)||void 0===t?void 0:t.raw)||void 0===s?void 0:s[0])||void 0===r?void 0:r.bytes)||void 0===o?void 0:o.byteLength)||(null===(a=n.requestBody)||void 0===a?void 0:a.raw[0].bytes.byteLength)<5)}),r,s)&&t.set(n.url,n.requestBody.raw[0].bytes)}))),this.interceptorsIDs.add((0,n.setBGInterceptor)(r.BGListenerType.OnBeforeSendHeaders,((s,r,o)=>{const n=r.listenerParams[0],{href:i}=new URL(n.url);if(!o((()=>!(e.has(n.url)||"POST"!==n.method||!d.microsoftSentinelPostsUrls.some((e=>i.indexOf(e)>-1))||!t.has(n.url)||!n.requestHeaders)),r,s))return;e.add(n.url);const a=()=>{e.delete(n.url),t.delete(n.url)},l=t.get(n.url),p=(new TextDecoder).decode(l);v.sendLoading(n.tabId,!0),g.http.post({url:n.url,body:l,headers:n.requestHeaders.reduce(((e,t)=>(e[t.name]=t.value,e)),{})},{onJSONSuccess:e=>{const t=this.parseResponse(e);(0,u.sendMessageFromBackground)(n.tabId,{id:`parsed-response--${(0,f.uuid)()}`,type:c.MessageToApp.AppTakeNewResourceData,payload:{services:(0,u.normalizeParsedResource)(t.services),assets:(0,u.normalizeParsedResource)(t.assets),accounts:(0,u.normalizeParsedResource)(t.accounts)}}),this.lastResponse=e,a()},onError:e=>{m.error().addPrefix("failed webRequest post").log(e,n.method,n.url,p),a(),v.sendLoading(n.tabId,!1)}})}))),m.debug().log("registered")}unregister(){super.unregister(),m.debug().log("unregistered")}parseResponse(e){var t,s,r,o;const n=(0,f.uuid)();m.debug().log("started parse response...",n,this.watchingResources);const i={assets:{},accounts:{},services:{}},{mapFieldNameToType:a,fieldsNames:d}=(0,l.getNormalizedWatchers)(this.watchingResources),u=((null===(s=null===(t=null==e?void 0:e.tables)||void 0===t?void 0:t[0])||void 0===s?void 0:s.columns)||[]).reduce(((e,t,s)=>(e.set(t.name,s),e)),new Map)||new Map;return((null===(o=null===(r=null==e?void 0:e.tables)||void 0===r?void 0:r[0])||void 0===o?void 0:o.rows)||[]).forEach((e=>{Array.from(d).forEach((t=>{if(u.has(t)){a.get(t).forEach((s=>{this.addValueToResource(i[s],t,e[u.get(t)])}))}}))})),m.debug().log("finished parse response",n),{services:i.services,accounts:i.accounts,assets:i.assets}}}t.MicrosoftSentinelPlatform=v,v.id=o.PlatformID.MicrosoftSentinel},9119:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.microsoftSentinelPostsUrls=t.microsoftSentinelWatchers=void 0,t.microsoftSentinelWatchers={accounts:["UserName","Account","SubjectUserName","TargetUserName"],assets:["Computer"],services:[]},t.microsoftSentinelPostsUrls=["https://api.loganalytics.io"]},4643:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SplunkPlatform=void 0;const r=s(6122),o=s(3319),n=s(1846),i=s(9624),a=s(926),d=s(6268),l=s(4470),u=s(412),c=s(8222),p=s(9148),g=s(2545),f=s(7413),m=s(5482).loggers.addPrefix((0,n.getDebugPrefix)("background")).addPrefix(o.PlatformID.Splunk);class v extends r.AbstractPlatform{constructor(){super(),this.watchingResources=d.splunkWatchers,this.emptyFieldValue="-"}static sendLoading(e,t){(0,p.sendMessageFromBackground)(e,{type:g.MessageToApp.AppSetLoadingState,payload:{loading:t,key:f.LoadingKey.resourcesAdding}})}static sendParsedData(e,t,s=!1){(0,p.sendMessageFromBackground)(e,{id:`parsed-response--${(0,u.uuid)()}`,type:s?g.MessageToApp.AppTakeNewResourceData:g.MessageToApp.AppTakeResourceData,payload:{services:(0,p.normalizeParsedResource)(t.services),assets:(0,p.normalizeParsedResource)(t.assets),accounts:(0,p.normalizeParsedResource)(t.accounts)}})}getID(){return v.id}parseContent(){const e={assets:{},accounts:{},services:{}};return{accounts:e.accounts,assets:e.assets,services:e.services}}parseSummary(e){const t={assets:{},accounts:{},services:{}},{mapFieldNameToType:s,fieldsNames:r}=(0,c.getNormalizedWatchers)(this.watchingResources),o=(null==e?void 0:e.fields)||{};return Object.keys(o).length>0&&Array.from(r).forEach((e=>{var r,n;if(null==o?void 0:o[e]){const i=(null===(n=null===(r=o[e])||void 0===r?void 0:r.modes)||void 0===n?void 0:n.map((e=>null==e?void 0:e.value)))||[];if(i.length<1)return;s.get(e).forEach((s=>{i.forEach((r=>{this.addValueToResource(t[s],e,r)}))}))}})),{accounts:t.accounts,assets:t.assets,services:t.services}}parseStatistic(e){const t={assets:{},accounts:{},services:{}},{mapFieldNameToType:s,fieldsNames:r}=(0,c.getNormalizedWatchers)(this.watchingResources);return((null==e?void 0:e.rows)||[]).forEach((o=>{o.forEach(((o,n)=>{var i,a;const d=null===(a=null===(i=null==e?void 0:e.fields)||void 0===i?void 0:i[n])||void 0===a?void 0:a.name;if(!d||!r.has(d))return;s.get(d).forEach((e=>{Array.isArray(o)?o.forEach((s=>{this.addValueToResource(t[e],d,s)})):this.addValueToResource(t[e],d,o)}))}))})),{accounts:t.accounts,assets:t.assets,services:t.services}}parseResponse(e){const t=(0,u.uuid)();m.debug().log("started parse response...",t,this.watchingResources);const s=(null==e?void 0:e.rows)?this.parseStatistic(e):this.parseSummary(e);return m.debug().log("finished parse response",t),s}register(){let e,t="",s=0;const r=new Set;this.interceptorsIDs.add((0,i.setBGInterceptor)(a.BGListenerType.OnBeforeSendHeaders,((o,n,i)=>{const a=n.listenerParams[0],{href:u}=new URL(a.url);if(i((()=>{if("GET"!==a.method||r.has(u))return!1;const o=(0,d.matchSplunkSummaryUrl)(u);return o&&o===t&&(v.sendLoading(a.tabId,!0),s++),!(!o||o===t)&&(clearTimeout(e),s=0,t=o,!0)}),n,o)){const o=new URL(a.url);o.searchParams.set("top_count","9999999999"),o.searchParams.set("output_mode","json"),o.searchParams.delete("_"),r.add(o.href);const n=()=>{t="",s=0,r.delete(o.href)},i=(t=!1)=>{v.sendLoading(a.tabId,!0);const r=s;l.http.get({url:o.href,headers:a.requestHeaders.reduce(((e,t)=>(e[t.name]=t.value,e)),{})},{onJSONSuccess:o=>{v.sendParsedData(a.tabId,this.parseResponse(o),t),this.lastResponse=o,e=setTimeout((()=>{s>r?i():n()}),3e3)},onError:t=>{m.error().log(t,a.url),clearTimeout(e),n(),v.sendLoading(a.tabId,!1)}})};e=setTimeout((()=>{i(!0)}),1e3)}}),(()=>{clearTimeout(e)}))),this.interceptorsIDs.add((0,i.setBGInterceptor)(a.BGListenerType.OnBeforeSendHeaders,((o,n,i)=>{const a=n.listenerParams[0],{href:u}=new URL(a.url);if(i((()=>{if("GET"!==a.method||r.has(u))return!1;const o=(0,d.matchSplunkResultsUrl)(u);return o&&o===t&&(v.sendLoading(a.tabId,!0),s++),!(!o||o===t)&&(clearTimeout(e),s=0,t=o,!0)}),n,o)){const o=new URL(a.url);o.searchParams.set("count","9999999999"),o.searchParams.set("show_metadata","true"),o.searchParams.set("offset","0"),o.searchParams.set("output_mode","json_rows"),o.searchParams.delete("_"),r.add(o.href);const n=()=>{t="",s=0,r.delete(o.href)},i=(t=!1)=>{v.sendLoading(a.tabId,!0);const r=s;l.http.get({url:o.href,headers:a.requestHeaders.reduce(((e,t)=>(e[t.name]=t.value,e)),{})},{onJSONSuccess:o=>{v.sendParsedData(a.tabId,this.parseResponse(o),t),this.lastResponse=o,e=setTimeout((()=>{s>r?i():n()}),3e3)},onError:t=>{m.error().log(t,a.url),clearTimeout(e),n(),v.sendLoading(a.tabId,!1)}})};e=setTimeout((()=>{i(!0)}),1e3)}}),(()=>{clearTimeout(e)}))),m.debug().log("registered")}unregister(){super.unregister(),m.debug().log("unregistered")}}t.SplunkPlatform=v,v.id=o.PlatformID.Splunk},6268:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.matchSplunkResultsUrl=t.matchSplunkSummaryUrl=t.splunkWatchers=void 0;const r=s(412),o=s(7838),n=s(1595);t.splunkWatchers={accounts:(0,r.deduplicateArray)(["src_user","src_user_bunit","user","Account_Name","User","src_user_name","user_name"]),assets:(0,r.deduplicateArray)(["dest_host","dst","dest_nt_host","src_host","src_nt_host","src","dest","dest_name","dest_host","dvc","dvc_host","dest_dns","src_dns","ComputerName","DestinationHostname","SourceHostname"]),services:[]};t.matchSplunkSummaryUrl=e=>{var t;const{protocol:s,href:r}=new URL(e);if((0,o.isAllowedProtocol)(s,n.mode))return null===(t=r.match(/\/search\/jobs\/([.0-9]+)\/summary/))||void 0===t?void 0:t[1]};t.matchSplunkResultsUrl=e=>{var t;const{protocol:s,href:r}=new URL(e);if((0,o.isAllowedProtocol)(s,n.mode))return null===(t=r.match(/\/search\/jobs\/([.0-9]+)\/results/))||void 0===t?void 0:t[1]}},9624:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addListener=t.removeBGInterceptor=t.setBGInterceptor=t.isBGInterceptorMatched=t.interceptors=void 0;const r=s(926),o=s(332),n=s(9068),i=s(412),a=s(1846),d=s(5099),l=s(5482).loggers.addPrefix((0,a.getDebugPrefix)("background")).addPrefix("listeners"),u={};t.interceptors={},u[r.BGListenerType.OnMessage]=(e,...t)=>{if((0,d.isRuntimeOnMessageSupported)()&&(0,o.getBrowserContext)().runtime.onMessage.addListener(e,...t),!(0,d.isRuntimeOnMessageExternalSupported)())return;(0,o.getBrowserContext)().runtime.onMessageExternal.addListener(((...t)=>{const s=t[0],r=t[1];new URL(r.url).origin===r.origin&&s.externalType===a.DebugID.debugIDExternal&&e(...t)}))},u[r.BGListenerType.OnBrowserTabRemoved]=(e,...t)=>{(0,d.isTabsOnRemovedSupported)()&&(0,o.getBrowserContext)().tabs.onRemoved.addListener(e,...t)},u[r.BGListenerType.OnExtensionIconClicked]=(e,...t)=>{const s=(0,o.getBrowserContext)(),r=void 0!==s.action?"action":"browserAction";("action"!==r||(0,d.isActionOnClickedSupported)())&&("browserAction"!==r||(0,d.isBrowserActionOnClickedSupported)())&&s[r].onClicked.addListener(e,...t)},u[r.BGListenerType.OnBeforeRequest]=(e,...t)=>{(0,d.isOnBeforeRequestSupported)()&&(0,o.getBrowserContext)().webRequest.onBeforeRequest.addListener(e,...t)},u[r.BGListenerType.OnBeforeSendHeaders]=(e,...t)=>{(0,d.isOnBeforeSendHeadersSupported)()&&(0,o.getBrowserContext)().webRequest.onBeforeSendHeaders.addListener(e,...t)};t.isBGInterceptorMatched=(e,t,...s)=>!!t()&&(l.debug().log(`intercepted ${e}`,...s),!0);t.setBGInterceptor=(e,s,r)=>{const o=(0,n.mapType)(s);return o.id=(0,i.uuid)(),"function"==typeof r&&(o.unregister=r),t.interceptors[e]=[...t.interceptors[e]||[],o],o.id};t.removeBGInterceptor=(e,s)=>{(s?[s]:Object.keys(t.interceptors)).forEach((s=>{t.interceptors[s]=t.interceptors[s].filter((t=>(t.id===e&&"function"==typeof t.unregister&&t.unregister(),t.id!==e)))}))};t.addListener=(e,s,...r)=>{var o;null===(o=u[e])||void 0===o||o.call(u,((...o)=>{(t.interceptors[e]||[]).forEach((n=>{n&&"function"==typeof n&&n(n.id,{listenerParams:o,createListenerParams:[s,...r]},((s,...r)=>(0,t.isBGInterceptorMatched)(e,s,...r)))})),s(...o)}),...r)}},9148:function(e,t,s){var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(o,n){function i(e){try{d(r.next(e))}catch(e){n(e)}}function a(e){try{d(r.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}d((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.waitBGMessage=t.registerPlatformsOnOpenedTabs=t.unregisterPlatformTabs=t.registerPlatformTab=t.normalizeParsedResource=t.sendMessageFromBackground=void 0;const o=s(926),n=s(332),i=s(7217),a=s(7134),d=s(9624),l=s(1846),u=s(412),c=s(5099),p=s(5482).loggers.addPrefix((0,l.getDebugPrefix)("background")).addPrefix("services");t.sendMessageFromBackground=(e,t)=>{var s;const r=(0,n.getBrowserContext)();if(t.id=t.id||(0,u.uuid)(),!(0,c.isTabsSendMessageSupported)(t,e))return;const o="sendMessageFromBackground";try{null===(s=r.tabs.sendMessage(e,t))||void 0===s||s.catch((e=>p.error().addPrefix(o).log(e,t))),p.debug().addPrefix(o).log(t)}catch(e){p.error().addPrefix(o).log(e,t)}};t.normalizeParsedResource=e=>{const t={};return Object.keys(e||{}).forEach((s=>{t[s]=Array.from(e[s])})),t};const g=new Map;t.registerPlatformTab=(e,t)=>{if(!t)return p.warn().log("No tab id for register",e);const s=i.platformResolver.resolve(e),r=g.get(t);s&&r!==e&&(s.register(),g.set(t,e),p.debug().log("registered platform tab",e,t))};t.unregisterPlatformTabs=e=>{const t=(e||[]).reduce(((e,t)=>{if(!t)return p.warn().log("No tab id for unregister",t);const s=g.get(t);return s&&(e.add(s),g.delete(t),p.debug().log("unregistered platform tab",t)),e}),new Set);Array.from(t).forEach((e=>{if((e=>Array.from(g).some((([,t])=>t===e)))(e))return;const t=i.platformResolver.resolve(e);if(!t)return p.warn().log("can not resolve platform for unregister",e);t.unregister()})),g.size<1&&p.info().log("there are no platforms tabs left")};t.registerPlatformsOnOpenedTabs=()=>{const e=(0,n.getBrowserContext)();(0,c.isTabsQuerySupported)()&&e.tabs.query({},(e=>{e.forEach((e=>{if(!(null==e?void 0:e.url))return;const s=a.PlatformResolver.resolveByUrl(e.url);s&&(0,t.registerPlatformTab)(s.getID(),e.id)}))}))};t.waitBGMessage=e=>r(void 0,void 0,void 0,(function*(){return new Promise((t=>{(0,d.setBGInterceptor)(o.BGListenerType.OnMessage,((s,r,n)=>{const i=r.listenerParams[0];n((()=>i.type===e),i,r,s)&&(t(i.payload),(0,d.removeBGInterceptor)(s,o.BGListenerType.OnMessage))}))}))}))},926:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BGListenerType=void 0,function(e){e.OnMessage="OnMessage",e.OnBeforeRequest="OnBeforeRequest",e.OnBrowserTabRemoved="OnBrowserTabRemoved",e.OnBeforeSendHeaders="OnBeforeSendHeaders",e.OnExtensionIconClicked="OnExtensionIconClicked"}(t.BGListenerType||(t.BGListenerType={}))},8918:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToBackground=void 0;const r=s(332);var o;!function(e){e.BGRunClearData="BGRunClearData",e.BGModifyQuery="BGModifyQuery",e.BGSetWatchers="BGSetWatchers",e.BGRegisterPlatformTab="BGRegisterPlatformTab",e.BGAddFieldToWatch="BGAddFieldToWatch"}(o=t.MessageToBackground||(t.MessageToBackground={})),Object.values(o).forEach((e=>{if("background"!==(0,r.getExecutingContextByMessageType)(e))throw new Error(`Wrong background message type "${e}"`)}))},5099:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isRuntimeGetUrlSupported=t.isTabsSendMessageSupported=t.isTabsQuerySupported=t.isOnBeforeSendHeadersSupported=t.isOnBeforeRequestSupported=t.isBrowserActionOnClickedSupported=t.isActionOnClickedSupported=t.isTabsOnRemovedSupported=t.isRuntimeOnMessageExternalSupported=t.isRuntimeOnMessageSupported=t.isRuntimeSendMessageSupported=t.isAddEventListenerSupported=t.isPostMessageSupported=void 0;const r=s(332),o=s(5482).loggers.addPrefix("api-support");t.isPostMessageSupported=(...e)=>!!(null===window||void 0===window?void 0:window.postMessage)||(o.warn().log("API window.postMessage is not supported",...e),!1);t.isAddEventListenerSupported=(...e)=>!!(null===window||void 0===window?void 0:window.addEventListener)||(o.warn().log("API window.addEventListener is not supported",...e),!1);t.isRuntimeSendMessageSupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.runtime)||void 0===s?void 0:s.sendMessage)||(o.warn().log("API runtime.sendMessage is not supported",...e),!1)};t.isRuntimeOnMessageSupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)().runtime)||void 0===t?void 0:t.onMessage)||void 0===s?void 0:s.addListener)||(o.warn().log("API runtime.onMessage.addListener is not supported",...e),!1)};t.isRuntimeOnMessageExternalSupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)().runtime)||void 0===t?void 0:t.onMessageExternal)||void 0===s?void 0:s.addListener)||(o.warn().log("API runtime.onMessageExternal.addListener is not supported",...e),!1)};t.isTabsOnRemovedSupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)().tabs)||void 0===t?void 0:t.onRemoved)||void 0===s?void 0:s.addListener)||(o.warn().log("API tabs.onRemoved.addListener is not supported",...e),!1)};t.isActionOnClickedSupported=(...e)=>{var t,s,n;return!!(null===(n=null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.action)||void 0===s?void 0:s.onClicked)||void 0===n?void 0:n.addListener)||(o.warn().log("API action.onClicked.addListener is not supported",...e),!1)};t.isBrowserActionOnClickedSupported=(...e)=>{var t,s,n;return!!(null===(n=null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.browserAction)||void 0===s?void 0:s.onClicked)||void 0===n?void 0:n.addListener)||(o.warn().log("API browserAction.onClicked.addListener is not supported",...e),!1)};t.isOnBeforeRequestSupported=(...e)=>{var t,s,n;return!!(null===(n=null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.webRequest)||void 0===s?void 0:s.onBeforeRequest)||void 0===n?void 0:n.addListener)||(o.warn().log("API webRequest.onBeforeRequest is not supported",...e),!1)};t.isOnBeforeSendHeadersSupported=(...e)=>{var t,s,n;return!!(null===(n=null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.webRequest)||void 0===s?void 0:s.onBeforeSendHeaders)||void 0===n?void 0:n.addListener)||(o.warn().log("API webRequest.onBeforeSendHeaders is not supported",...e),!1)};t.isTabsQuerySupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.tabs)||void 0===s?void 0:s.query)||(o.warn().log("API tabs.query is not supported",...e),!1)};t.isTabsSendMessageSupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.tabs)||void 0===s?void 0:s.sendMessage)||(o.warn().log("API tabs.sendMessage is not supported",...e),!1)};t.isRuntimeGetUrlSupported=(...e)=>{var t,s;return!!(null===(s=null===(t=(0,r.getBrowserContext)())||void 0===t?void 0:t.runtime)||void 0===s?void 0:s.getURL)||(o.warn().log("API runtime.getURL is not supported",...e),!1)}},332:function(e,t,s){var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(o,n){function i(e){try{d(r.next(e))}catch(e){n(e)}}function a(e){try{d(r.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}d((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.compareVersions=t.getVersionFromString=t.removeDoubleQuotesAround=t.buildQueryParts=t.getElementsUnderCursor=t.downloadFile=t.copyToClipboard=t.createClassName=t.waitHTMLElement=t.isInsideIframe=t.mountHTMLElement=t.cssObjectToString=t.getExecutingContextByMessageType=t.getPlatformNameByID=t.getWebAccessibleUrl=t.getBrowserContext=void 0;const o=s(3319),n=s(5099);t.getBrowserContext=()=>"undefined"!=typeof browser?browser:chrome;t.getWebAccessibleUrl=e=>(0,n.isRuntimeGetUrlSupported)(e)?(0,t.getBrowserContext)().runtime.getURL(e):"";t.getPlatformNameByID=e=>e===o.PlatformID.MicrosoftSentinel?"Microsoft Sentinel":e===o.PlatformID.MicrosoftDefender?"Microsoft Defender For Endpoint":e===o.PlatformID.Splunk?"Splunk":"Unknown Platform";t.getExecutingContextByMessageType=e=>{let t=e.slice(0,3).toLowerCase();return"app"===t?"app":(t=t.slice(0,2),"bg"===t?"background":"cs"===t?"content":"is"===t?"inline":"unknown")};t.cssObjectToString=e=>Object.keys(e).reduce(((t,s)=>t+`${s}:${e[s]};`),"");t.mountHTMLElement=(e,s,r)=>{const o=document.createElement(e);return(null==r?void 0:r.attributes)&&Object.keys(r.attributes).forEach((e=>{var s;o.setAttribute(e,"style"===e?(0,t.cssObjectToString)(r.attributes[e]):(null===(s=r.attributes)||void 0===s?void 0:s[e])||"")})),(null==r?void 0:r.innerHtml)&&(o.innerHTML=r.innerHtml),(null==r?void 0:r.innerText)&&(o.innerText=r.innerText),s&&s.append(o),o};t.isInsideIframe=()=>{try{return window.self!==window.top}catch(e){return!0}};t.waitHTMLElement=(e,t=document)=>r(void 0,void 0,void 0,(function*(){return new Promise((s=>{new MutationObserver(((r,o)=>{const n=t.querySelector(e);n&&(o.disconnect(),s(n))})).observe(t,{childList:!0,subtree:!0})}))}));t.createClassName=e=>e.filter(Boolean).join(" ");t.copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-99999px",t.style.top="-99999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};t.downloadFile=(e,t)=>{const s=document.createElement("a");s.setAttribute("href",encodeURI(`data:text/csv;charset=utf-8,${t}`)),s.setAttribute("download","extension-resources.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)};t.getElementsUnderCursor=(e,t)=>{const s=e.clientX,r=e.clientY,o=[],n=[];let i=document.elementFromPoint(s,r);for(;"HTML"!==i.tagName;){const e=i.style.pointerEvents;if(!i)break;(!t||t&&t(i))&&o.push(i),n.push({savedPointerEvents:e,element:i}),i.style.pointerEvents="none",i=document.elementFromPoint(s,r)}return n.forEach((({element:e,savedPointerEvents:t})=>{t?e.style.pointerEvents=t:e.style.removeProperty("pointer-events"),e.getAttribute("style")||e.removeAttribute("style")})),o};t.buildQueryParts=(e,t,s,r)=>Object.keys(e).reduce(((o,n)=>(o.push(e[n].map((e=>`${r.leftOperand(n)} ${t} ${r.rightOperand(e)}`)).join(s)),o)),[]).join(s);t.removeDoubleQuotesAround=e=>{let t=e;return'"'===e[0]&&(t=t.slice(1)),'"'===e[e.length-1]&&(t=t.slice(0,e.length-2)),t};t.getVersionFromString=e=>{if("string"!=typeof e||!/^[.0-9]+$/.test(e))return 0;const t=parseInt(e.replace(/\./g,""));return isNaN(t)?0:t};t.compareVersions=(e,s)=>{const r=(0,t.getVersionFromString)(e),o=(0,t.getVersionFromString)(s);return r===o?"equal":r>o?"greater":"less"}},3799:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isMessageMatched=void 0;const r=s(5482),o=s(1846),n=s(332);t.isMessageMatched=(e,t,...s)=>!!e()&&(r.loggers.debug().addPrefix((0,o.getDebugPrefix)((0,n.getExecutingContextByMessageType)(t.type))).log(`got ${t.type} message`,t,...s),!0)},1595:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.logLevel=t.mode=t.backgroundPlatformIDFromENV=t.contentPlatformIDFromENV=void 0;const r=s(3319),o=s(9068);t.contentPlatformIDFromENV=(Object.values(r.PlatformID).includes(null),null),t.backgroundPlatformIDFromENV=(Object.values(r.PlatformID).includes(null),null),t.mode="production"===o.Mode.production?o.Mode.production:o.Mode.development,t.logLevel=Object.keys(o.LogLevel).includes("info")?"info":o.LogLevel.info,t.version="1.0.2"},5482:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loggers=t.Loggers=t.stopLogging=t.startLogging=void 0;const r=s(9068),o=s(1595);let n=!0;t.startLogging=()=>n=!0;t.stopLogging=()=>n=!1;class i{constructor(e="",t=r.LogLevel.info){this.prefix="",this.level=r.LogLevel.info,this.prefix=e,this.level=t}createInstance(e="",t=r.LogLevel.info){return new i(e,t)}log(...e){n&&(o.mode===r.Mode.production&&this.level===r.LogLevel.debug&&o.logLevel!==r.LogLevel.debug||o.mode!==r.Mode.production&&console[this.level===r.LogLevel.error?"error":this.level===r.LogLevel.warn?"warn":"log"](this.prefix||"==>",...e))}error(){return this.createInstance(`ERROR: ${this.prefix}`,r.LogLevel.error)}warn(){return this.createInstance(`WARN: ${this.prefix}`,r.LogLevel.warn)}info(){return this.createInstance(`INFO: ${this.prefix}`,r.LogLevel.info)}debug(){return this.createInstance(`DEBUG: ${this.prefix}`,r.LogLevel.debug)}addPrefix(e){return this.createInstance([this.prefix,e].join(" "),this.level)}setLevel(e){return this.createInstance(this.prefix,e)}}t.Loggers=i,t.loggers=new i},1846:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebugID=t.getDebugPrefix=void 0;const r=s(9068);t.getDebugPrefix=e=>"background"===e?"bg ==>":"content"===e?"cs ==>":"inline"===e?"is ==>":"app"===e?"app ==>":"unknown ==>";const o=(0,r.mapType)("debug-external-der3edc3op3e4dde44rt");!function(e){e[e.debugIDExternal=o]="debugIDExternal"}(t.DebugID||(t.DebugID={}))},3319:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformID=t.Browser=void 0,function(e){e.chrome="chrome",e.firefox="firefox",e.edge="edge"}(t.Browser||(t.Browser={})),function(e){e.MicrosoftSentinel="MicrosoftSentinel",e.MicrosoftDefender="MicrosoftDefender",e.Splunk="Splunk"}(t.PlatformID||(t.PlatformID={}))},7134:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.platformResolver=t.PlatformResolver=void 0;const r=s(5123),o=s(3319),n=s(1595),i=s(6212),a=s(4499),d=s(7838);class l{static getPlatform(e){switch(e){case o.PlatformID.MicrosoftSentinel:return new r.MicrosoftSentinelPlatform;case o.PlatformID.MicrosoftDefender:return new i.MicrosoftDefenderPlatform;case o.PlatformID.Splunk:return new a.SplunkPlatform}}static resolveByUrl(e){const{host:t,protocol:s,href:r}=new URL(e);if((0,d.isAllowedProtocol)(s,n.mode))return/(portal.azure.com|reactblade.portal.azure.net|logsextension.hosting.portal.azure.net)$/.test(t)?l.getPlatform(o.PlatformID.MicrosoftSentinel):/(security.microsoft.com\/)/.test(r)?l.getPlatform(o.PlatformID.MicrosoftDefender):void 0}static resolveByContent(){if(document.querySelector('a[aria-label^="splunk"]'))return l.getPlatform(o.PlatformID.Splunk)}resolve(){return n.contentPlatformIDFromENV?l.getPlatform(n.contentPlatformIDFromENV):l.resolveByUrl(document.location.href)||l.resolveByContent()}}t.PlatformResolver=l,t.platformResolver=new l},6212:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftDefenderPlatform=void 0;const r=s(5404),o=s(1846),n=s(3319),i=s(7281),a=s(332),d=s(6994),l=s(8918),u=s(3799),c=s(8312),p=s(4689),g=s(770),f=s(412),m=s(5482).loggers.addPrefix((0,o.getDebugPrefix)("content")).addPrefix(n.PlatformID.MicrosoftDefender);class v{constructor(){this.extensionDefaultPosition=v.extensionDefaultPosition}getID(){return v.id}static setListeners(){i.addListener(r.ListenerType.OnMessage,(e=>{(0,u.isMessageMatched)((()=>c.MessageToContent.CSModifyQuery===e.type),e)&&(0,d.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--content-modify-query`,type:p.MessageToInline.ISModifyQuery}),!1)})),m.debug().log("listeners were set")}static connectMouseDown(){document.addEventListener("mousedown",(e=>{var t,s;if(!e.altKey)return;const r=(0,a.getElementsUnderCursor)(e,(e=>e.classList.contains("mtk20")||"SPAN"===e.tagName&&Array.from(e.classList).join(",").indexOf("cellName")>-1&&!!e.closest('[role="columnheader"]'))),o=r.length>1?null:(0,a.removeDoubleQuotesAround)((null===(s=null===(t=r[0])||void 0===t?void 0:t.innerText)||void 0===s?void 0:s.trim())||"");o&&(0,d.sendMessageFromContent)({id:`content-add-field--${(0,f.uuid)()}`,type:l.MessageToBackground.BGAddFieldToWatch,payload:{fieldName:o}})})),m.debug().log("mousedown event was set successfully")}static connectInlineListener(){(0,a.mountHTMLElement)("script",document.body,{attributes:{src:(0,a.getWebAccessibleUrl)(g.microsoftDefenderInline),type:"text/javascript","data-type":"inline-listener"}})}connect(){v.setListeners(),v.connectMouseDown(),v.connectInlineListener(),m.debug().log("connected")}}t.MicrosoftDefenderPlatform=v,v.id=n.PlatformID.MicrosoftDefender,v.extensionDefaultPosition={top:0,left:0,width:480,height:480}},5123:function(e,t,s){var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(o,n){function i(e){try{d(r.next(e))}catch(e){n(e)}}function a(e){try{d(r.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}d((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftSentinelPlatform=void 0;const o=s(8918),n=s(6994),i=s(3319),a=s(5404),d=s(7281),l=s(8312),u=s(332),c=s(4689),p=s(1846),g=s(3799),f=s(1595),m=s(770),v=s(7397),h=s(412),y=s(5482).loggers.addPrefix((0,p.getDebugPrefix)("content")).addPrefix(i.PlatformID.MicrosoftSentinel);class b{constructor(){this.extensionDefaultPosition=b.extensionDefaultPosition}getID(){return b.id}static connectMouseDown(){document.addEventListener("mousedown",(e=>{var t,s;if(!e.altKey)return;const r=(0,u.getElementsUnderCursor)(e,(e=>e.classList.contains("ag-header-cell-text")||e.classList.contains("ag-group-value"))),i=r.length>1?null:null===(s=null===(t=r[0])||void 0===t?void 0:t.innerText)||void 0===s?void 0:s.trim();i&&(0,n.sendMessageFromContent)({id:`content-add-field--${(0,h.uuid)()}`,type:o.MessageToBackground.BGAddFieldToWatch,payload:{fieldName:(0,v.normalizeFieldValue)(i)}})})),y.debug().log("mousedown event was set successfully")}static connectInlineListener(){(0,u.mountHTMLElement)("script",document.body,{attributes:{src:(0,u.getWebAccessibleUrl)(m.microsoftSentinelInline),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){d.addListener(a.ListenerType.OnMessage,(e=>r(this,void 0,void 0,(function*(){if(!f.contentPlatformIDFromENV&&!document.querySelector("la-main-view"))return;const t=`script[src$="${m.microsoftSentinelInline}"]`;document.querySelector(t)||(b.connectInlineListener(),b.connectMouseDown(),yield(0,u.waitHTMLElement)(t)),(0,g.isMessageMatched)((()=>l.MessageToContent.CSModifyQuery===e.type),e)&&(0,n.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--content-modify-query`,type:c.MessageToInline.ISModifyQuery}),!1)})))),y.debug().log("listeners were set")}connect(){b.setListeners(),y.debug().log("connected")}}t.MicrosoftSentinelPlatform=b,b.id=i.PlatformID.MicrosoftSentinel,b.extensionDefaultPosition={top:0,left:0,width:500,height:400}},7397:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildMicrosoftSentinelQueryParts=t.normalizedValue=t.normalizeFieldValue=void 0;const r=s(332),o=s(7838);t.normalizeFieldValue=e=>e.indexOf("[UTC]")>-1?e.split("[UTC]").shift().trim():e;t.normalizedValue=e=>{const t=(0,o.isNumberInString)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/\\/g,"\\\\")}"`};t.buildMicrosoftSentinelQueryParts=(e,s)=>(0,r.buildQueryParts)(s,"exclude"===e?"!=":"==","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>(0,t.normalizedValue)(e)})},4499:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SplunkPlatform=void 0;const r=s(5404),o=s(3319),n=s(7281),i=s(3799),a=s(8312),d=s(6994),l=s(4689),u=s(1846),c=s(332),p=s(770),g=s(8918),f=s(412),m=s(5482).loggers.addPrefix((0,u.getDebugPrefix)("content")).addPrefix(o.PlatformID.Splunk);class v{constructor(){this.extensionDefaultPosition=v.extensionDefaultPosition}static normalizeValue(e){return"string"!=typeof e?"":(0,c.removeDoubleQuotesAround)(e.replace("=","").trim())}getID(){return v.id}static setListeners(){n.addListener(r.ListenerType.OnMessage,(e=>{(0,i.isMessageMatched)((()=>a.MessageToContent.CSModifyQuery===e.type),e)&&(0,d.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--content-modify-query`,type:l.MessageToInline.ISModifyQuery}),!1)}))}static connectMouseDown(){document.addEventListener("mousedown",(e=>{var t,s;if(!e.altKey)return;const r=(0,c.getElementsUnderCursor)(e,(e=>"SPAN"===e.tagName&&e.classList.contains("t")&&e.classList.contains("h")&&!!e.closest(".event")||"SPAN"===e.tagName&&e.classList.contains("field")&&!!e.closest(".event")||Array.from(e.attributes).map((e=>e.name)).includes("data-sort-key"))),o=r.length>1?null:v.normalizeValue((null===(t=r[0])||void 0===t?void 0:t.innerText)||(null===(s=r[0])||void 0===s?void 0:s.getAttribute("data-sort-key")));o&&(0,d.sendMessageFromContent)({id:`content-add-field--${(0,f.uuid)()}`,type:g.MessageToBackground.BGAddFieldToWatch,payload:{fieldName:o}})})),m.debug().log("mousedown event was set successfully")}static connectInlineListener(){(0,c.mountHTMLElement)("script",document.body,{attributes:{src:(0,c.getWebAccessibleUrl)(p.splunkInline),type:"text/javascript","data-type":"inline-listener"}})}connect(){v.setListeners(),v.connectMouseDown(),v.connectInlineListener(),m.debug().log("connected")}}t.SplunkPlatform=v,v.id=o.PlatformID.Splunk,v.extensionDefaultPosition={top:0,left:0,width:480,height:480}},7281:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addListener=void 0;const r=s(5404),o=s(332),n=s(1846),i=s(5099),a={};t.addListener=(e,t,...s)=>{var r;null===(r=a[e])||void 0===r||r.call(a,((...e)=>{t(...e)}),...s)};const d=[];a[r.ListenerType.OnMessage]=(e,...t)=>{if((0,i.isRuntimeOnMessageSupported)()){const s=(0,o.getBrowserContext)().runtime.onMessage;d.push((()=>{s.removeListener(e)})),s.addListener(((...t)=>{e(...t)}),...t)}if(!(0,i.isAddEventListenerSupported)())return;const s=s=>{const r=s.data;s.origin===window.location.origin&&r.externalType===n.DebugID.debugIDExternal&&e(s.data,...t)};d.push((()=>{window.removeEventListener("message",s)})),window.addEventListener("message",s)}},6994:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageFromApp=t.sendMessageFromContent=t.sendMessage=void 0;const r=s(332),o=s(1846),n=s(412),i=s(5099),a=s(5482).loggers.addPrefix("services");t.sendMessage=(e,t,s=!0)=>{var o;t.id=t.id||(0,n.uuid)();const a="sendMessage";try{if(!s&&!(0,i.isPostMessageSupported)(t))return;if(!s)return window.postMessage(t),e.debug().log("postMessage",t);if(!(0,i.isRuntimeSendMessageSupported)())return;null===(o=(0,r.getBrowserContext)().runtime.sendMessage(t))||void 0===o||o.catch((s=>e.error().addPrefix(a).log(s,t))),e.debug().addPrefix(a).log(t)}catch(s){e.error().addPrefix(a).log(s,t)}};t.sendMessageFromContent=(e,s=!0)=>(0,t.sendMessage)(a.addPrefix((0,o.getDebugPrefix)("content")),e,s);t.sendMessageFromApp=(e,s=!0)=>(0,t.sendMessage)(a.addPrefix((0,o.getDebugPrefix)("app")),e,s)},5404:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ListenerType=void 0,function(e){e.OnMessage="OnMessage"}(t.ListenerType||(t.ListenerType={}))},8312:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToContent=void 0;const r=s(332);var o;!function(e){e.CSModifyQuery="CSModifyQuery",e.CSConnectPlatform="CSConnectPlatform"}(o=t.MessageToContent||(t.MessageToContent={})),Object.values(o).forEach((e=>{if("content"!==(0,r.getExecutingContextByMessageType)(e))throw new Error(`Wrong content message type "${e}"`)}))},4689:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToInline=void 0;const r=s(332);var o;!function(e){e.ISModifyQuery="ISModifyQuery"}(o=t.MessageToInline||(t.MessageToInline={})),Object.values(o).forEach((e=>{if("inline"!==(0,r.getExecutingContextByMessageType)(e))throw new Error(`Wrong inline message type "${e}"`)}))},770:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accessibleResources=t.splunkInline=t.microsoftDefenderInline=t.microsoftSentinelInline=t.appStyles=void 0;const r=s(3319);t.appStyles="app-styles.css",t.microsoftSentinelInline="inline-microsoft-sentinel.js",t.microsoftDefenderInline="inline-microsoft-defender.js",t.splunkInline="inline-splunk.js",t.accessibleResources={[r.PlatformID.MicrosoftSentinel]:[t.microsoftSentinelInline],[r.PlatformID.MicrosoftDefender]:[t.microsoftDefenderInline],[r.PlatformID.Splunk]:[t.splunkInline],app:[t.appStyles]}}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,s),n.exports}(()=>{const e=s(9148);s(9273),(0,e.registerPlatformsOnOpenedTabs)()})()})();