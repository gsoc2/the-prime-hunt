(()=>{"use strict";var e,t={5673:(e,t,n)=>{var r,s;n.d(t,{$b:()=>s,H$:()=>o,Kt:()=>r}),function(e){e.production="production",e.development="development"}(r||(r={})),function(e){e.info="info",e.debug="debug",e.error="error",e.warn="warn"}(s||(s={}));const o=e=>e},9896:(e,t,n)=>{n.d(t,{Mq:()=>o,dm:()=>a});var r=n(2167),s=n(5673);Object.values(r.bA).includes(null),Object.values(r.bA).includes(null);const o="production"===s.Kt.production?s.Kt.production:s.Kt.development,a=Object.keys(s.$b).includes("info")?"info":s.$b.info},5656:(e,t,n)=>{n.d(t,{C$:()=>o,pM:()=>i});var r=n(5673),s=n(9896);let o,a=s.Mq===r.Kt.development||s.dm===r.$b.debug;const i=e=>{a=e};class c{prefix="";level=r.$b.info;createInstance(e="",t=r.$b.info){return new c(e,t)}constructor(e="",t=r.$b.info){this.prefix=e,this.level=t}log(...e){(this.level!==r.$b.debug||a)&&console[this.level===r.$b.error?"error":this.level===r.$b.warn?"warn":"log"](this.prefix||"==>",...e)}error(){return this.createInstance(`ERROR: ${this.prefix}`,r.$b.error)}warn(){return this.createInstance(`WARN: ${this.prefix}`,r.$b.warn)}info(){return this.createInstance(`INFO: ${this.prefix}`,r.$b.info)}debug(){return this.createInstance(`DEBUG: ${this.prefix}`,r.$b.debug)}addPrefix(e){return this.createInstance([this.prefix,e].join(" "),this.level)}setLevel(e){return this.createInstance(this.prefix,e)}setPrefix(e){return o=this.addPrefix(e),o}}o=new c},5745:(e,t,n)=>{n.d(t,{Nm:()=>o,a9:()=>r,oZ:()=>s});const r=e=>"background"===e?"bg ==>":"content"===e?"cs ==>":"inline"===e?"is ==>":"app"===e?"app ==>":"unknown ==>",s=e=>{let t=(e||"").slice(0,3).toLowerCase();return"app"===t?"app":(t=t.slice(0,2),"bg"===t?"background":"cs"===t?"content":"is"===t?"inline":"unknown")},o="debug-external-der3edc3op3e4dde44rt"},2167:(e,t,n)=>{var r,s,o,a,i;n.d(t,{TT:()=>i,bA:()=>s,by:()=>a}),function(e){e.chrome="chrome",e.firefox="firefox",e.edge="edge"}(r||(r={})),function(e){e.MicrosoftSentinel="MicrosoftSentinel",e.MicrosoftDefender="MicrosoftDefender",e.Splunk="Splunk",e.QRadar="QRadar",e.Elastic="Elastic",e.OpenSearch="OpenSearch",e.ArcSight="ArcSight",e.Athena="Athena",e.LogScale="LogScale",e.Chronicle="Chronicle"}(s||(s={})),function(e){e.ElasticEQl="ElasticEql"}(o||(o={})),function(e){e.Sentinel="ala",e.Defender="mdatp",e.Splunk="splunk",e.Qradar="qradar",e.ElasticEQL="es-eql",e.ElasticLucene="elasticsearch",e.ArcSight="arcsight-keyword",e.Athena="athena",e.LogScale="humio",e.Chronicle="chronicle-query",e.OpenSearch="opendistro-query"}(a||(a={})),function(e){e.MicrosoftSentinel="Microsoft Sentinel",e.MicrosoftDefender="Microsoft Defender For Endpoint",e.Splunk="Splunk",e.QRadar="IBM QRadar",e.Elastic="Elastic",e.OpenSearch="OpenSearch",e.ArcSight="ArcSight",e.Athena="Amazon Athena",e.LogScale="Falcon LogScale",e.Chronicle="Chronicle"}(i||(i={}))}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=r(5745),r(5656).C$.setPrefix((0,e.a9)("inline")),(()=>{var e=r(5656);const t=(t,n,...r)=>!!t()&&(e.C$.debug().log(`got ${n.type} message`,n,...r),!0);var n,s=r(5745);!function(e){e.ISModifyQuery="ISModifyQuery",e.ISSetQuery="ISSetQuery",e.ISGetQuery="ISGetQuery",e.ISSetDebugMode="ISSetDebugMode",e.ISRemoveHash="ISRemoveHash",e.ISRemoveFieldSpecification="ISRemoveFieldSpecification"}(n||(n={})),Object.values(n).forEach((e=>{if("inline"!==(0,s.oZ)(e))throw new Error(`Wrong inline message type "${e}"`)}));var o=r(5673);const a=e=>{if("number"==typeof e)return!0;if("string"!=typeof e)return!1;const t=e.trim();return!(!/^[-.0-9]*$/.test(t)||d(t,".").length>1)&&!Number.isNaN(parseFloat(t))},i=()=>Math.random().toString(36).substring(5)+Date.now().toString(36)+Math.random().toString(36).substring(5),c=e=>[...Array.from(new Set([...e]))],d=(e,t)=>{const n=[];let r=-1;for(;(r=e.indexOf(t,r+1))>=0;)n.push(r);return n};var u;!function(e){e.OnMessage="OnMessage"}(u||(u={}));var p,l=r(2167);!function(e){e[e.debugIDExternal=(0,o.H$)(s.Nm)]="debugIDExternal"}(p||(p={}));const g=()=>"undefined"!=typeof browser?browser:chrome,f=r(5656).C$.addPrefix("api-support"),S=(...e)=>!!g()?.runtime?.getURL||(f.warn().log("API runtime.getURL is not supported",...e),!1),b={},h=[];b[u.OnMessage]=(e,...t)=>{if(((...e)=>!!g().runtime?.onMessage?.addListener||(f.warn().log("API runtime.onMessage.addListener is not supported",...e),!1))()){const n=g().runtime.onMessage;h.push((()=>{n.removeListener(e)})),n.addListener(((...t)=>{e(...t)}),...t)}if(!((...e)=>!!window?.addEventListener||(f.warn().log("API window.addEventListener is not supported",...e),!1))())return;const n=n=>{const r=n.data;n.origin!==window.location.origin||"content"!==(0,s.oZ)(r.type)&&r.externalType!==p.debugIDExternal||e(n.data,...t)};h.push((()=>{window.removeEventListener("message",n)})),window.addEventListener("message",n)};const y=(e,t,n)=>{const r=document.createElement(e);return n?.attributes&&Object.keys(n.attributes).forEach((e=>{var t;r.setAttribute(e,"style"===e?(t=n.attributes[e],Object.keys(t).reduce(((e,n)=>e+`${n}:${t[n]};`),"")):n.attributes?.[e]||"")})),n?.innerHtml&&(r.innerHTML=n.innerHtml),n?.innerText&&(r.innerText=n.innerText),t&&t.append(r),r},A="inline-splunk.js";l.bA.MicrosoftSentinel,l.bA.MicrosoftDefender,l.bA.Splunk,l.bA.QRadar,l.bA.Elastic,l.bA.ArcSight,l.bA.Athena,l.bA.OpenSearch,l.bA.LogScale,l.bA.Chronicle;var m;!function(e){e.Accounts="Accounts",e.Assets="Assets"}(m||(m={}));Object.keys(m);var M;!function(e){e.CSConnectPlatform="CSConnectPlatform",e.CSSetDebugMode="CSSetDebugMode",e.CSDirectMessageToApp="CSDirectMessageToApp",e.CSDirectMessageToInline="CSDirectMessageToInline"}(M||(M={})),Object.values(M).forEach((e=>{if("content"!==(0,s.oZ)(e))throw new Error(`Wrong content message type "${e}"`)}));const w=r(5656).C$.addPrefix("services"),v=(e,t,n=!0)=>{t.id=`${t.id?`${t.id}--`:""}${i()}`;const r="sendMessage";try{return n||((...e)=>!!window?.postMessage||(f.warn().log("API window.postMessage is not supported",...e),!1))(t)?n?((...e)=>!!g()?.runtime?.sendMessage||(f.warn().log("API runtime.sendMessage is not supported",...e),!1))()?(g().runtime.sendMessage(t)?.catch((n=>e.error().addPrefix(r).log(n,t))),e.debug().addPrefix(r).log(t),t):t:(window.postMessage(t),e.debug().log("postMessage",t),t):t}catch(n){return e.error().addPrefix(r).log(n,t),t}},$=(e,t=!0)=>v(w.addPrefix("message-from-content"),e,t);var x;!function(e){e.BGDirectMessageToApp="BGDirectMessageToApp",e.BGDirectMessageToInline="BGDirectMessageToInline",e.BGSetWatchers="BGSetWatchers",e.BGRegisterPlatformTab="BGRegisterPlatformTab",e.BGToggleShowExtension="BGToggleShowExtension",e.BGSetDebugMode="BGSetDebugMode",e.BGTakeCallbackMessage="BGTakeCallbackMessage"}(x||(x={})),Object.values(x).forEach((e=>{if("background"!==(0,s.oZ)(e))throw new Error(`Wrong background message type "${e}"`)}));class I{fields=new Set;static processInlineListeners(e){if(t((()=>M.CSSetDebugMode===e.type),e)){const{debugMode:t}=e.payload;r(5656).pM(t),$({...e,id:`${e.id}--${e.type}`,type:n.ISSetDebugMode},!1)}if(t((()=>M.CSDirectMessageToApp===e.type),e)&&$({id:`${e.id}--${e.type}`,type:x.BGDirectMessageToApp,payload:e.payload}),t((()=>M.CSDirectMessageToInline===e.type),e)){const{type:t,payload:n}=e.payload;$({id:`${e.id}--${e.type}`,type:t,payload:n},!1)}}}let D;class T extends I{defaultWatchers={[m.Accounts]:c(["src_user","src_user_bunit","user","Account_Name","User","src_user_name","user_name"]),[m.Assets]:c(["dest_host","dst","dest_nt_host","src_host","src_nt_host","src","dest","dest_name","dest_host","dvc","dvc_host","dest_dns","src_dns","ComputerName","DestinationHostname","SourceHostname"])};static id=l.bA.Splunk;static extensionDefaultPosition={top:0,left:0,width:480,height:480};static normalizedValue(e){const t=a(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/"/g,'\\"')}"`}static buildQueryParts(e,t,n=!1){return((e,t,n,r,s,o)=>{const a=[];Object.keys(e).forEach((r=>{a.push(e[r].map((e=>`${s.leftOperand(r)}${t(r,e)}${s.rightOperand(e)}`)).join(n))}));const i=a.join(r);return o?`${o} ${i}`:i})(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>T.normalizedValue(e)},n?"where":void 0)}buildQueryParts(e,t,n){return T.buildQueryParts(e,t,n)}extensionDefaultPosition=T.extensionDefaultPosition;getID(){return T.id}getName(){return l.TT.Splunk}getType(){return l.by.Splunk}static setListeners(){((e,t,...n)=>{b[e]?.(((...e)=>{t(...e)}),...n)})(u.OnMessage,(e=>{I.processInlineListeners(e)}))}static connectInlineListener(){var e;y("script",document.body,{attributes:{src:(e=A,S(e)?g().runtime.getURL(e):""),type:"text/javascript","data-type":"inline-listener"}})}connect(){T.setListeners(),T.connectInlineListener(),D.debug().log("connected")}}var k;D=r(5656).C$.addPrefix(T.id),function(e){e.AppShowExtension="AppShowExtension",e.AppTakeResourceData="AppTakeResourceData",e.AppTakeNewResourceData="AppTakeNewResourceData",e.AppSyncWatchers="AppSyncWatchers",e.AppQueryHasHash="AppQueryHasHash",e.AppQueryHasSpecifyFields="AppQueryHasSpecifyFields",e.AppSetLoadingState="AppSetLoadingState",e.AppToggleShowExtension="AppToggleShowExtension",e.AppSendToBackground="AppSendToBackground",e.AppSendMessageOutside="AppSendMessageOutside",e.AppTakeQuery="AppTakeQuery",e.AppSetDebugMode="AppSetDebugMode",e.AppTakeCallbackMessageResult="AppTakeCallbackMessageResult"}(k||(k={})),Object.values(k).forEach((e=>{if("app"!==(0,s.oZ)(e))throw new Error(`Wrong app message type "${e}"`)}));const E=new T,C=r(5656).C$.addPrefix(E.getID()),O=()=>(e=>{try{return ace.edit(e)}catch(e){return null}})(document.querySelector("pre.ace_editor"));window.addEventListener("message",(e=>{const s=e.data;if(t((()=>n.ISModifyQuery===s.type),s,e)){const e=O();if(!e)return void C.error().log("editor not found",ace);const{resources:t,modifyType:n}=s.payload,r=` | ${E.buildQueryParts(n,t,!0)}`;e.setValue(((e,t,n)=>{const r=`${"show all"===n?e.split("|").shift()?.trim()||"<unknown>":e} ${t}`;return r.replace(/ +/g," ")})(e.getValue(),r,n))}if(t((()=>n.ISSetQuery===s.type),s,e)){const e=O();if(!e)return;const{value:t}=s.payload;e.setValue(t)}if(t((()=>n.ISGetQuery===s.type),s,e)){const e=O();if(!e)return;((o=e.getValue())||a)&&window.postMessage({id:i(),type:M.CSDirectMessageToApp,payload:{type:k.AppTakeQuery,payload:{queryValue:o,queryMeta:a}}})}var o,a;if(t((()=>n.ISSetDebugMode===s.type),s,e)){const{debugMode:e}=s.payload;r(5656).pM(e)}})),C.debug().log("mounted")})()})();