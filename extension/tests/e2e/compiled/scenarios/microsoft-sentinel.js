(()=>{"use strict";var e={629:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Register=void 0,t.Register=class{constructor(){this.storage=new Map}set(e,t){return this.storage.set(e,t),t}get(e){return this.storage.get(e)}remove(e){return!!this.storage.has(e)&&(this.storage.delete(e),!0)}has(e){return this.storage.has(e)}}},641:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isDate=t.isAllowedProtocol=t.isNumberInString=t.isNotEmpty=t.isString=void 0;const s=o(407),n=o(959);t.isString=e=>"string"==typeof e,t.isNotEmpty=e=>!!(0,t.isString)(e)&&""!==e.trim(),t.isNumberInString=e=>{if("number"==typeof e)return!0;if("string"!=typeof e)return!1;const t=e.trim();return!(!/^[-.0-9]*$/.test(t)||(0,n.indexOfAll)(t,".").length>1||Number.isNaN(parseFloat(t)))},t.isAllowedProtocol=(e,t)=>{if(t===s.Mode.development)return!0;const o=e.trim().toLowerCase();return"https:"===o||"https"===o},t.isDate=e=>new Date("string"==typeof e&&(0,t.isNumberInString)(e)?parseInt(e):e).getTime()>5679828e5},959:function(e,t){var o=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=t.indexOfAll=t.sortNumbers=t.debounce=t.formatDate=t.formatBinaryDate=t.createNonDuplicateValue=t.capitalizeFirstLetter=t.formatString=t.deduplicateArray=t.parseJSONSafe=t.splitByLines=t.clearLineBreaks=t.clearExtraSpaces=t.uuid=t.isFlatObjectsEqual=void 0,t.isFlatObjectsEqual=(e,t)=>{const o=Object.keys(e),s=Object.keys(t);return o.length===s.length&&!o.some((o=>e[o]!==t[o]))},t.uuid=()=>Math.random().toString(36).substring(5)+Date.now().toString(36)+Math.random().toString(36).substring(5),t.clearExtraSpaces=e=>e.replace(/ +/g," "),t.clearLineBreaks=e=>e.trim().replace(/(\r\n|\n|\r)/gm," "),t.splitByLines=(e,t=!1)=>{const o=new RegExp(/(\r\n|\n|\r)/,"gm");let s=e.split(o);return t&&(s=s.filter((e=>e&&"\r\n"!==e&&"\n"!==e&&"\r"!==e))),s},t.parseJSONSafe=(e,t)=>{try{return JSON.parse(e)}catch(e){return t}},t.deduplicateArray=e=>[...Array.from(new Set([...e]))],t.formatString=(e,t,o)=>Object.keys(t||{}).map((e=>({value:t[e],key:o?o(e):`%${e}`}))).reduce(((e,t)=>e.replace(new RegExp(t.key,"g"),t.value)),e)||e,t.capitalizeFirstLetter=e=>`${e.charAt(0).toUpperCase()}${e.slice(1)}`,t.createNonDuplicateValue=(e,t)=>{if(!t.includes(e))return e;let o=1,s=e,n=s.slice(0,s.length-1);for(;t.includes(n);)s=n,n=n.slice(0,n.length-1);for(;t.includes(`${s}${o}`);)o++;return`${s}${o}`},t.formatBinaryDate=e=>{const t="string"==typeof e?e:String(e);return t.length>1?t:`0${t}`},t.formatDate=(e,o)=>(0,t.formatString)(e,{Y:String(o.getFullYear()),M:(0,t.formatBinaryDate)(o.getMonth()+1),m:(0,t.formatBinaryDate)(o.getMinutes()),s:(0,t.formatBinaryDate)(o.getSeconds()),ms:(0,t.formatBinaryDate)(o.getMilliseconds()),d:(0,t.formatBinaryDate)(o.getDate()),h:(0,t.formatBinaryDate)(o.getHours())}),t.debounce=(e,t)=>{let o;return function(...s){const n=this;clearTimeout(o),o=setTimeout((()=>e.apply(n,s)),t)}},t.sortNumbers=(e,t)=>e>t?1:e<t?-1:0,t.indexOfAll=(e,t)=>{const o=[];let s=-1;for(;(s=e.indexOf(t,s+1))>=0;)o.push(s);return o},t.sleep=e=>o(void 0,void 0,void 0,(function*(){return new Promise((t=>{setTimeout((()=>{t(null)}),1e3*e)}))}))},407:(e,t)=>{var o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.mapType=t.LogLevel=t.Mode=void 0,(s=t.Mode||(t.Mode={})).production="production",s.development="development",(o=t.LogLevel||(t.LogLevel={})).info="info",o.debug="debug",o.error="error",o.warn="warn",t.mapType=e=>e},60:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.integrations=void 0,t.integrations=[{id:"virus-total",name:"VirusTotal",url:"https://www.virustotal.com/gui/search/$VALUE$"},{id:"virus-total-enterprise",name:"VirusTotal Enterprise",url:"https://www.virustotal.com/gui/search/$VALUES$"},{id:"anomali",name:"Anomali",url:"https://ui.threatstream.com/search?status=active&multiSearchResults=true&value__re=.*$VALUE$.*"},{id:"open-cti",name:"OpenCTI",url:"https://HOSTNAME:PORT/dashboard/observations/indicators?sortBy=created&orderAsc=false&searchTerm=$VALUE$"},{id:"$echo-trail",name:"EchoTrail",url:"https://www.echotrail.io/insights/search/$VALUE$"},{id:"$ultimate-windows-security",name:"Ultimate Windows Security",url:"https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=$VALUE$"},{id:"$cyber-chef$",name:"CyberChef",url:"https://gchq.github.io/CyberChef/#input=$BASE64-VALUE$"},{id:"$cyber-chef-magic$",name:"CyberChef (Magic)",url:"https://gchq.github.io/CyberChef/#recipe=Magic(3,false,false,'')&input=$BASE64-VALUE$"}]},681:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.boundedResourcesTypeIDs=t.BoundedResourceTypeID=void 0,function(e){e.Accounts="Accounts",e.Assets="Assets"}(o=t.BoundedResourceTypeID||(t.BoundedResourceTypeID={})),t.boundedResourcesTypeIDs=Object.keys(o)},138:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToApp=void 0;const s=o(519);var n;!function(e){e.AppShowExtension="AppShowExtension",e.AppTakeResourceData="AppTakeResourceData",e.AppSyncWatchers="AppSyncWatchers",e.AppTakeNewResourceData="AppTakeNewResourceData",e.AppQueryHasHash="AppQueryHasHash",e.AppQueryHasSpecifyFields="AppQueryHasSpecifyFields",e.AppClearResourceData="AppClearResourceData",e.AppSetLoadingState="AppSetLoadingState",e.AppToggleShowExtension="AppToggleShowExtension",e.AppSendToBackground="AppSendToBackground",e.AppSendMessageOutside="AppSendMessageOutside",e.AppSetDebugMode="AppSetDebugMode"}(n=t.MessageToApp||(t.MessageToApp={})),Object.values(n).forEach((e=>{if("app"!==(0,s.getExecutingContextByMessageType)(e))throw new Error(`Wrong app message type "${e}"`)}))},743:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToBackground=void 0;const s=o(519);var n;!function(e){e.BGRunClearData="BGRunClearData",e.BGModifyQuery="BGModifyQuery",e.BGSetQuery="BGSetQuery",e.BGGetQuery="BGGetQuery",e.BGDirectMessageToApp="BGDirectMessageToApp",e.BGSendMessageOutside="BGSendMessageOutside",e.BGSetWatchers="BGSetWatchers",e.BGRegisterPlatformTab="BGRegisterPlatformTab",e.BGToggleShowExtension="BGToggleShowExtension",e.BGSetDebugMode="BGSetDebugMode",e.BGDirectMessageToInline="BGDirectMessageToInline"}(n=t.MessageToBackground||(t.MessageToBackground={})),Object.values(n).forEach((e=>{if("background"!==(0,s.getExecutingContextByMessageType)(e))throw new Error(`Wrong background message type "${e}"`)}))},696:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isRuntimeGetUrlSupported=t.isTabsSendMessageSupported=t.isTabsQuerySupported=t.isOnBeforeSendHeadersSupported=t.isOnBeforeRequestSupported=t.isBrowserActionOnClickedSupported=t.isActionOnClickedSupported=t.isTabsOnRemovedSupported=t.isRuntimeOnMessageExternalSupported=t.isRuntimeOnMessageSupported=t.isRuntimeSendMessageSupported=t.isAddEventListenerSupported=t.isPostMessageSupported=void 0;const s=o(835),n=o(376).loggers.addPrefix("api-support");t.isPostMessageSupported=(...e)=>!!(null===window||void 0===window?void 0:window.postMessage)||(n.warn().log("API window.postMessage is not supported",...e),!1),t.isAddEventListenerSupported=(...e)=>!!(null===window||void 0===window?void 0:window.addEventListener)||(n.warn().log("API window.addEventListener is not supported",...e),!1),t.isRuntimeSendMessageSupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.runtime)||void 0===o?void 0:o.sendMessage)||(n.warn().log("API runtime.sendMessage is not supported",...e),!1)},t.isRuntimeOnMessageSupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)().runtime)||void 0===t?void 0:t.onMessage)||void 0===o?void 0:o.addListener)||(n.warn().log("API runtime.onMessage.addListener is not supported",...e),!1)},t.isRuntimeOnMessageExternalSupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)().runtime)||void 0===t?void 0:t.onMessageExternal)||void 0===o?void 0:o.addListener)||(n.warn().log("API runtime.onMessageExternal.addListener is not supported",...e),!1)},t.isTabsOnRemovedSupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)().tabs)||void 0===t?void 0:t.onRemoved)||void 0===o?void 0:o.addListener)||(n.warn().log("API tabs.onRemoved.addListener is not supported",...e),!1)},t.isActionOnClickedSupported=(...e)=>{var t,o,r;return!!(null===(r=null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.action)||void 0===o?void 0:o.onClicked)||void 0===r?void 0:r.addListener)||(n.warn().log("API action.onClicked.addListener is not supported",...e),!1)},t.isBrowserActionOnClickedSupported=(...e)=>{var t,o,r;return!!(null===(r=null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.browserAction)||void 0===o?void 0:o.onClicked)||void 0===r?void 0:r.addListener)||(n.warn().log("API browserAction.onClicked.addListener is not supported",...e),!1)},t.isOnBeforeRequestSupported=(...e)=>{var t,o,r;return!!(null===(r=null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.webRequest)||void 0===o?void 0:o.onBeforeRequest)||void 0===r?void 0:r.addListener)||(n.warn().log("API webRequest.onBeforeRequest is not supported",...e),!1)},t.isOnBeforeSendHeadersSupported=(...e)=>{var t,o,r;return!!(null===(r=null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.webRequest)||void 0===o?void 0:o.onBeforeSendHeaders)||void 0===r?void 0:r.addListener)||(n.warn().log("API webRequest.onBeforeSendHeaders is not supported",...e),!1)},t.isTabsQuerySupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.tabs)||void 0===o?void 0:o.query)||(n.warn().log("API tabs.query is not supported",...e),!1)},t.isTabsSendMessageSupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.tabs)||void 0===o?void 0:o.sendMessage)||(n.warn().log("API tabs.sendMessage is not supported",...e),!1)},t.isRuntimeGetUrlSupported=(...e)=>{var t,o;return!!(null===(o=null===(t=(0,s.getBrowserContext)())||void 0===t?void 0:t.runtime)||void 0===o?void 0:o.getURL)||(n.warn().log("API runtime.getURL is not supported",...e),!1)}},835:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getWebAccessibleUrl=t.getBrowserContext=void 0;const s=o(696);t.getBrowserContext=()=>"undefined"!=typeof browser?browser:chrome,t.getWebAccessibleUrl=e=>(0,s.isRuntimeGetUrlSupported)(e)?(0,t.getBrowserContext)().runtime.getURL(e):""},303:function(e,t){var o=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createFormDataString=t.compareVersions=t.getVersionFromString=t.removeDoubleQuotesAround=t.removeQuotesAround=t.removeBracketsAround=t.buildQueryParts=t.getElementsUnderCursor=t.downloadFile=t.copyToClipboard=t.createClassName=t.waitHTMLElement=t.isInsideIframe=t.mountHTMLElement=t.cssObjectToString=void 0,t.cssObjectToString=e=>Object.keys(e).reduce(((t,o)=>t+`${o}:${e[o]};`),""),t.mountHTMLElement=(e,o,s)=>{const n=document.createElement(e);return(null==s?void 0:s.attributes)&&Object.keys(s.attributes).forEach((e=>{var o;n.setAttribute(e,"style"===e?(0,t.cssObjectToString)(s.attributes[e]):(null===(o=s.attributes)||void 0===o?void 0:o[e])||"")})),(null==s?void 0:s.innerHtml)&&(n.innerHTML=s.innerHtml),(null==s?void 0:s.innerText)&&(n.innerText=s.innerText),o&&o.append(n),n},t.isInsideIframe=()=>{try{return window.self!==window.top}catch(e){return!0}},t.waitHTMLElement=(e,t=document)=>o(void 0,void 0,void 0,(function*(){return new Promise((o=>{new MutationObserver(((s,n)=>{const r=t.querySelector(e);r&&(n.disconnect(),o(r))})).observe(t,{childList:!0,subtree:!0})}))})),t.createClassName=e=>e.filter(Boolean).join(" "),t.copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.opacity="0",t.style.position="absolute",t.style.left="-99999px",t.style.top="-99999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},t.downloadFile=(e,t,o)=>{const s=document.createElement("a");s.setAttribute("href",encodeURI(`data:text/csv;charset=utf-8,${t}`)),s.setAttribute("download",`${o}.csv`),document.body.appendChild(s),s.click(),document.body.removeChild(s)},t.getElementsUnderCursor=(e,t)=>{const o=e.clientX,s=e.clientY,n=[],r=[];let i=document.elementFromPoint(o,s);for(;"HTML"!==i.tagName;){const e=i.style.pointerEvents;if(!i)break;(!t||t&&t(i))&&n.push(i),r.push({savedPointerEvents:e,element:i}),i.style.pointerEvents="none",i=document.elementFromPoint(o,s)}return r.forEach((({element:e,savedPointerEvents:t})=>{t?e.style.pointerEvents=t:e.style.removeProperty("pointer-events"),e.getAttribute("style")||e.removeAttribute("style")})),n},t.buildQueryParts=(e,t,o,s,n,r)=>{const i=[];Object.keys(e).forEach((s=>{i.push(e[s].map((e=>`${n.leftOperand(s)}${t(s,e)}${n.rightOperand(e)}`)).join(o))}));const a=i.join(s);return r?`${r} ${a}`:a},t.removeBracketsAround=e=>{let t=e;return"("===e[0]&&(t=t.slice(1)),")"===e[e.length-1]&&(t=t.slice(0,e.length-2)),t},t.removeQuotesAround=e=>{let t=e;return'"'!==e[0]&&"'"!==e[0]||(t=t.slice(1)),'"'!==e[e.length-1]&&"'"!==e[e.length-1]||(t=t.slice(0,e.length-2)),t},t.removeDoubleQuotesAround=e=>{let t=e;return'"'===e[0]&&(t=t.slice(1)),'"'===e[e.length-1]&&(t=t.slice(0,e.length-2)),t},t.getVersionFromString=e=>{if("string"!=typeof e||!/^[.0-9]+$/.test(e))return 0;const t=parseInt(e.replace(/\./g,""));return isNaN(t)?0:t},t.compareVersions=(e,o)=>{const s=(0,t.getVersionFromString)(e),n=(0,t.getVersionFromString)(o);return s===n?"equal":s>n?"greater":"less"},t.createFormDataString=e=>{const t=[];for(const[o,s]of Object.entries(e))t.push(`${encodeURIComponent(o)}=${encodeURIComponent(s)}`);return t.join("&").replace(/%20/g,"+")}},898:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isMessageMatched=void 0;const s=o(376);t.isMessageMatched=(e,t,...o)=>!!e()&&(s.loggers.debug().log(`got ${t.type} message`,t,...o),!0)},80:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.logLevel=t.mode=t.backgroundPlatformIDFromENV=t.contentPlatformIDFromENV=void 0;const s=o(168),n=o(407);t.contentPlatformIDFromENV=Object.values(s.PlatformID).includes(process.env.CONTENT_PLATFORM)?process.env.CONTENT_PLATFORM:null,t.backgroundPlatformIDFromENV=Object.values(s.PlatformID).includes(process.env.BACKGROUND_PLATFORM)?process.env.BACKGROUND_PLATFORM:null,t.mode=process.env.MODE===n.Mode.production?n.Mode.production:n.Mode.development,t.logLevel=Object.keys(n.LogLevel).includes(process.env.LOG_LEVEL)?process.env.LOG_LEVEL:n.LogLevel.info,t.version=process.env.VERSION},619:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setVersion=t.getVersion=t.restoreIntegrations=t.getIntegrations=t.setIntegrations=t.getPosition=t.setPosition=t.getWatchers=t.setWatchers=t.versionStorageKey=t.integrationsStorageKey=t.positionStorageKey=t.watchersLocalStorageKey=void 0;const s=o(60);t.watchersLocalStorageKey="the-prime-hunt--extension--watchers",t.positionStorageKey="the-prime-hunt--extension--position",t.integrationsStorageKey="the-prime-hunt--extension--integrations",t.versionStorageKey="the-prime-hunt--extension--version",t.setWatchers=e=>(localStorage.setItem(t.watchersLocalStorageKey,JSON.stringify(e)),e);const n=e=>{var t;return(null===(t=o(682).k_.getPlatformByID(e))||void 0===t?void 0:t.defaultWatchers)||{}};t.getWatchers=e=>{try{const o=JSON.parse(localStorage.getItem(t.watchersLocalStorageKey)||"");return(0,t.setWatchers)(Object.keys(o).length>0?o:n(e))}catch(o){return(0,t.setWatchers)(n(e))}},t.setPosition=e=>(localStorage.setItem(t.positionStorageKey,JSON.stringify(e)),e),t.getPosition=()=>{try{return JSON.parse(localStorage.getItem(t.positionStorageKey)||"")}catch(e){return null}},t.setIntegrations=e=>(localStorage.setItem(t.integrationsStorageKey,JSON.stringify(e)),e),t.getIntegrations=()=>{try{return JSON.parse(localStorage.getItem(t.integrationsStorageKey)||"")}catch(e){return s.integrations}},t.restoreIntegrations=()=>((0,t.setIntegrations)(s.integrations),s.integrations),t.getVersion=()=>localStorage.getItem(t.versionStorageKey)||"0",t.setVersion=e=>{localStorage.setItem(t.versionStorageKey,e)}},376:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setLoggers=t.Loggers=t.setDebugMode=t.loggers=void 0;const s=o(407),n=o(80);let r=n.mode===s.Mode.development||n.logLevel===s.LogLevel.debug;t.setDebugMode=e=>{r=e};class i{constructor(e="",t=s.LogLevel.info){this.prefix="",this.level=s.LogLevel.info,this.prefix=e,this.level=t}createInstance(e="",t=s.LogLevel.info){return new i(e,t)}log(...e){(this.level!==s.LogLevel.debug||r)&&console[this.level===s.LogLevel.error?"error":this.level===s.LogLevel.warn?"warn":"log"](this.prefix||"==>",...e)}error(){return this.createInstance(`ERROR: ${this.prefix}`,s.LogLevel.error)}warn(){return this.createInstance(`WARN: ${this.prefix}`,s.LogLevel.warn)}info(){return this.createInstance(`INFO: ${this.prefix}`,s.LogLevel.info)}debug(){return this.createInstance(`DEBUG: ${this.prefix}`,s.LogLevel.debug)}addPrefix(e){return this.createInstance([this.prefix,e].join(" "),this.level)}setLevel(e){return this.createInstance(this.prefix,e)}setPrefix(e){return t.loggers=this.addPrefix(e),t.loggers}}t.Loggers=i,t.loggers=new i,t.setLoggers=e=>{t.loggers=e}},673:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebugID=void 0;const s=o(407),n=o(519);var r;(r=t.DebugID||(t.DebugID={}))[r.debugIDExternal=(0,s.mapType)(process.env.DEBUG_ID||n.debugID)]="debugIDExternal"},519:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.debugID=t.getExecutingContextByMessageType=t.getDebugPrefix=void 0,t.getDebugPrefix=e=>"background"===e?"bg ==>":"content"===e?"cs ==>":"inline"===e?"is ==>":"app"===e?"app ==>":"unknown ==>",t.getExecutingContextByMessageType=e=>{let t=(e||"").slice(0,3).toLowerCase();return"app"===t?"app":(t=t.slice(0,2),"bg"===t?"background":"cs"===t?"content":"is"===t?"inline":"unknown")},t.debugID="debug-external-der3edc3op3e4dde44rt"},168:(e,t)=>{var o,s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformName=t.PlatformID=t.Browser=void 0,(n=t.Browser||(t.Browser={})).chrome="chrome",n.firefox="firefox",n.edge="edge",(s=t.PlatformID||(t.PlatformID={})).MicrosoftSentinel="MicrosoftSentinel",s.MicrosoftDefender="MicrosoftDefender",s.Splunk="Splunk",s.QRadar="QRadar",s.Elastic="Elastic",s.OpenSearch="OpenSearch",s.ArcSight="ArcSight",s.Athena="Athena",(o=t.PlatformName||(t.PlatformName={})).MicrosoftSentinel="Microsoft Sentinel",o.MicrosoftDefender="Microsoft Defender For Endpoint",o.Splunk="Splunk",o.QRadar="IBM QRadar",o.Elastic="Elastic",o.OpenSearch="OpenSearch",o.ArcSight="ArcSight",o.Athena="Amazon Athena"},990:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractContentPlatform=void 0;const s=o(898),n=o(53),r=o(591),i=o(118),a=o(743);t.AbstractContentPlatform=class{static processInlineListeners(e){if((0,s.isMessageMatched)((()=>n.MessageToContent.CSModifyQuery===e.type),e)&&(0,r.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--${e.type}`,type:i.MessageToInline.ISModifyQuery}),!1),(0,s.isMessageMatched)((()=>n.MessageToContent.CSSetQuery===e.type),e)&&(0,r.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--${e.type}`,type:i.MessageToInline.ISSetQuery}),!1),(0,s.isMessageMatched)((()=>n.MessageToContent.CSGetQuery===e.type),e)&&(0,r.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--${e.type}`,type:i.MessageToInline.ISGetQuery}),!1),(0,s.isMessageMatched)((()=>n.MessageToContent.CSSendMessageOutside===e.type),e)&&(0,r.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--${e.type}`,type:a.MessageToBackground.BGSendMessageOutside})),(0,s.isMessageMatched)((()=>n.MessageToContent.CSSetDebugMode===e.type),e)){const{debugMode:t}=e.payload;o(376).setDebugMode(t),(0,r.sendMessageFromContent)(Object.assign(Object.assign({},e),{id:`${e.id}--${e.type}`,type:i.MessageToInline.ISSetDebugMode}),!1)}if((0,s.isMessageMatched)((()=>n.MessageToContent.CSDirectMessageToApp===e.type),e)&&(0,r.sendMessageFromContent)({id:`${e.id}--${e.type}`,type:a.MessageToBackground.BGDirectMessageToApp,payload:e.payload}),(0,s.isMessageMatched)((()=>n.MessageToContent.CSDirectMessageToInline===e.type),e)){const{type:t,payload:o}=e.payload;(0,r.sendMessageFromContent)({id:`${e.id}--${e.type}`,type:t,payload:o},!1)}}}},930:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AmazonAthenaPlatform=void 0;const n=o(990),r=o(681),i=o(640),a=o(168),l=o(641),c=o(303),u=o(632),d=o(253),g=o(835);let p;class m extends n.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[r.BoundedResourceTypeID.Accounts]:["actor.user.name"],[r.BoundedResourceTypeID.Assets]:["device.name"]},this.extensionDefaultPosition=m.extensionDefaultPosition}static normalizedValue(e){const t=(0,l.isNumberInString)(e)?parseFloat(e):e;return"number"==typeof t?t:`'${t.replace(/'/g,'"')}'`}static buildQueryParts(e,t,o){return(0,c.buildQueryParts)(t,(()=>"exclude"===e?" != ":" = "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>e,rightOperand:e=>m.normalizedValue(e)},o?"where":void 0)}buildQueryParts(e,t,o){return m.buildQueryParts(e,t,o)}static connectInlineListener(){(0,c.mountHTMLElement)("script",document.body,{attributes:{src:(0,g.getWebAccessibleUrl)(d.amazonAthenaInline),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){u.addListener(i.ListenerType.OnMessage,(e=>s(this,void 0,void 0,(function*(){n.AbstractContentPlatform.processInlineListeners(e)})))),p.debug().log("listeners were set")}connect(){m.setListeners(),m.connectInlineListener(),p.debug().log("connected")}getID(){return m.id}getName(){return a.PlatformName.Athena}}t.AmazonAthenaPlatform=m,m.extensionDefaultPosition={top:0,left:0,width:480,height:480},m.id=a.PlatformID.Athena,p=o(376).loggers.addPrefix(m.id)},833:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ArcSightPlatform=void 0;const n=o(640),r=o(168),i=o(681),a=o(641),l=o(303),c=o(632),u=o(80),d=o(253),g=o(835),p=o(990);let m;class f extends p.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[i.BoundedResourceTypeID.Accounts]:["sourceUserName","destinationUserName"],[i.BoundedResourceTypeID.Assets]:["sourceAddress","destinationAddress"]},this.extensionDefaultPosition=f.extensionDefaultPosition}static buildQueryParts(e,t,o){const s=(0,l.buildQueryParts)(t,((t,o)=>o.indexOf("EET")>-1&&(0,a.isDate)(o.split("EET").shift())?"exclude"===e?" <= ":" >= ":"exclude"===e?" != ":" = "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>e,rightOperand:e=>f.normalizedValue(e)},o&&"include"!==e?"AND":void 0);return"include"===e&&o?s.indexOf(" OR ")>-1?`AND (${s})`:`AND ${s}`:s}buildQueryParts(e,t,o){return f.buildQueryParts(e,t,o)}connect(){f.setListeners(),m.debug().log("connected")}getID(){return f.id}getName(){return r.PlatformName.ArcSight}static connectInlineListener(){(0,l.mountHTMLElement)("script",document.body,{attributes:{src:(0,g.getWebAccessibleUrl)(d.arcSightInline),type:"text/javascript","data-type":"inline-listener"}}),m.debug().log("inline were set")}static setListeners(){c.addListener(n.ListenerType.OnMessage,(e=>s(this,void 0,void 0,(function*(){if(!document.querySelector("textarea#queryInput")&&!u.contentPlatformIDFromENV)return;const t=`script[src$="${d.arcSightInline}"]`;document.querySelector(t)||(f.connectInlineListener(),yield(0,l.waitHTMLElement)(t)),p.AbstractContentPlatform.processInlineListeners(e)})))),m.debug().log("listeners were set")}}t.ArcSightPlatform=f,f.normalizedValue=e=>"number"==typeof e?e:(0,a.isNumberInString)(e)?String(parseFloat(e)):`"${e.replace(/"/g,'\\"')}"`,f.id=r.PlatformID.ArcSight,f.extensionDefaultPosition={top:0,left:0,width:480,height:480},m=o(376).loggers.addPrefix(f.id)},65:(e,t,o)=>{t.c=void 0;const s=o(640),n=o(681),r=o(168),i=o(641),a=o(303),l=o(253),c=o(632),u=o(835),d=o(990);let g;class p extends d.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[n.BoundedResourceTypeID.Accounts]:["user.name","related.user","user.full_name","winlog.event_data.SubjectUserName","winlog.event_data.TargetUserName","winlog.user.name"],[n.BoundedResourceTypeID.Assets]:["host.hostname","host.name","winlog.computer_name"]},this.extensionDefaultPosition=p.extensionDefaultPosition}static buildQueryParts(e,t,o=!1){const s="include"===e?"AND":"AND NOT",n={};return Object.keys(t).forEach((e=>{t[e].length>1?n[e]=[`(${t[e].map((e=>p.normalizedValue(e))).join(" OR ")})`]:n[e]=t[e]})),(0,a.buildQueryParts)(n,(()=>":"),"exclude"===e?" AND NOT ":" OR ","exclude"===e?" AND NOT ":" AND ",{leftOperand:e=>e,rightOperand:e=>p.normalizedValue(e)},o?s:void 0)}getID(){return p.id}getName(){return r.PlatformName.Elastic}static setListeners(){c.addListener(s.ListenerType.OnMessage,(e=>{d.AbstractContentPlatform.processInlineListeners(e)})),g.debug().log("listeners were set")}static connectInlineListener(){(0,a.mountHTMLElement)("script",document.body,{attributes:{src:(0,u.getWebAccessibleUrl)(l.elasticInline),type:"text/javascript","data-type":"inline-listener"}}),g.debug().log("inline mounted")}connect(){p.setListeners(),p.connectInlineListener(),g.debug().log("connected")}buildQueryParts(e,t,o){return p.buildQueryParts(e,t,o)}}t.c=p,p.id=r.PlatformID.Elastic,p.extensionDefaultPosition={top:0,left:0,width:480,height:480},p.normalizedValue=e=>{let t=(0,i.isNumberInString)(e)?parseFloat(e):String(e).trim();return"number"==typeof t||"("===t[0]||")"===t[t.length-1]?t:`"${t.replace(/"/g,'\\"')}"`},g=o(376).loggers.addPrefix(p.id)},728:(e,t,o)=>{t.W=void 0;const s=o(640),n=o(168),r=o(632),i=o(303),a=o(253),l=o(681),c=o(641),u=o(835),d=o(990);let g;class p extends d.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[l.BoundedResourceTypeID.Accounts]:["AccountName","InitiatingProcessAccountName","RequestAccountName","InitiatingProcessAccountSid","RequestAccountName"],[l.BoundedResourceTypeID.Assets]:["DeviceName","AccountDomain","InitiatingProcessAccountDomain"]},this.extensionDefaultPosition=p.extensionDefaultPosition}static buildQueryParts(e,t,o=!1){return(0,i.buildQueryParts)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>p.normalizedValue(e)},o?"where":void 0)}buildQueryParts(e,t,o){return p.buildQueryParts(e,t,o)}getID(){return p.id}getName(){return n.PlatformName.MicrosoftDefender}static setListeners(){r.addListener(s.ListenerType.OnMessage,(e=>{d.AbstractContentPlatform.processInlineListeners(e)})),g.debug().log("listeners were set")}static connectInlineListener(){(0,i.mountHTMLElement)("script",document.body,{attributes:{src:(0,u.getWebAccessibleUrl)(a.microsoftDefenderInline),type:"text/javascript","data-type":"inline-listener"}})}connect(){p.setListeners(),p.connectInlineListener(),g.debug().log("connected")}}t.W=p,p.id=n.PlatformID.MicrosoftDefender,p.extensionDefaultPosition={top:0,left:0,width:480,height:480},p.normalizedValue=e=>{const t=(0,c.isNumberInString)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`},g=o(376).loggers.addPrefix(p.id)},555:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftSentinelPlatform=void 0;const n=o(168),r=o(640),i=o(632),a=o(303),l=o(80),c=o(253),u=o(641),d=o(681),g=o(835),p=o(990);let m;class f extends p.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[d.BoundedResourceTypeID.Accounts]:["UserName","Account","SubjectUserName","TargetUserName","UserDisplayName","UserPrincipalName","UPN","Identity","Name","FullName","NTDomain","UPNSuffix","Sid","AadUserId","DisplayName"],[d.BoundedResourceTypeID.Assets]:["Computer","DeviceName","HostName","FullDisplayName","ServicePrincipalName","DnsDomain","NetBiosName","OMSAgentID"]},this.extensionDefaultPosition=f.extensionDefaultPosition}static normalizedValue(e){const t=(0,u.isNumberInString)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}static buildQueryParts(e,t,o=!1){return(0,a.buildQueryParts)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>f.normalizedValue(e)},o?"where":void 0)}buildQueryParts(e,t,o){return f.buildQueryParts(e,t,o)}getID(){return f.id}getName(){return n.PlatformName.MicrosoftSentinel}static connectInlineListener(){(0,a.mountHTMLElement)("script",document.body,{attributes:{src:(0,g.getWebAccessibleUrl)(c.microsoftSentinelInline),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){i.addListener(r.ListenerType.OnMessage,(e=>s(this,void 0,void 0,(function*(){if(!l.contentPlatformIDFromENV&&!document.querySelector("la-main-view"))return;const t=`script[src$="${c.microsoftSentinelInline}"]`;document.querySelector(t)||(f.connectInlineListener(),yield(0,a.waitHTMLElement)(t)),p.AbstractContentPlatform.processInlineListeners(e)})))),m.debug().log("listeners were set")}connect(){f.setListeners(),m.debug().log("connected")}}t.MicrosoftSentinelPlatform=f,f.id=n.PlatformID.MicrosoftSentinel,f.extensionDefaultPosition={top:0,left:0,width:500,height:400},m=o(376).loggers.addPrefix(f.id)},573:(e,t,o)=>{t.U=void 0;const s=o(640),n=o(681),r=o(168),i=o(641),a=o(303),l=o(253),c=o(632),u=o(835),d=o(990);let g;class p extends d.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[n.BoundedResourceTypeID.Accounts]:["user.name","related.user","user.full_name","winlog.event_data.SubjectUserName","winlog.event_data.TargetUserName","winlog.user.name"],[n.BoundedResourceTypeID.Assets]:["host.hostname","host.name","winlog.computer_name"]},this.extensionDefaultPosition=p.extensionDefaultPosition}static buildQueryParts(e,t,o=!1){const s="include"===e?"AND":"AND NOT",n={};return Object.keys(t).forEach((e=>{t[e].length>1?n[e]=[`(${t[e].map((e=>p.normalizedValue(e))).join(" OR ")})`]:n[e]=t[e]})),(0,a.buildQueryParts)(n,(()=>":"),"exclude"===e?" AND NOT ":" OR ","exclude"===e?" AND NOT ":" AND ",{leftOperand:e=>e,rightOperand:e=>p.normalizedValue(e)},o?s:void 0)}getID(){return p.id}getName(){return r.PlatformName.OpenSearch}static setListeners(){c.addListener(s.ListenerType.OnMessage,(e=>{d.AbstractContentPlatform.processInlineListeners(e)})),g.debug().log("listeners were set")}static connectInlineListener(){(0,a.mountHTMLElement)("script",document.body,{attributes:{src:(0,u.getWebAccessibleUrl)(l.openSearchInline),type:"text/javascript","data-type":"inline-listener"}}),g.debug().log("inline mounted")}connect(){p.setListeners(),p.connectInlineListener(),g.debug().log("connected")}buildQueryParts(e,t,o){return p.buildQueryParts(e,t,o)}}t.U=p,p.id=r.PlatformID.OpenSearch,p.extensionDefaultPosition={top:0,left:0,width:480,height:480},p.normalizedValue=e=>{let t=(0,i.isNumberInString)(e)?parseFloat(e):String(e).trim();return"number"==typeof t||"("===t[0]||")"===t[t.length-1]?t:`"${t.replace(/"/g,'\\"')}"`},g=o(376).loggers.addPrefix(p.id)},682:(e,t,o)=>{t.k_=void 0;const s=o(168),n=o(80),r=o(641),i=o(629);t.k_=new class{constructor(){this.platforms=new i.Register}getPlatformByID(e){if(!this.platforms.has(e))switch(e){case s.PlatformID.Athena:this.platforms.set(e,new(o(930).AmazonAthenaPlatform));break;case s.PlatformID.MicrosoftSentinel:this.platforms.set(e,new(o(555).MicrosoftSentinelPlatform));break;case s.PlatformID.MicrosoftDefender:this.platforms.set(e,new(o(728).W));break;case s.PlatformID.Splunk:this.platforms.set(e,new(o(943).H));break;case s.PlatformID.QRadar:this.platforms.set(e,new(o(190).QRadarPlatform));break;case s.PlatformID.Elastic:this.platforms.set(e,new(o(65).c));break;case s.PlatformID.OpenSearch:this.platforms.set(e,new(o(573).U));break;case s.PlatformID.ArcSight:this.platforms.set(e,new(o(833).ArcSightPlatform));break;default:return}return this.platforms.get(e)}resolveByUrl(e){const{host:t,protocol:o,href:i}=new URL(e);if((0,r.isAllowedProtocol)(o,n.mode))return/(aws.amazon.com\/athena\/)/.test(i)?this.getPlatformByID(s.PlatformID.Athena):/(portal.azure.com|reactblade.portal.azure.net|logsextension.hosting.portal.azure.net)$/.test(t)?this.getPlatformByID(s.PlatformID.MicrosoftSentinel):/(security.microsoft.com\/)/.test(i)?this.getPlatformByID(s.PlatformID.MicrosoftDefender):/(console\/qradar\/jsp\/QRadar.jsp|console\/do\/ariel\/arielSearch)/.test(i)?this.getPlatformByID(s.PlatformID.QRadar):/(\/\w\w\w\/ui-phoenix\/com.arcsight.phoenix.PhoenixLauncher|logger\/search\.ftl)/.test(i)?this.getPlatformByID(s.PlatformID.ArcSight):void 0}resolveByContent(){return document.querySelector('a[aria-label^="splunk"]')?this.getPlatformByID(s.PlatformID.Splunk):document.querySelector('a.euiHeaderLogo[aria-label^="Elastic"]')||document.querySelector("#kibana-body")?this.getPlatformByID(s.PlatformID.Elastic):document.querySelector("#opensearch-dashboards-body")?this.getPlatformByID(s.PlatformID.OpenSearch):void 0}resolve(){return n.contentPlatformIDFromENV?this.getPlatformByID(n.contentPlatformIDFromENV):this.resolveByUrl(document.location.href)||this.resolveByContent()}}},190:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.QRadarPlatform=void 0;const n=o(640),r=o(168),i=o(681),a=o(303),l=o(641),c=o(632),u=o(253),d=o(835),g=o(990);let p;class m extends g.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[i.BoundedResourceTypeID.Accounts]:["Account Name","Recipients","Sender","Target Username","Username"],[i.BoundedResourceTypeID.Assets]:["Client Hostname","Destination Hostname","Destination IP","Hostname","Machine Identifier","Recipient Host","Sender Host","Source Hostname","Source Workstation","Source IP","Source Asset Name","Destination Asset Name"]},this.extensionDefaultPosition=m.extensionDefaultPosition}static normalizedValue(e){const t=(0,l.isNumberInString)(e)?parseFloat(e):e;return"number"==typeof t?t:`'${t.replace(/'/g,'"')}'`}buildQueryParts(e,t,o=!1){return(0,a.buildQueryParts)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>`"${e}"`,rightOperand:e=>m.normalizedValue(e)},o?"where":void 0)}connect(){m.setListeners(),p.debug().log("connected")}static setListeners(){c.addListener(n.ListenerType.OnMessage,(e=>s(this,void 0,void 0,(function*(){if(!document.querySelector("#aceEditor"))return;const t=`script[src$="${u.qRadarInline}"]`;document.querySelector(t)||(m.connectInlineListener(),yield(0,a.waitHTMLElement)(t)),g.AbstractContentPlatform.processInlineListeners(e)}))))}static connectInlineListener(){(0,a.mountHTMLElement)("script",document.body,{attributes:{src:(0,d.getWebAccessibleUrl)(u.qRadarInline),type:"text/javascript","data-type":"inline-listener"}})}getID(){return r.PlatformID.QRadar}getName(){return r.PlatformName.QRadar}}t.QRadarPlatform=m,m.extensionDefaultPosition={top:0,left:0,width:500,height:400},m.id=r.PlatformID.QRadar,p=o(376).loggers.addPrefix(m.id)},943:(e,t,o)=>{t.H=void 0;const s=o(640),n=o(168),r=o(632),i=o(303),a=o(253),l=o(681),c=o(641),u=o(959),d=o(835),g=o(990);let p;class m extends g.AbstractContentPlatform{constructor(){super(...arguments),this.defaultWatchers={[l.BoundedResourceTypeID.Accounts]:(0,u.deduplicateArray)(["src_user","src_user_bunit","user","Account_Name","User","src_user_name","user_name"]),[l.BoundedResourceTypeID.Assets]:(0,u.deduplicateArray)(["dest_host","dst","dest_nt_host","src_host","src_nt_host","src","dest","dest_name","dest_host","dvc","dvc_host","dest_dns","src_dns","ComputerName","DestinationHostname","SourceHostname"])},this.extensionDefaultPosition=m.extensionDefaultPosition}static normalizedValue(e){const t=(0,c.isNumberInString)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/"/g,'\\"')}"`}static buildQueryParts(e,t,o=!1){return(0,i.buildQueryParts)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>m.normalizedValue(e)},o?"where":void 0)}buildQueryParts(e,t,o){return m.buildQueryParts(e,t,o)}getID(){return m.id}getName(){return n.PlatformName.Splunk}static setListeners(){r.addListener(s.ListenerType.OnMessage,(e=>{g.AbstractContentPlatform.processInlineListeners(e)}))}static connectInlineListener(){(0,i.mountHTMLElement)("script",document.body,{attributes:{src:(0,d.getWebAccessibleUrl)(a.splunkInline),type:"text/javascript","data-type":"inline-listener"}})}connect(){m.setListeners(),m.connectInlineListener(),p.debug().log("connected")}}t.H=m,m.id=n.PlatformID.Splunk,m.extensionDefaultPosition={top:0,left:0,width:480,height:480},p=o(376).loggers.addPrefix(m.id)},632:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addListener=void 0;const s=o(640),n=o(673),r=o(696),i=o(835),a=o(519),l={};t.addListener=(e,t,...o)=>{var s;null===(s=l[e])||void 0===s||s.call(l,((...e)=>{t(...e)}),...o)};const c=[];l[s.ListenerType.OnMessage]=(e,...t)=>{if((0,r.isRuntimeOnMessageSupported)()){const o=(0,i.getBrowserContext)().runtime.onMessage;c.push((()=>{o.removeListener(e)})),o.addListener(((...t)=>{e(...t)}),...t)}if(!(0,r.isAddEventListenerSupported)())return;const o=o=>{const s=o.data;o.origin!==window.location.origin||"content"!==(0,a.getExecutingContextByMessageType)(s.type)&&s.externalType!==n.DebugID.debugIDExternal||e(o.data,...t)};c.push((()=>{window.removeEventListener("message",o)})),window.addEventListener("message",o)}},591:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageFromApp=t.sendMessageFromContent=t.sendMessage=void 0;const s=o(959),n=o(696),r=o(835),i=o(376).loggers.addPrefix("services");t.sendMessage=(e,t,o=!0)=>{var i;t.id=`${t.id?`${t.id}--`:""}${(0,s.uuid)()}`;const a="sendMessage";try{return o||(0,n.isPostMessageSupported)(t)?o?(0,n.isRuntimeSendMessageSupported)()?(null===(i=(0,r.getBrowserContext)().runtime.sendMessage(t))||void 0===i||i.catch((o=>e.error().addPrefix(a).log(o,t))),e.debug().addPrefix(a).log(t),t):t:(window.postMessage(t),e.debug().log("postMessage",t),t):t}catch(o){return e.error().addPrefix(a).log(o,t),t}},t.sendMessageFromContent=(e,o=!0)=>(0,t.sendMessage)(i.addPrefix("message-from-content"),e,o),t.sendMessageFromApp=(e,o=!0)=>(0,t.sendMessage)(i.addPrefix("message-from-app"),e,o)},640:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ListenerType=void 0,(t.ListenerType||(t.ListenerType={})).OnMessage="OnMessage"},53:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToContent=void 0;const s=o(519);var n;!function(e){e.CSModifyQuery="CSModifyQuery",e.CSSetQuery="CSSetQuery",e.CSGetQuery="CSGetQuery",e.CSSendMessageOutside="CSSendMessageOutside",e.CSConnectPlatform="CSConnectPlatform",e.CSSetDebugMode="CSSetDebugMode",e.CSDirectMessageToApp="CSDirectMessageToApp",e.CSDirectMessageToInline="CSDirectMessageToInline"}(n=t.MessageToContent||(t.MessageToContent={})),Object.values(n).forEach((e=>{if("content"!==(0,s.getExecutingContextByMessageType)(e))throw new Error(`Wrong content message type "${e}"`)}))},118:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToInline=void 0;const s=o(519);var n;!function(e){e.ISModifyQuery="ISModifyQuery",e.ISSetQuery="ISSetQuery",e.ISGetQuery="ISGetQuery",e.ISSetDebugMode="ISSetDebugMode",e.ISRemoveHash="ISRemoveHash",e.ISRemoveFieldSpecification="ISRemoveFieldSpecification"}(n=t.MessageToInline||(t.MessageToInline={})),Object.values(n).forEach((e=>{if("inline"!==(0,s.getExecutingContextByMessageType)(e))throw new Error(`Wrong inline message type "${e}"`)}))},253:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accessibleResources=t.openSearchInline=t.arcSightInline=t.elasticInline=t.qRadarInline=t.splunkInline=t.amazonAthenaInline=t.microsoftDefenderInline=t.microsoftSentinelInline=t.appStyles=void 0;const s=o(168);t.appStyles="app-styles.css",t.microsoftSentinelInline="inline-microsoft-sentinel.js",t.microsoftDefenderInline="inline-microsoft-defender.js",t.amazonAthenaInline="inline-amazon-athena.js",t.splunkInline="inline-splunk.js",t.qRadarInline="inline-qradar.js",t.elasticInline="inline-elastic.js",t.arcSightInline="inline-arcsight.js",t.openSearchInline="inline-opensearch.js",t.accessibleResources={[s.PlatformID.MicrosoftSentinel]:[t.microsoftSentinelInline],[s.PlatformID.MicrosoftDefender]:[t.microsoftDefenderInline],[s.PlatformID.Splunk]:[t.splunkInline],[s.PlatformID.QRadar]:[t.qRadarInline],[s.PlatformID.Elastic]:[t.elasticInline],[s.PlatformID.ArcSight]:[t.arcSightInline],[s.PlatformID.Athena]:[t.amazonAthenaInline],[s.PlatformID.OpenSearch]:[t.openSearchInline],app:[t.appStyles]}},159:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getResourcesTabByTitle=t.getDeleteResourceTabButton=t.getApplyAddNewFieldButton=t.addNewFieldInput=t.getAddNewFieldButton=t.getApplyButtonInActiveResourceTab=t.getInputInActiveResourceTab=t.getActiveResourcesTab=t.getResourcesTabsPanel=t.getAddNewResourceTabButton=t.getShowAllButton=t.getExcludeButton=t.getIncludeButton=t.getResourceListItem=t.getResourceCollapsibleRemoveButton=t.getResourceCollapsibleHeader=t.getResourceCollapsibleByHeaderText=t.getPlatformResources=t.getShowAllBulkResourceButton=t.getExcludeBulkResourceButton=t.getIncludeBulkResourceButton=t.getBulkResourcesPanel=t.getExtensionRoot=t.addNewTestResources=t.getTestData=t.setWatchers=t.getWatchers=t.showExtension=void 0;const n=o(138),r=o(879),i=o(519),a=o(619),l=o(959),c=(e,t)=>{const o=window;o.scenarioFunctions||(o.scenarioFunctions={}),o.scenarioFunctions[e]=t};t.showExtension=()=>{c("showExtension",t.showExtension),window.postMessage({type:n.MessageToApp.AppShowExtension,externalType:i.debugID})},t.getWatchers=()=>(c("getWatchers",t.getWatchers),JSON.parse(localStorage.getItem(a.watchersLocalStorageKey)||"{}")),t.setWatchers=e=>{localStorage.setItem(a.watchersLocalStorageKey,JSON.stringify(e))},t.getTestData=()=>(c("getTestData",t.getTestData),{Accounts:{test0:["account1","2","test\\domain.com","4",'"process.exe" -a -g https://some.site/some-page'],test2:["account2","2","4"],test3:["account3","test2","4"],test4:["account4","2","test2","4"],field:["2"]}}),t.addNewTestResources=()=>s(void 0,void 0,void 0,(function*(){c("addNewTestResources",t.addNewTestResources),window.postMessage({type:n.MessageToApp.AppTakeNewResourceData,externalType:i.debugID,payload:{resources:(0,t.getTestData)(),cacheID:"test-cache-id"}}),yield(0,l.sleep)(1)}));const u=(e,t)=>{c("addElementToWindow",u);const o=window;return o.scenariosElements||(o.scenariosElements={}),o.scenariosElements[e]=t,t};t.getExtensionRoot=(e=!0)=>{var o;c("getExtensionRoot",t.getExtensionRoot);const s=null===(o=document.querySelector('div[style^="all:initial;"]'))||void 0===o?void 0:o.shadowRoot;if(!s&&e)throw new Error((0,r.logErrorMessage)("No root"));return u("root",s)},t.getBulkResourcesPanel=(e=!0)=>{c("getBulkResourcesPanel",t.getBulkResourcesPanel);const o=(0,t.getExtensionRoot)(e).querySelector(".bulk-resources-panel");if(!o&&e)throw new Error((0,r.logErrorMessage)("No bulk resource panel"));return u("bulkResourcePanel",o)},t.getIncludeBulkResourceButton=(e=!0)=>{var o;c("getIncludeBulkResourceButton",t.getIncludeBulkResourceButton);const s=null===(o=(0,t.getBulkResourcesPanel)(e).querySelector(".plus-icon"))||void 0===o?void 0:o.closest("button");if(!s&&e)throw new Error((0,r.logErrorMessage)("No include bulk resource button"));return u("includeBulkResourceButton",s)},t.getExcludeBulkResourceButton=(e=!0)=>{var o;c("getExcludeBulkResourceButton",t.getExcludeBulkResourceButton);const s=null===(o=(0,t.getBulkResourcesPanel)(e).querySelector(".minus-icon"))||void 0===o?void 0:o.closest("button");if(!s&&e)throw new Error((0,r.logErrorMessage)("No exclude bulk resource button"));return u("excludeBulkResourceButton",s)},t.getShowAllBulkResourceButton=(e=!0)=>{var o;c("getShowAllBulkResourceButton",t.getShowAllBulkResourceButton);const s=null===(o=(0,t.getBulkResourcesPanel)(e).querySelector(".see-document-icon"))||void 0===o?void 0:o.closest("button");if(!s&&e)throw new Error((0,r.logErrorMessage)("No show all bulk resource button"));return u("showAllBulkResourceButton",s)},t.getPlatformResources=(e=!0)=>{c("getPlatformResources",t.getPlatformResources);const o=(0,t.getExtensionRoot)(e).querySelector(".platform-resources");if(!o&&e)throw new Error((0,r.logErrorMessage)("No platform resources"));return u("platformResources",o)},t.getResourceCollapsibleByHeaderText=(e,o=!0)=>{var s;c("getResourceCollapsibleByHeaderText",t.getResourceCollapsibleByHeaderText);const n=(0,t.getPlatformResources)(o),i=null===(s=Array.from(n.querySelectorAll(".collapsible-header .resource-field-name .field-name")||[]).find((t=>t.innerText===e)))||void 0===s?void 0:s.closest(".collapsible");if(!i&&o)throw new Error((0,r.logErrorMessage)(`No collapsible resource queried by text >${e}<`));return u("resourcesCollapsible",i)},t.getResourceCollapsibleHeader=(e,o=!0)=>{c("getResourceCollapsibleHeader",t.getResourceCollapsibleHeader);const s=e.querySelector(".collapsible-header");if(!s&&o)throw new Error((0,r.logErrorMessage)("No collapsible resource header"));return u("resourceCollapsibleHeader",s)},t.getResourceCollapsibleRemoveButton=(e,o=!0)=>{c("getResourceCollapsibleRemoveButton",t.getResourceCollapsibleRemoveButton);const s=e.querySelector(".waste-basket-icon");if(!s&&o)throw new Error((0,r.logErrorMessage)("No resource collapsible remove button"));return u("resourceCollapsibleRemoveButton",s)},t.getResourceListItem=(e,o=!0)=>{c("getResourceListItem",t.getResourceListItem);const s=e.querySelector(".resource-list-item");if(!s&&o)throw new Error((0,r.logErrorMessage)("No resource list item"));return u("resourceListItem",s)},t.getIncludeButton=(e,o=!0)=>{c("getIncludeButton",t.getIncludeButton);const s=e.querySelector(".plus-icon");if(!s&&o)throw new Error((0,r.logErrorMessage)(`No include button in ${e.outerHTML}`));return u("includeButton",s)},t.getExcludeButton=(e,o=!0)=>{c("getExcludeButton",t.getExcludeButton);const s=e.querySelector(".minus-icon");if(!s&&o)throw new Error((0,r.logErrorMessage)(`No exclude button in ${e.outerHTML}`));return u("excludeButton",s)},t.getShowAllButton=(e,o=!0)=>{c("getShowAllButton",t.getShowAllButton);const s=e.querySelector(".see-document-icon");if(!s&&o)throw new Error((0,r.logErrorMessage)(`No show all button in ${e.outerHTML}`));return u("showAllButton",s)},t.getAddNewResourceTabButton=(e=!0)=>{c("getAddNewResourceTabButton",t.getAddNewResourceTabButton);const o=(0,t.getExtensionRoot)(e).querySelector(".add-new-tab-button");if(!o&&e)throw new Error((0,r.logErrorMessage)("No add new tab button"));return u("addNewResourceTabButton",o)},t.getResourcesTabsPanel=(e=!0)=>{c("getResourcesTabsPanel",t.getResourcesTabsPanel);const o=(0,t.getExtensionRoot)(e).querySelector(".tabs-platform-resources");if(!o&&e)throw new Error((0,r.logErrorMessage)("No resources tabs panel"));return u("resourcesTabsPanel",o)},t.getActiveResourcesTab=(e=!0)=>{c("getActiveResourcesTab",t.getActiveResourcesTab);const o=(0,t.getResourcesTabsPanel)(e).querySelector(".tab.active");if(!o&&e)throw new Error((0,r.logErrorMessage)("No active resources tab"));return u("activeResourcesTab",o)},t.getInputInActiveResourceTab=(e=!0)=>{c("getInputInActiveResourceTab",t.getInputInActiveResourceTab);const o=(0,t.getActiveResourcesTab)(e).querySelector("input");if(!o&&e)throw new Error((0,r.logErrorMessage)("No input active resources tab"));return u("inputActiveResourcesTab",o)},t.getApplyButtonInActiveResourceTab=(e=!0)=>{c("getApplyButtonInActiveResourceTab",t.getApplyButtonInActiveResourceTab);const o=(0,t.getActiveResourcesTab)(e).querySelector(".check-icon");if(!o&&e)throw new Error((0,r.logErrorMessage)("No apply button in active resource tab"));return u("applyButtonInActiveResourceTab",o)},t.getAddNewFieldButton=(e=!0)=>{c("getAddNewFieldButton",t.getAddNewFieldButton);const o=(0,t.getExtensionRoot)(e),s=null==o?void 0:o.querySelector(".add-new-field");if(!s&&e)throw new Error((0,r.logErrorMessage)("No add new field button"));return u("addNewFieldButton",s)},t.addNewFieldInput=(e=!0)=>{c("addNewFieldInput",t.addNewFieldInput);const o=(0,t.getExtensionRoot)(e),s=null==o?void 0:o.querySelector(".add-field-input-wrapper input");if(!s&&e)throw new Error((0,r.logErrorMessage)("No add new field input"));return u("newFieldInput",s)},t.getApplyAddNewFieldButton=(e=!0)=>{c("getApplyAddNewFieldButton",t.getApplyAddNewFieldButton);const o=(0,t.getExtensionRoot)(e),s=null==o?void 0:o.querySelector(".add-field-input-wrapper .check-icon");if(!s&&e)throw new Error((0,r.logErrorMessage)("No apply add new field button"));return u("addNewFieldButton",s)},t.getDeleteResourceTabButton=(e=!0)=>{c("getDeleteResourceTabButton",t.getDeleteResourceTabButton);const o=(0,t.getResourcesTabsPanel)(e),s=null==o?void 0:o.querySelector(".waste-basket-icon");if(!s&&e)throw new Error((0,r.logErrorMessage)("No delete resource tab button"));return u("deleteResourceTabButton",s)},t.getResourcesTabByTitle=(e,o=!0)=>{var s;c("getResourcesTabByTitle",t.getResourcesTabByTitle);const n=(0,t.getExtensionRoot)(o),i=null===(s=Array.from((null==n?void 0:n.querySelectorAll(".virtual-input"))||[]).find((t=>t.innerText===e)))||void 0===s?void 0:s.closest(".tab");if(!i&&o)throw new Error((0,r.logErrorMessage)(`No resource tab queried by title: >${e}<`));return u("resourceTab",i)}},879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.testCase=t.logErrorMessage=t.logSuccessMessage=t.getMessagePrefix=void 0,t.getMessagePrefix=()=>"#",t.logSuccessMessage=e=>(console.warn(`[SUCCESS]: ${(0,t.getMessagePrefix)()}${e}`),e),t.logErrorMessage=e=>(console.error(`[ERROR]: ${(0,t.getMessagePrefix)()}${e}`),e),t.testCase=(e,o=!0)=>({expect:s=>({toEqual:n=>{if(console.log(`[toEqual]: ${e}\r\npassed value:\r\n>${String(s)}<`),n!==s)throw(0,t.logErrorMessage)(e),new Error((0,t.logErrorMessage)(`\r\n>${String(s)}<\r\n<NOT EQUAL>\r\n>${String(n)}<`));o&&(0,t.logSuccessMessage)(e)}})})},43:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.startTests=t.suiteGlobals=void 0;const n=o(959),r=o(879),i=o(159),a=o(496);t.suiteGlobals={getValue:()=>Promise.resolve("not set"),clearValue:()=>Promise.resolve(),messages:{testIncludeAction:"",test2ExcludeBulkAction:"",test2IncludeBulkAction:"",test2ShowAllBulkAction:"",testExcludeAction:"",testExcludeBulkAction:"",testIncludeBulkAction:"",testShowAllAction:"",testShowAllBulkAction:""}},t.startTests=()=>s(void 0,void 0,void 0,(function*(){(0,i.showExtension)(),yield(0,n.sleep)(.3),yield(0,i.addNewTestResources)(),yield(0,n.sleep)(.3);const e=(0,i.getResourceCollapsibleHeader)((0,i.getResourceCollapsibleByHeaderText)("test0"));e.click(),yield(0,n.sleep)(.3),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue(),yield(0,n.sleep)(.1);const e=(0,i.getResourceListItem)((0,i.getResourceCollapsibleByHeaderText)("test0"));(0,a.hoverOnElement)(e),yield(0,n.sleep)(.3);const o=(0,i.getIncludeButton)(e);yield(0,n.sleep)(.1),(0,a.clickOnElement)(o),yield(0,n.sleep)(.3);const s=yield t.suiteGlobals.getValue();(0,r.testCase)("Include resource action test").expect(s.trim()).toEqual(t.suiteGlobals.messages.testIncludeAction)})),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue(),yield(0,n.sleep)(.1);const e=(0,i.getResourceListItem)((0,i.getResourceCollapsibleByHeaderText)("test0"));(0,a.hoverOnElement)(e),yield(0,n.sleep)(.3);const o=(0,i.getExcludeButton)(e);yield(0,n.sleep)(.1),(0,a.clickOnElement)(o),yield(0,n.sleep)(.3);const s=yield t.suiteGlobals.getValue();(0,r.testCase)("Exclude resource action test").expect(s.trim()).toEqual(t.suiteGlobals.messages.testExcludeAction)})),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue(),yield(0,n.sleep)(.1);const e=(0,i.getResourceListItem)((0,i.getResourceCollapsibleByHeaderText)("test0"));(0,a.hoverOnElement)(e),yield(0,n.sleep)(.3);const o=(0,i.getShowAllButton)(e);yield(0,n.sleep)(.1),(0,a.clickOnElement)(o),yield(0,n.sleep)(.3);const s=yield t.suiteGlobals.getValue();(0,r.testCase)("Show all resource action test").expect(s.trim()).toEqual(t.suiteGlobals.messages.testShowAllAction)}));let o=e.querySelector(".checker-wrapper");(0,r.testCase)("headerCheckbox availability test",!1).expect(!!o).toEqual(!0),o.click(),yield(0,n.sleep)(.1),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue();const e=(0,i.getIncludeBulkResourceButton)();yield(0,n.sleep)(.1),e.click(),yield(0,n.sleep)(.3);const o=yield t.suiteGlobals.getValue();(0,r.testCase)("Bulk include resource action test").expect(o.trim()).toEqual(t.suiteGlobals.messages.testIncludeBulkAction)})),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue();const e=(0,i.getExcludeBulkResourceButton)();yield(0,n.sleep)(.1),e.click(),yield(0,n.sleep)(.3);const o=yield t.suiteGlobals.getValue();(0,r.testCase)("Bulk exclude resource action test").expect(o.trim()).toEqual(t.suiteGlobals.messages.testExcludeBulkAction)})),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue();const e=(0,i.getShowAllBulkResourceButton)();yield(0,n.sleep)(.1),e.click(),yield(0,n.sleep)(.3);const o=yield t.suiteGlobals.getValue();(0,r.testCase)("Bulk show all resource action test").expect(o.trim()).toEqual(t.suiteGlobals.messages.testShowAllBulkAction)}));const l=(0,i.getResourceCollapsibleHeader)((0,i.getResourceCollapsibleByHeaderText)("test2"));l.click(),yield(0,n.sleep)(.1),o=l.querySelector(".checker-wrapper"),(0,r.testCase)("headerCheckbox2 availability test",!1).expect(!!o).toEqual(!0),o.click(),yield(0,n.sleep)(.1),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue();const e=(0,i.getIncludeBulkResourceButton)();yield(0,n.sleep)(.1),e.click(),yield(0,n.sleep)(.3);const o=yield t.suiteGlobals.getValue();(0,r.testCase)("Bulk include resource action test2").expect(o.trim()).toEqual(t.suiteGlobals.messages.test2IncludeBulkAction)})),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue();const e=(0,i.getExcludeBulkResourceButton)();yield(0,n.sleep)(.1),e.click(),yield(0,n.sleep)(.3);const o=yield t.suiteGlobals.getValue();(0,r.testCase)("Bulk exclude resource action test2").expect(o.trim()).toEqual(t.suiteGlobals.messages.test2ExcludeBulkAction)})),yield s(void 0,void 0,void 0,(function*(){yield t.suiteGlobals.clearValue();const e=(0,i.getShowAllBulkResourceButton)();yield(0,n.sleep)(.1),e.click(),yield(0,n.sleep)(.3);const o=yield t.suiteGlobals.getValue();(0,r.testCase)("Bulk show all resource action test2").expect(o.trim()).toEqual(t.suiteGlobals.messages.test2ShowAllBulkAction)})),yield s(void 0,void 0,void 0,(function*(){let e=(0,i.getWatchers)();void 0!==e["custom-test"]&&delete e["custom-test"],(0,i.setWatchers)(e),(0,i.getAddNewResourceTabButton)().click(),yield(0,n.sleep)(.3);const t=(0,i.getInputInActiveResourceTab)();t.value="custom-test",t.dispatchEvent(new Event("change",{bubbles:!0})),(0,a.clickOnElement)((0,i.getApplyButtonInActiveResourceTab)()),(0,i.getAddNewFieldButton)().click(),yield(0,n.sleep)(.3);const o=(0,i.addNewFieldInput)();o.value="test-resource-name",o.dispatchEvent(new Event("change",{bubbles:!0}));const s=(0,i.getApplyAddNewFieldButton)();(0,a.clickOnElement)(s),(0,r.testCase)("no custom watcher",!1).expect(void 0===e["custom-test"]).toEqual(!0),e=(0,i.getWatchers)(),(0,r.testCase)("Set watchers").expect(void 0!==e["custom-test"]&&'["test-resource-name"]'===JSON.stringify(e["custom-test"])).toEqual(!0),(0,i.getResourcesTabByTitle)("custom-test").click(),yield(0,n.sleep)(.3),(0,a.dblClickOnElement)((0,i.getInputInActiveResourceTab)()),yield(0,n.sleep)(.3),e=(0,i.getWatchers)(),(0,r.testCase)("exist custom watcher",!1).expect(void 0!==e["custom-test"]).toEqual(!0),(0,a.clickOnElement)((0,i.getDeleteResourceTabButton)()),e=(0,i.getWatchers)(),(0,r.testCase)("no custom watcher 2",!1).expect(void 0===e["custom-test"]).toEqual(!0),(0,i.setWatchers)(e),yield(0,n.sleep)(.3)})),yield s(void 0,void 0,void 0,(function*(){var e,t;const o=(0,i.getTestData)(),s=new Map;Object.keys(o).forEach((e=>{Object.keys(o[e]).forEach((t=>{const o=s.get(e)||new Set;o.add(t),s.set(e,o)}))}));for(let o of Array.from(s)){const[s,l]=o;for(let o of Array.from(l)){const l=(0,i.getResourceCollapsibleRemoveButton)((0,i.getResourceCollapsibleByHeaderText)(o));let c=(0,i.getWatchers)();(0,r.testCase)(`exists fieldName >${o}< in type >${s}<`,!1).expect(null===(e=c[s])||void 0===e?void 0:e.includes(o)).toEqual(!0),(0,a.clickOnElement)(l),yield(0,n.sleep)(.3),c=(0,i.getWatchers)(),(0,r.testCase)(`not exists fieldName >${o}< in type >${s}<`,!1).expect(null===(t=c[s])||void 0===t?void 0:t.includes(o)).toEqual(!1)}}(0,r.logSuccessMessage)("Remove resources fields")}))}))},281:function(e,t,o){var s=this&&this.__awaiter||function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function i(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}l((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=o(43),r=o(138),i=o(519),a=o(743),l=o(959),c=o(879);n.suiteGlobals.messages={testIncludeAction:'TestTable | where test0 == "account1"',testExcludeAction:'TestTable | where test0 != "account1"',testShowAllAction:'TestTable | where test0 == "account1"',testIncludeBulkAction:'TestTable | where test0 == "account1" or test0 == 2 or test0 == "test\\\\domain.com" or test0 == 4 or test0 == "\\"process.exe\\" -a -g https://some.site/some-page"',test2IncludeBulkAction:'TestTable | where test0 == "account1" or test0 == 2 or test0 == "test\\\\domain.com" or test0 == 4 or test0 == "\\"process.exe\\" -a -g https://some.site/some-page" or test2 == "account2" or test2 == 2 or test2 == 4',testExcludeBulkAction:'TestTable | where test0 != "account1" and test0 != 2 and test0 != "test\\\\domain.com" and test0 != 4 and test0 != "\\"process.exe\\" -a -g https://some.site/some-page"',test2ExcludeBulkAction:'TestTable | where test0 != "account1" and test0 != 2 and test0 != "test\\\\domain.com" and test0 != 4 and test0 != "\\"process.exe\\" -a -g https://some.site/some-page" and test2 != "account2" and test2 != 2 and test2 != 4',testShowAllBulkAction:'TestTable | where test0 == "account1" or test0 == 2 or test0 == "test\\\\domain.com" or test0 == 4 or test0 == "\\"process.exe\\" -a -g https://some.site/some-page"',test2ShowAllBulkAction:'TestTable | where test0 == "account1" or test0 == 2 or test0 == "test\\\\domain.com" or test0 == 4 or test0 == "\\"process.exe\\" -a -g https://some.site/some-page" or test2 == "account2" or test2 == 2 or test2 == 4'},n.suiteGlobals.clearValue=()=>s(void 0,void 0,void 0,(function*(){window.postMessage({type:r.MessageToApp.AppSendToBackground,externalType:i.debugID,payload:{type:a.MessageToBackground.BGSetQuery,payload:{value:"TestTable"}}}),yield(0,l.sleep)(.3)}));const u=[];n.suiteGlobals.getValue=()=>s(void 0,void 0,void 0,(function*(){window.postMessage({type:r.MessageToApp.AppSendToBackground,externalType:i.debugID,payload:{type:a.MessageToBackground.BGGetQuery}}),yield(0,l.sleep)(.3);const e=u.pop();if(!e)return"";const{queryValue:t}=e.payload;return t})),s(void 0,void 0,void 0,(function*(){yield n.suiteGlobals.getValue(),yield(0,l.sleep)(.5),window.addEventListener("message",(e=>{const t=e.data;"MessageOutside"===t.type&&u.push(t)})),yield(0,n.startTests)(),(0,c.logSuccessMessage)("ALL TESTS PASSED!")}))},496:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hoverOnElement=t.dblClickOnElement=t.clickOnElement=void 0;const o=e=>(t,o,s)=>{const n=t.getBoundingClientRect(),r=new MouseEvent(e,{view:window,bubbles:!0,cancelable:!0,clientX:n.left+o,clientY:n.top+s});t.dispatchEvent(r)},s=e=>{const{x:t,y:o}=e.getBoundingClientRect();return{x:t,y:o}};t.clickOnElement=e=>{const{x:t,y:n}=s(e);o("click")(e,t,n)},t.dblClickOnElement=e=>{const{x:t,y:n}=s(e);o("dblclick")(e,t,n)},t.hoverOnElement=e=>{const{x:t,y:n}=s(e);o("mousemove")(e,t,n),o("mouseover")(e,t,n)}}},t={};!function o(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,o),r.exports}(281)})();