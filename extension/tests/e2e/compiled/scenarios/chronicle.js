(()=>{"use strict";var e={138:(e,t,s)=>{s.d(t,{J_:()=>i,bT:()=>a,iV:()=>o});var n=s(981),r=s(869);const a=e=>{if("number"==typeof e)return!0;if("string"!=typeof e)return!1;const t=e.trim();return!(!/^[-.0-9]*$/.test(t)||(0,r.cK)(t,".").length>1||Number.isNaN(parseFloat(t)))},o=(e,t)=>{if(t===n.AR.development)return!0;const s=e.trim().toLowerCase();return"https:"===s||"https"===s},i=e=>new Date("string"==typeof e&&a(e)?parseInt(e,10):e).getTime()>5679828e5},869:(e,t,s)=>{s.d(t,{Vj:()=>n,ZJ:()=>r,_v:()=>o,cK:()=>a}),s(138);const n=()=>Math.random().toString(36).substring(5)+Date.now().toString(36)+Math.random().toString(36).substring(5),r=e=>[...Array.from(new Set([...e]))],a=(e,t)=>{const s=[];let n=-1;for(;(n=e.indexOf(t,n+1))>=0;)s.push(n);return s},o=async e=>new Promise((t=>{setTimeout((()=>{t(null)}),1e3*e)}))},981:(e,t,s)=>{var n,r;s.d(t,{AR:()=>n,in:()=>r,mr:()=>a}),function(e){e.production="production",e.development="development"}(n||(n={})),function(e){e.info="info",e.debug="debug",e.error="error",e.warn="warn"}(r||(r={}));const a=e=>e},467:(e,t,s)=>{var n;s.d(t,{nB:()=>n}),function(e){e.Accounts="Accounts",e.Assets="Assets"}(n||(n={})),Object.keys(n)},822:(e,t,s)=>{s.d(t,{P:()=>n});var n,r=s(923);!function(e){e.BGDirectMessageToApp="BGDirectMessageToApp",e.BGDirectMessageToInline="BGDirectMessageToInline",e.BGSetWatchers="BGSetWatchers",e.BGRegisterPlatformTab="BGRegisterPlatformTab",e.BGToggleShowExtension="BGToggleShowExtension",e.BGSetDebugMode="BGSetDebugMode",e.BGSendCallbackMessage="BGSendCallbackMessage",e.BGIntegrationWork="BGIntegrationWork"}(n||(n={})),Object.values(n).forEach((e=>{if("background"!==(0,r.k$)(e))throw new Error(`Wrong background message type "${e}"`)}))},5:(e,t,s)=>{s.d(t,{Gc:()=>a,PW:()=>c,TC:()=>i,iq:()=>l,sp:()=>o});var n=s(341);const r=s(943).Et.addPrefix("api-support"),a=(...e)=>!!window?.postMessage||(r.warn().log("API window.postMessage is not supported",...e),!1),o=(...e)=>!!window?.addEventListener||(r.warn().log("API window.addEventListener is not supported",...e),!1),i=(...e)=>!!(0,n.B)()?.runtime?.sendMessage||(r.warn().log("API runtime.sendMessage is not supported",...e),!1),c=(...e)=>!!(0,n.B)().runtime?.onMessage?.addListener||(r.warn().log("API runtime.onMessage.addListener is not supported",...e),!1),l=(...e)=>!!(0,n.B)()?.runtime?.getURL||(r.warn().log("API runtime.getURL is not supported",...e),!1)},341:(e,t,s)=>{s.d(t,{B:()=>r,t:()=>a});var n=s(5);const r=()=>"undefined"!=typeof browser?browser:chrome,a=e=>(0,n.iq)(e)?r().runtime.getURL(e):""},877:(e,t,s)=>{s.d(t,{AX:()=>a,B7:()=>r,xJ:()=>n}),s(977);const n=(e,t,s)=>{const n=document.createElement(e);return s?.attributes&&Object.keys(s.attributes).forEach((e=>{var t;n.setAttribute(e,"style"===e?(t=s.attributes[e],Object.keys(t).reduce(((e,s)=>e+`${s}:${t[s]};`),"")):s.attributes?.[e]||"")})),s?.innerHtml&&(n.innerHTML=s.innerHtml),s?.innerText&&(n.innerText=s.innerText),t&&t.append(n),n},r=async(e,t=document)=>new Promise((s=>{new MutationObserver(((n,r)=>{const a=t.querySelector(e);a&&(r.disconnect(),s(a))})).observe(t,{childList:!0,subtree:!0})})),a=(e,t,s,n,r,a)=>{const o=[];Object.keys(e).forEach((n=>{o.push(e[n].map((e=>`${r.leftOperand(n)}${t(n,e)}${r.rightOperand(e)}`)).join(s))}));const i=o.join(n);return a?`${a} ${i}`:i}},441:(e,t,s)=>{s.d(t,{hw:()=>i,kF:()=>a,xJ:()=>o});var n=s(977),r=s(981);const a=Object.values(n.WM).includes(process.env.CONTENT_PLATFORM)?process.env.CONTENT_PLATFORM:null,o=(Object.values(n.WM).includes(process.env.BACKGROUND_PLATFORM)&&process.env.BACKGROUND_PLATFORM,process.env.MODE===r.AR.production?r.AR.production:r.AR.development),i=Object.keys(r.in).includes(process.env.LOG_LEVEL)?process.env.LOG_LEVEL:r.in.info;process.env.VERSION},943:(e,t,s)=>{s.d(t,{Et:()=>a,yD:()=>i});var n=s(981),r=s(441);let a,o=r.xJ===n.AR.development||r.hw===n.in.debug;const i=e=>{o=e};class c{prefix="";level=n.in.info;createInstance(e="",t=n.in.info){return new c(e,t)}constructor(e="",t=n.in.info){this.prefix=e,this.level=t}log(...e){(this.level!==n.in.debug||o)&&console[this.level===n.in.error?"error":this.level===n.in.warn?"warn":"log"](this.prefix||"==>",...e)}error(){return this.createInstance(`ERROR: ${this.prefix}`,n.in.error)}warn(){return this.createInstance(`WARN: ${this.prefix}`,n.in.warn)}info(){return this.createInstance(`INFO: ${this.prefix}`,n.in.info)}debug(){return this.createInstance(`DEBUG: ${this.prefix}`,n.in.debug)}addPrefix(e){return this.createInstance([this.prefix,e].join(" "),this.level)}setLevel(e){return this.createInstance(this.prefix,e)}setPrefix(e){return a=this.addPrefix(e),a}}a=new c},923:(e,t,s)=>{s.d(t,{k$:()=>n,qK:()=>r});const n=e=>{let t=(e||"").slice(0,3).toLowerCase();return"app"===t?"app":(t=t.slice(0,2),"bg"===t?"background":"cs"===t?"content":"is"===t?"inline":"unknown")},r="debug-external-der3edc3op3e4dde44rt"},977:(e,t,s)=>{var n,r,a,o,i;s.d(t,{WM:()=>r,if:()=>i}),function(e){e.chrome="chrome",e.firefox="firefox",e.edge="edge"}(n||(n={})),function(e){e.MicrosoftSentinel="MicrosoftSentinel",e.MicrosoftDefender="MicrosoftDefender",e.Splunk="Splunk",e.QRadar="QRadar",e.Elastic="Elastic",e.OpenSearch="OpenSearch",e.ArcSight="ArcSight",e.Athena="Athena",e.LogScale="LogScale",e.Chronicle="Chronicle"}(r||(r={})),function(e){e.ElasticEQl="ElasticEql"}(a||(a={})),function(e){e.Sentinel="ala",e.Defender="mdatp",e.Splunk="splunk",e.Qradar="qradar",e.ElasticEQL="es-eql",e.ElasticLucene="elasticsearch",e.ArcSight="arcsight-keyword",e.Athena="athena",e.LogScale="humio",e.Chronicle="chronicle-query",e.OpenSearch="opendistro-query"}(o||(o={})),function(e){e.MicrosoftSentinel="Microsoft Sentinel",e.MicrosoftDefender="Microsoft Defender For Endpoint",e.Splunk="Splunk",e.QRadar="IBM QRadar",e.Elastic="Elastic",e.OpenSearch="OpenSearch",e.ArcSight="ArcSight",e.Athena="Amazon Athena",e.LogScale="Falcon LogScale",e.Chronicle="Chronicle"}(i||(i={}))},925:(e,t,s)=>{s.d(t,{G:()=>g});var n=s(943);const r=(e,t,...s)=>!!e()&&(n.Et.debug().log(`got ${t.type} message`,t,...s),!0);var a,o=s(923);!function(e){e.CSConnectPlatform="CSConnectPlatform",e.CSSetDebugMode="CSSetDebugMode",e.CSDirectMessageToApp="CSDirectMessageToApp",e.CSDirectMessageToInline="CSDirectMessageToInline"}(a||(a={})),Object.values(a).forEach((e=>{if("content"!==(0,o.k$)(e))throw new Error(`Wrong content message type "${e}"`)}));var i=s(869),c=s(5),l=s(341);const u=s(943).Et.addPrefix("services"),d=(e,t=!0)=>((e,t,s=!0)=>{t.id=`${t.id?`${t.id}--`:""}${(0,i.Vj)()}`;const n="sendMessage";try{return s||(0,c.Gc)(t)?s?(0,c.TC)()?((0,l.B)().runtime.sendMessage(t)?.catch((s=>e.error().addPrefix(n).log(s,t))),e.debug().addPrefix(n).log(t),t):t:(window.postMessage(t),e.debug().log("postMessage",t),t):t}catch(s){return e.error().addPrefix(n).log(s,t),t}})(u.addPrefix("message-from-content"),e,t);var p=s(246),h=s(822);class g{fields=new Set;static processInlineListeners(e){if(r((()=>a.CSSetDebugMode===e.type),e)){const{debugMode:t}=e.payload;s(943).yD(t),d({...e,id:`${e.id}--${e.type}`,type:p.$.ISSetDebugMode},!1)}if(r((()=>a.CSDirectMessageToApp===e.type),e)&&d({id:`${e.id}--${e.type}`,type:h.P.BGDirectMessageToApp,payload:e.payload}),r((()=>a.CSDirectMessageToInline===e.type),e)){const{type:t,payload:s}=e.payload;d({id:`${e.id}--${e.type}`,type:t,payload:s},!1)}}}},232:(e,t,s)=>{s.d(t,{Z:()=>h});var n=s(925),r=s(467),a=s(531),o=s(977),i=s(138),c=s(877),l=s(989),u=s(168),d=s(341);let p;class h extends n.G{static extensionDefaultPosition={top:0,left:0,width:480,height:480};defaultWatchers={[r.nB.Accounts]:["actor.user.name"],[r.nB.Assets]:["device.name"]};extensionDefaultPosition=h.extensionDefaultPosition;static normalizedValue(e){const t=(0,i.bT)(e)?parseFloat(e):e;return"number"==typeof t?t:`'${t.replace(/'/g,'"')}'`}static id=o.WM.Athena;static buildQueryParts(e,t,s){return(0,c.AX)(t,(()=>"exclude"===e?" != ":" = "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>e,rightOperand:e=>h.normalizedValue(e)},s?"where":void 0)}buildQueryParts(e,t,s){return h.buildQueryParts(e,t,s)}static connectInlineListener(){(0,c.xJ)("script",document.body,{attributes:{src:(0,d.t)(u.ml),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){(0,l.N)(a._.OnMessage,(async e=>{n.G.processInlineListeners(e)})),p.debug().log("listeners were set")}connect(){h.setListeners(),h.connectInlineListener(),p.debug().log("connected")}getID(){return h.id}getName(){return o.if.Athena}}p=s(943).Et.addPrefix(h.id)},296:(e,t,s)=>{s.d(t,{l:()=>g});var n=s(531),r=s(977),a=s(467),o=s(138),i=s(877),c=s(989),l=s(441),u=s(168),d=s(341),p=s(925);let h;class g extends p.G{static normalizedValue=e=>"number"==typeof e?e:(0,o.bT)(e)?String(parseFloat(e)):`"${e.replace(/"/g,'\\"')}"`;static buildQueryParts(e,t,s){const n="AND",r=(0,i.AX)(t,((t,s)=>s.indexOf("EET")>-1&&(0,o.J_)(s.split("EET").shift())?"exclude"===e?" <= ":" >= ":"exclude"===e?" != ":" = "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>e,rightOperand:e=>g.normalizedValue(e)},s&&"include"!==e?n:void 0);return"include"===e&&s?r.indexOf(" OR ")>-1?`${n} (${r})`:`${n} ${r}`:r}buildQueryParts(e,t,s){return g.buildQueryParts(e,t,s)}connect(){g.setListeners(),h.debug().log("connected")}static id=r.WM.ArcSight;defaultWatchers={[a.nB.Accounts]:["sourceUserName","destinationUserName"],[a.nB.Assets]:["sourceAddress","destinationAddress"]};static extensionDefaultPosition={top:0,left:0,width:480,height:480};extensionDefaultPosition=g.extensionDefaultPosition;getID(){return g.id}getName(){return r.if.ArcSight}static connectInlineListener(){(0,i.xJ)("script",document.body,{attributes:{src:(0,d.t)(u.yb),type:"text/javascript","data-type":"inline-listener"}}),h.debug().log("inline were set")}static setListeners(){(0,c.N)(n._.OnMessage,(async e=>{if(!document.querySelector("textarea#queryInput")&&!l.kF)return;const t=`script[src$="${u.yb}"]`;document.querySelector(t)||(g.connectInlineListener(),await(0,i.B7)(t)),p.G.processInlineListeners(e)})),h.debug().log("listeners were set")}}h=s(943).Et.addPrefix(g.id)},30:(e,t,s)=>{s.d(t,{x:()=>p});var n=s(925),r=s(977),a=s(467),o=s(531),i=s(989),c=s(877),l=s(341),u=s(168);let d;class p extends n.G{static id=r.WM.Chronicle;static platformName=r.if.Chronicle;defaultWatchers={[a.nB.Accounts]:["user","principal.user.userid","target.user.userid","source.user.userid"],[a.nB.Assets]:["hostname","IP","src.ip","dst.ip","target.asset.hostname","target.hostname","source.hostname","source.asset.hostname","principal.ip"]};static extensionDefaultPosition={top:0,left:0,width:480,height:480};extensionDefaultPosition=p.extensionDefaultPosition;static normalizedValue=e=>`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`;static buildQueryParts(e,t,s=!1){let n="include"===e?"AND (":"AND";return"show all"===e&&(n=""),`${(0,c.AX)(t,(()=>"exclude"===e?" != ":" = "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":") AND (",{leftOperand:e=>e,rightOperand:e=>p.normalizedValue(e)},s?n:void 0)} ${"exclude"===e?"":")"}`}buildQueryParts(e,t,s){return p.buildQueryParts(e,t,s)}static connectInlineListener(){(0,c.xJ)("script",document.body,{attributes:{src:(0,l.t)(u.t3),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){(0,i.N)(o._.OnMessage,(async e=>{n.G.processInlineListeners(e)})),d.debug().log("listeners were set")}connect(){p.setListeners(),p.connectInlineListener(),d.debug().log("connected")}getID(){return p.id}getName(){return p.platformName}}d=s(943).Et.addPrefix(p.id)},546:(e,t,s)=>{s.d(t,{c:()=>h});var n=s(531),r=s(467),a=s(977),o=s(138),i=s(877),c=s(168),l=s(989),u=s(341),d=s(925);let p;class h extends d.G{defaultWatchers={[r.nB.Accounts]:["user.name","related.user","user.full_name","winlog.event_data.SubjectUserName","winlog.event_data.TargetUserName","winlog.user.name"],[r.nB.Assets]:["host.hostname","host.name","winlog.computer_name"]};static id=a.WM.Elastic;static extensionDefaultPosition={top:0,left:0,width:480,height:480};static normalizedValue=e=>{const t=(0,o.bT)(e)?parseFloat(e):String(e).trim();return"number"==typeof t||"("===t[0]||")"===t[t.length-1]?t:`"${t.replace(/"/g,'\\"')}"`};static buildQueryParts(e,t,s=!1){const n="include"===e?"AND":"AND NOT",r={};return Object.keys(t).forEach((e=>{t[e].length>1?r[e]=[`(${t[e].map((e=>h.normalizedValue(e))).join(" OR ")})`]:r[e]=t[e]})),(0,i.AX)(r,(()=>":"),"exclude"===e?" AND NOT ":" OR ","exclude"===e?" AND NOT ":" AND ",{leftOperand:e=>e,rightOperand:e=>h.normalizedValue(e)},s?n:void 0)}extensionDefaultPosition=h.extensionDefaultPosition;getID(){return h.id}getName(){return a.if.Elastic}static setListeners(){(0,l.N)(n._.OnMessage,(e=>{d.G.processInlineListeners(e)})),p.debug().log("listeners were set")}static connectInlineListener(){(0,i.xJ)("script",document.body,{attributes:{src:(0,u.t)(c.p6),type:"text/javascript","data-type":"inline-listener"}}),p.debug().log("inline mounted")}connect(){h.setListeners(),h.connectInlineListener(),p.debug().log("connected")}buildQueryParts(e,t,s){return h.buildQueryParts(e,t,s)}}p=s(943).Et.addPrefix(h.id)},850:(e,t,s)=>{s.d(t,{J:()=>h});var n=s(925),r=s(977),a=s(467),o=s(138),i=s(877),c=s(341),l=s(168),u=s(989),d=s(531);let p;class h extends n.G{static id=r.WM.LogScale;static platformName=r.if.LogScale;defaultWatchers={[a.nB.Accounts]:["windows.UserID","windows.EventData.User","windows.EventData.SubjectUserName"],[a.nB.Assets]:["@collect.host","windows.Computer","windows.EventData.DestinationIp","windows.EventData.DestinationHostname","windows.EventData.SourceIp","windows.EventData.SourceHostname"]};extensionDefaultPosition={top:0,left:0,width:480,height:480};static normalizedValue(e){const t=(0,o.bT)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}static buildQueryParts(e,t,s=!1){const n="exclude"===e?"NOT":"",r=Object.keys(t).reduce(((e,s)=>(t[s]?.length>1?e[`$$$${s}`]=[`$$$in(field="${s}", values=${JSON.stringify(t[s].map((e=>(0,o.bT)(e)?parseInt(e,10):e)))})`]:e[s]=t[s],e)),{});return(0,i.AX)(r,(e=>"$"===e[0]&&"$"===e[1]&&"$"===e[2]?"":" = "),"exclude"===e?" | NOT ":" | ","exclude"===e?" | NOT ":" | ",{leftOperand:e=>"$"===e[0]&&"$"===e[1]&&"$"===e[2]?"":e,rightOperand:e=>"string"==typeof e&&"$"===e[0]&&"$"===e[1]&&"$"===e[2]?e.substring(3,e.length):h.normalizedValue(e)},s?n:void 0)}buildQueryParts(e,t,s){return h.buildQueryParts(e,t,s)}static connectInlineListener(){(0,i.xJ)("script",document.body,{attributes:{src:(0,c.t)(l.L),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){(0,u.N)(d._.OnMessage,(async e=>{n.G.processInlineListeners(e)})),p.debug().log("listeners were set")}connect(){h.setListeners(),h.connectInlineListener(),p.debug().log("connected")}getID(){return h.id}getName(){return h.platformName}}p=s(943).Et.addPrefix(h.id)},486:(e,t,s)=>{s.d(t,{W:()=>h});var n=s(531),r=s(977),a=s(989),o=s(877),i=s(168),c=s(467),l=s(138),u=s(341),d=s(925);let p;class h extends d.G{defaultWatchers={[c.nB.Accounts]:["AccountName","InitiatingProcessAccountName","RequestAccountName","InitiatingProcessAccountSid","RequestAccountName"],[c.nB.Assets]:["DeviceName","AccountDomain","InitiatingProcessAccountDomain"]};static id=r.WM.MicrosoftDefender;static extensionDefaultPosition={top:0,left:0,width:480,height:480};static buildQueryParts(e,t,s=!1){return(0,o.AX)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>h.normalizedValue(e)},s?"where":void 0)}static normalizedValue=e=>{const t=(0,l.bT)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`};buildQueryParts(e,t,s){return h.buildQueryParts(e,t,s)}extensionDefaultPosition=h.extensionDefaultPosition;getID(){return h.id}getName(){return r.if.MicrosoftDefender}static setListeners(){(0,a.N)(n._.OnMessage,(e=>{d.G.processInlineListeners(e)})),p.debug().log("listeners were set")}static connectInlineListener(){(0,o.xJ)("script",document.body,{attributes:{src:(0,u.t)(i.YX),type:"text/javascript","data-type":"inline-listener"}})}connect(){h.setListeners(),h.connectInlineListener(),p.debug().log("connected")}}p=s(943).Et.addPrefix(h.id)},126:(e,t,s)=>{s.d(t,{c:()=>g});var n=s(977),r=s(531),a=s(989),o=s(877),i=s(441),c=s(168),l=s(138),u=s(467),d=s(341),p=s(925);let h;class g extends p.G{static id=n.WM.MicrosoftSentinel;static extensionDefaultPosition={top:0,left:0,width:500,height:400};static normalizedValue(e){const t=(0,l.bT)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}static buildQueryParts(e,t,s=!1){return(0,o.AX)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>g.normalizedValue(e)},s?"where":void 0)}defaultWatchers={[u.nB.Accounts]:["UserName","Account","SubjectUserName","TargetUserName","UserDisplayName","UserPrincipalName","UPN","Identity","Name","FullName","NTDomain","UPNSuffix","Sid","AadUserId","DisplayName"],[u.nB.Assets]:["Computer","DeviceName","HostName","FullDisplayName","ServicePrincipalName","DnsDomain","NetBiosName","OMSAgentID"]};extensionDefaultPosition=g.extensionDefaultPosition;buildQueryParts(e,t,s){return g.buildQueryParts(e,t,s)}getID(){return g.id}getName(){return n.if.MicrosoftSentinel}static connectInlineListener(){(0,o.xJ)("script",document.body,{attributes:{src:(0,d.t)(c.DH),type:"text/javascript","data-type":"inline-listener"}})}static setListeners(){(0,a.N)(r._.OnMessage,(async e=>{if(!i.kF&&!document.querySelector("la-main-view"))return;const t=`script[src$="${c.DH}"]`;document.querySelector(t)||(g.connectInlineListener(),await(0,o.B7)(t)),p.G.processInlineListeners(e)})),h.debug().log("listeners were set")}connect(){g.setListeners(),h.debug().log("connected")}}h=s(943).Et.addPrefix(g.id)},249:(e,t,s)=>{s.d(t,{U:()=>h});var n=s(531),r=s(467),a=s(977),o=s(138),i=s(877),c=s(168),l=s(989),u=s(341),d=s(925);let p;class h extends d.G{defaultWatchers={[r.nB.Accounts]:["user.name","related.user","user.full_name","winlog.event_data.SubjectUserName","winlog.event_data.TargetUserName","winlog.user.name"],[r.nB.Assets]:["host.hostname","host.name","winlog.computer_name"]};static id=a.WM.OpenSearch;static extensionDefaultPosition={top:0,left:0,width:480,height:480};static normalizedValue=e=>{const t=(0,o.bT)(e)?parseFloat(e):String(e).trim();return"number"==typeof t||"("===t[0]||")"===t[t.length-1]?t:`"${t.replace(/"/g,'\\"')}"`};static buildQueryParts(e,t,s=!1){const n="include"===e?"AND":"AND NOT",r={};return Object.keys(t).forEach((e=>{t[e].length>1?r[e]=[`(${t[e].map((e=>h.normalizedValue(e))).join(" OR ")})`]:r[e]=t[e]})),(0,i.AX)(r,(()=>":"),"exclude"===e?" AND NOT ":" OR ","exclude"===e?" AND NOT ":" AND ",{leftOperand:e=>e,rightOperand:e=>h.normalizedValue(e)},s?n:void 0)}extensionDefaultPosition=h.extensionDefaultPosition;getID(){return h.id}getName(){return a.if.OpenSearch}static setListeners(){(0,l.N)(n._.OnMessage,(e=>{d.G.processInlineListeners(e)})),p.debug().log("listeners were set")}static connectInlineListener(){(0,i.xJ)("script",document.body,{attributes:{src:(0,u.t)(c.qi),type:"text/javascript","data-type":"inline-listener"}}),p.debug().log("inline mounted")}connect(){h.setListeners(),h.connectInlineListener(),p.debug().log("connected")}buildQueryParts(e,t,s){return h.buildQueryParts(e,t,s)}}p=s(943).Et.addPrefix(h.id)},707:(e,t,s)=>{s.d(t,{k:()=>i});var n=s(977),r=s(441),a=s(138);class o{storage=new Map;set(e,t){return this.storage.set(e,t),t}get(e){return this.storage.get(e)}remove(e){return!!this.storage.has(e)&&(this.storage.delete(e),!0)}has(e){return this.storage.has(e)}}const i=new class{platforms;getPlatformByID(e){if(!this.platforms.get(e))switch(e){case n.WM.Athena:this.platforms.set(e,new(s(232).Z));break;case n.WM.MicrosoftSentinel:this.platforms.set(e,new(s(126).c));break;case n.WM.MicrosoftDefender:this.platforms.set(e,new(s(486).W));break;case n.WM.Splunk:this.platforms.set(e,new(s(157).H));break;case n.WM.QRadar:this.platforms.set(e,new(s(332).J));break;case n.WM.Elastic:this.platforms.set(e,new(s(546).c));break;case n.WM.OpenSearch:this.platforms.set(e,new(s(249).U));break;case n.WM.ArcSight:this.platforms.set(e,new(s(296).l));break;case n.WM.LogScale:this.platforms.set(e,new(s(850).J));break;case n.WM.Chronicle:this.platforms.set(e,new(s(30).x));break;default:return}return this.platforms.get(e)}resolveByUrl(e){const{host:t,protocol:s,href:o}=new URL(e);if((0,a.iV)(s,r.xJ))return/(aws.amazon.com\/athena\/)/.test(o)?this.getPlatformByID(n.WM.Athena):/(portal.azure.com|reactblade.portal.azure.net|logsextension.hosting.portal.azure.net)$/.test(t)?this.getPlatformByID(n.WM.MicrosoftSentinel):/(security.microsoft.com\/)/.test(o)?this.getPlatformByID(n.WM.MicrosoftDefender):/(console\/qradar\/jsp\/QRadar.jsp|console\/do\/ariel\/arielSearch)/.test(o)?this.getPlatformByID(n.WM.QRadar):/(\/\w\w\w\/ui-phoenix\/com.arcsight.phoenix.PhoenixLauncher|logger\/search\.ftl)/.test(o)?this.getPlatformByID(n.WM.ArcSight):void 0}resolveByContent(){return document.querySelector('a[aria-label^="splunk"]')?this.getPlatformByID(n.WM.Splunk):document.querySelector('a.euiHeaderLogo[aria-label^="Elastic"]')||document.querySelector("#kibana-body")?this.getPlatformByID(n.WM.Elastic):document.querySelector("#opensearch-dashboards-body")?this.getPlatformByID(n.WM.OpenSearch):document.querySelector('head > meta[name~="humio-version"]')?this.getPlatformByID(n.WM.LogScale):document.getElementById("chronicle-logo")||document.getElementById("chronicle-alert")||document.title?.toLowerCase()?.indexOf("chronicle")>-1?this.getPlatformByID(n.WM.Chronicle):void 0}constructor(){this.platforms=new o}resolve(){return r.kF?this.getPlatformByID(r.kF):this.resolveByUrl(document.location.href)||this.resolveByContent()}}},332:(e,t,s)=>{s.d(t,{J:()=>h});var n=s(531),r=s(977),a=s(467),o=s(877),i=s(138),c=s(989),l=s(168),u=s(341),d=s(925);let p;class h extends d.G{static normalizedValue(e){const t=(0,i.bT)(e)?parseFloat(e):e;return"number"==typeof t?t:`'${t.replace(/'/g,'"')}'`}buildQueryParts(e,t,s=!1){return(0,o.AX)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" AND ":" OR ","exclude"===e?" AND ":" OR ",{leftOperand:e=>`"${e}"`,rightOperand:e=>h.normalizedValue(e)},s?"where":void 0)}connect(){h.setListeners(),p.debug().log("connected")}static setListeners(){(0,c.N)(n._.OnMessage,(async e=>{if(!document.querySelector("#aceEditor"))return;const t=`script[src$="${l.yO}"]`;document.querySelector(t)||(h.connectInlineListener(),await(0,o.B7)(t)),d.G.processInlineListeners(e)}))}static connectInlineListener(){(0,o.xJ)("script",document.body,{attributes:{src:(0,u.t)(l.yO),type:"text/javascript","data-type":"inline-listener"}})}static extensionDefaultPosition={top:0,left:0,width:500,height:400};defaultWatchers={[a.nB.Accounts]:["Account Name","Recipients","Sender","Target Username","Username"],[a.nB.Assets]:["Client Hostname","Destination Hostname","Destination IP","Hostname","Machine Identifier","Recipient Host","Sender Host","Source Hostname","Source Workstation","Source IP","Source Asset Name","Destination Asset Name"]};extensionDefaultPosition=h.extensionDefaultPosition;static id=r.WM.QRadar;getID(){return r.WM.QRadar}getName(){return r.if.QRadar}}p=s(943).Et.addPrefix(h.id)},157:(e,t,s)=>{s.d(t,{H:()=>g});var n=s(531),r=s(977),a=s(989),o=s(877),i=s(168),c=s(467),l=s(138),u=s(869),d=s(341),p=s(925);let h;class g extends p.G{defaultWatchers={[c.nB.Accounts]:(0,u.ZJ)(["src_user","src_user_bunit","user","Account_Name","User","src_user_name","user_name"]),[c.nB.Assets]:(0,u.ZJ)(["dest_host","dst","dest_nt_host","src_host","src_nt_host","src","dest","dest_name","dest_host","dvc","dvc_host","dest_dns","src_dns","ComputerName","DestinationHostname","SourceHostname"])};static id=r.WM.Splunk;static extensionDefaultPosition={top:0,left:0,width:480,height:480};static normalizedValue(e){const t=(0,l.bT)(e)?parseFloat(e):e;return"number"==typeof t?t:`"${t.replace(/"/g,'\\"')}"`}static buildQueryParts(e,t,s=!1){return(0,o.AX)(t,(()=>"exclude"===e?" != ":" == "),"exclude"===e?" and ":" or ","exclude"===e?" and ":" or ",{leftOperand:e=>e,rightOperand:e=>g.normalizedValue(e)},s?"where":void 0)}buildQueryParts(e,t,s){return g.buildQueryParts(e,t,s)}extensionDefaultPosition=g.extensionDefaultPosition;getID(){return g.id}getName(){return r.if.Splunk}static setListeners(){(0,a.N)(n._.OnMessage,(e=>{p.G.processInlineListeners(e)}))}static connectInlineListener(){(0,o.xJ)("script",document.body,{attributes:{src:(0,d.t)(i.le),type:"text/javascript","data-type":"inline-listener"}})}connect(){g.setListeners(),g.connectInlineListener(),h.debug().log("connected")}}h=s(943).Et.addPrefix(g.id)},989:(e,t,s)=>{s.d(t,{N:()=>u});var n,r=s(531),a=s(981),o=s(923);!function(e){e[e.debugIDExternal=(0,a.mr)(process.env.DEBUG_ID||o.qK)]="debugIDExternal"}(n||(n={}));var i=s(5),c=s(341);const l={},u=(e,t,...s)=>{l[e]?.(((...e)=>{t(...e)}),...s)},d=[];l[r._.OnMessage]=(e,...t)=>{if((0,i.PW)()){const s=(0,c.B)().runtime.onMessage;d.push((()=>{s.removeListener(e)})),s.addListener(((...t)=>{e(...t)}),...t)}if(!(0,i.sp)())return;const s=s=>{const r=s.data;s.origin!==window.location.origin||"content"!==(0,o.k$)(r.type)&&r.externalType!==n.debugIDExternal||e(s.data,...t)};d.push((()=>{window.removeEventListener("message",s)})),window.addEventListener("message",s)}},531:(e,t,s)=>{var n;s.d(t,{_:()=>n}),function(e){e.OnMessage="OnMessage"}(n||(n={}))},246:(e,t,s)=>{s.d(t,{$:()=>n});var n,r=s(923);!function(e){e.ISModifyQuery="ISModifyQuery",e.ISSetQuery="ISSetQuery",e.ISGetQuery="ISGetQuery",e.ISSetDebugMode="ISSetDebugMode",e.ISRemoveHash="ISRemoveHash",e.ISRemoveFieldSpecification="ISRemoveFieldSpecification"}(n||(n={})),Object.values(n).forEach((e=>{if("inline"!==(0,r.k$)(e))throw new Error(`Wrong inline message type "${e}"`)}))},168:(e,t,s)=>{s.d(t,{DH:()=>r,L:()=>p,YX:()=>a,le:()=>i,ml:()=>o,p6:()=>l,qi:()=>d,t3:()=>h,yO:()=>c,yb:()=>u});var n=s(977);const r="inline-microsoft-sentinel.js",a="inline-microsoft-defender.js",o="inline-amazon-athena.js",i="inline-splunk.js",c="inline-qradar.js",l="inline-elastic.js",u="inline-arcsight.js",d="inline-opensearch.js",p="inline-logscale.js",h="inline-chronicle.js";n.WM.MicrosoftSentinel,n.WM.MicrosoftDefender,n.WM.Splunk,n.WM.QRadar,n.WM.Elastic,n.WM.ArcSight,n.WM.Athena,n.WM.OpenSearch,n.WM.LogScale,n.WM.Chronicle}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=s(869);const t=e=>{n(e,">>")},n=(e,t="")=>(console.log(`[INFO]: ${t||"#"}${e}`),e),r=(e,t="")=>(console.warn(`[SUCCESS]: ${t||"#"}${e}`),e),a=(e,t="")=>(console.error(`[ERROR]: ${t||"#"}${e}`),e),o=(e,t=!0)=>({expect:s=>({toEqual:n=>{if(window.byPassTests)console.log(`[ByPass]: #${e}: >${s}<`);else{if(console.log(`[toEqual]: ${e}\r\npassed value:\r\n>${String(s)}<`),n!==s)throw a(e),new Error(a(`\r\n>${String(s)}<\r\n<NOT EQUAL>\r\n>${String(n)}<`));t&&r(e)}}})});var i,c=s(923);!function(e){e.AppShowExtension="AppShowExtension",e.AppTakeResourceData="AppTakeResourceData",e.AppTakeNewResourceData="AppTakeNewResourceData",e.AppSyncWatchers="AppSyncWatchers",e.AppQueryHasHash="AppQueryHasHash",e.AppQueryHasSpecifyFields="AppQueryHasSpecifyFields",e.AppSetLoadingState="AppSetLoadingState",e.AppToggleShowExtension="AppToggleShowExtension",e.AppSendToBackground="AppSendToBackground",e.AppSendMessageOutside="AppSendMessageOutside",e.AppTakeQuery="AppTakeQuery",e.AppSetDebugMode="AppSetDebugMode",e.AppGetIntegrationWorkResult="AppGetIntegrationWorkResult"}(i||(i={})),Object.values(i).forEach((e=>{if("app"!==(0,c.k$)(e))throw new Error(`Wrong app message type "${e}"`)}));const l=[{id:"virus-total",name:"VirusTotal",url:"https://www.virustotal.com/gui/search/$VALUE$"},{id:"virus-total-enterprise",name:"VirusTotal Enterprise",url:"https://www.virustotal.com/gui/search/$VALUES$"},{id:"anomali",name:"Anomali",url:"https://ui.threatstream.com/search?status=active&multiSearchResults=true&value__re=.*$VALUE$.*"},{id:"$echo-trail",name:"EchoTrail",url:"https://www.echotrail.io/insights/search/$VALUE$"},{id:"$ultimate-windows-security",name:"Ultimate Windows Security",url:"https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=$VALUE$"},{id:"$cyber-chef$",name:"CyberChef",url:"https://gchq.github.io/CyberChef/#input=$BASE64-VALUE$"},{id:"$cyber-chef-magic$",name:"CyberChef (Magic)",url:"https://gchq.github.io/CyberChef/#recipe=Magic(3,false,false,'')&input=$BASE64-VALUE$"},{id:"abuse-ipdb",name:"AbuseIPDB",url:"https://www.abuseipdb.com/check/$VALUE$"},{id:"url-haus",name:"URLhaus (by Abuse.ch)",url:"https://urlhaus.abuse.ch/browse.php?search=$VALUE$"},{id:"malware-bazaar-md5",name:"MalwareBazaar MD5 (by Abuse.ch)",url:"https://bazaar.abuse.ch/browse.php?search=md5:$VALUE$"},{id:"malware-bazaar-sha256",name:"MalwareBazaar SHA256 (by Abuse.ch)",url:"https://bazaar.abuse.ch/browse.php?search=sha256:$VALUE$"},{id:"threat-fox-iocs",name:"ThreatFox IOCs (by Abuse.ch)",url:"https://threatfox.abuse.ch/browse.php?search=ioc:$VALUE$"},{id:"feodo-tracker-c&c",name:"FeodoTracker C&C (by Abuse.ch)",url:"https://feodotracker.abuse.ch/browse.php?search=$VALUE$"},{id:"shodan",name:"Shodan",url:"https://www.shodan.io/search?query=$VALUE$"},{id:"$open-cti$",name:"OpenCTI",url:"https://HOSTNAME:PORT/dashboard/observations/indicators?sortBy=created&orderAsc=false&searchTerm=$VALUE$"}],u=(l.reduce(((e,t)=>("$"===t.id[0]&&e.set(t.id,t),e)),new Map),l.reduce(((e,t)=>(e.set(t.id,t),e)),new Map),"the-prime-hunt--extension--watchers");var d=s(822),p=s(246);const h=(e,t)=>{const s=window;s.scenarioFunctions||(s.scenarioFunctions={}),s.scenarioFunctions[e]=t},g=async()=>{h("showExtension",g),window.postMessage({type:i.AppShowExtension,externalType:c.qK,testMode:!0}),await(0,e._v)(.3)},m=()=>(h("getWatchers",m),JSON.parse(localStorage.getItem(u)||"{}")),w=e=>{localStorage.setItem(u,JSON.stringify(e))},f=()=>(h("getTestData",f),{Accounts:{test0:["account1","2","test\\domain.com","4",'"process.exe" -a -g https://some.site/some-page'],test2:["account2","2","4"],test3:["account3","test2","4"],test4:["account4","2","test2","4"],field:["2"]}}),b=async()=>{h("addNewTestResources",b),window.postMessage({type:i.AppTakeNewResourceData,externalType:c.qK,payload:{resources:f(),cacheID:"test-cache-id"}}),await(0,e._v)(1)},y=(e,t)=>{h("addElementToWindow",y);const s=window;return s.scenariosElements||(s.scenariosElements={}),s.scenariosElements[e]=t,t},A=(e=!0)=>{h("getExtensionRoot",A);const t=document.querySelector('div[style^="all:initial;"]')?.shadowRoot;if(!t&&e)throw new Error(a("No root"));return y("root",t)},S=(e=!0)=>{h("getBulkResourcesPanel",S);const t=A(e).querySelector(".bulk-resources-panel");if(!t&&e)throw new Error(a("No bulk resource panel"));return y("bulkResourcePanel",t)},x=(e=!0)=>{h("getIncludeBulkResourceButton",x);const t=S(e),s=t.querySelector(".plus-icon")?.closest("button");if(!s&&e)throw new Error(a("No include bulk resource button"));return y("includeBulkResourceButton",s)},v=(e=!0)=>{h("getExcludeBulkResourceButton",v);const t=S(e),s=t.querySelector(".minus-icon")?.closest("button");if(!s&&e)throw new Error(a("No exclude bulk resource button"));return y("excludeBulkResourceButton",s)},E=(e=!0)=>{h("getShowAllBulkResourceButton",E);const t=S(e),s=t.querySelector(".see-document-icon")?.closest("button");if(!s&&e)throw new Error(a("No show all bulk resource button"));return y("showAllBulkResourceButton",s)},D=(e=!0)=>{h("getPlatformResources",D);const t=A(e).querySelector(".platform-resources");if(!t&&e)throw new Error(a("No platform resources"));return y("platformResources",t)},N=(e,t=!0)=>{h("getResourceCollapsibleByHeaderText",N);const s=D(t),n=Array.from(s.querySelectorAll(".collapsible-header .resource-field-name .field-name")||[]).find((t=>t.innerText===e))?.closest(".collapsible");if(!n&&t)throw new Error(a(`No collapsible resource queried by text >${e}<`));return y("resourcesCollapsible",n)},B=(e,t=!0)=>{h("getResourceCollapsibleHeader",B);const s=e.querySelector(".collapsible-header");if(!s&&t)throw new Error(a("No collapsible resource header"));return y("resourceCollapsibleHeader",s)},I=(e,t=!0)=>{h("getResourceCollapsibleRemoveButton",I);const s=e.querySelector(".waste-basket-icon");if(!s&&t)throw new Error(a("No resource collapsible remove button"));return y("resourceCollapsibleRemoveButton",s)},M=(e,t=!0)=>{h("getResourceListItem",M);const s=e.querySelector(".resource-list-item");if(!s&&t)throw new Error(a("No resource list item"));return y("resourceListItem",s)},k=(e,t=!0)=>{h("getIncludeButton",k);const s=e.querySelector(".plus-icon");if(!s&&t)throw new Error(a(`No include button in ${e.outerHTML}`));return y("includeButton",s)},O=(e,t=!0)=>{h("getExcludeButton",O);const s=e.querySelector(".minus-icon");if(!s&&t)throw new Error(a(`No exclude button in ${e.outerHTML}`));return y("excludeButton",s)},$=(e,t=!0)=>{h("getShowAllButton",$);const s=e.querySelector(".see-document-icon");if(!s&&t)throw new Error(a(`No show all button in ${e.outerHTML}`));return y("showAllButton",s)},P=(e=!0)=>{h("getAddNewResourceTabButton",P);const t=A(e).querySelector(".add-new-tab-button");if(!t&&e)throw new Error(a("No add new tab button"));return y("addNewResourceTabButton",t)},T=(e=!0)=>{h("getResourcesTabsPanel",T);const t=A(e).querySelector(".tabs-platform-resources");if(!t&&e)throw new Error(a("No resources tabs panel"));return y("resourcesTabsPanel",t)},R=(e=!0)=>{h("getActiveResourcesTab",R);const t=T(e).querySelector(".tab.active");if(!t&&e)throw new Error(a("No active resources tab"));return y("activeResourcesTab",t)},L=(e=!0)=>{h("getInputInActiveResourceTab",L);const t=R(e).querySelector("input");if(!t&&e)throw new Error(a("No input active resources tab"));return y("inputActiveResourcesTab",t)},_=(e=!0)=>{h("getApplyButtonInActiveResourceTab",_);const t=R(e).querySelector(".check-icon");if(!t&&e)throw new Error(a("No apply button in active resource tab"));return y("applyButtonInActiveResourceTab",t)},q=(e=!0)=>{h("getAddNewFieldButton",q);const t=A(e),s=t?.querySelector(".add-new-field");if(!s&&e)throw new Error(a("No add new field button"));return y("addNewFieldButton",s)},W=(e=!0)=>{h("addNewFieldInput",W);const t=A(e),s=t?.querySelector(".add-field-input-wrapper input");if(!s&&e)throw new Error(a("No add new field input"));return y("newFieldInput",s)},V=(e=!0)=>{h("getApplyAddNewFieldButton",V);const t=A(e),s=t?.querySelector(".add-field-input-wrapper .check-icon");if(!s&&e)throw new Error(a("No apply add new field button"));return y("addNewFieldButton",s)},C=(e=!0)=>{h("getDeleteResourceTabButton",C);const t=T(e),s=t?.querySelector(".waste-basket-icon");if(!s&&e)throw new Error(a("No delete resource tab button"));return y("deleteResourceTabButton",s)},Q=(e,t=!0)=>{h("getResourcesTabByTitle",Q);const s=A(t),n=Array.from(s?.querySelectorAll(".virtual-input")||[]).find((t=>t.innerText===e))?.closest(".tab");if(!n&&t)throw new Error(a(`No resource tab queried by title: >${e}<`));return y("resourceTab",n)},G=e=>(t,s,n)=>{const r=t.getBoundingClientRect(),a=new MouseEvent(e,{view:window,bubbles:!0,cancelable:!0,clientX:r.left+s,clientY:r.top+n});t.dispatchEvent(a)},j=e=>{const{x:t,y:s}=e.getBoundingClientRect();return{x:t,y:s}},U=e=>{const{x:t,y:s}=j(e);G("click")(e,t,s)},F=e=>{const{x:t,y:s}=j(e);G("mousemove")(e,t,s),G("mouseover")(e,t,s)},H={getValue:()=>Promise.resolve("not set"),clearValue:()=>Promise.resolve(),messages:{testIncludeAction:"",test2ExcludeBulkAction:"",test2IncludeBulkAction:"",test2ShowAllBulkAction:"",testExcludeAction:"",testExcludeBulkAction:"",testIncludeBulkAction:"",testShowAllAction:"",testShowAllBulkAction:""}},z=async()=>{await g(),await(async()=>{document.querySelector('div[style^="all:initial"]')?.shadowRoot?.querySelector("div.tabs-platform-resources-wrapper div.tab:nth-child(2) > button")?.click?.(),await(0,e._v)(.3)})(),await b();const s=B(N("test0"));s.click(),await(0,e._v)(.3),await(async()=>{t("start test `testIncludeAction`"),await H.clearValue(),await(0,e._v)(.1);const s=M(N("test0"));F(s),await(0,e._v)(.3);const n=k(s);await(0,e._v)(.1),U(n),await(0,e._v)(.3);const r=await H.getValue();o("Include resource action test").expect(r.trim()).toEqual(H.messages.testIncludeAction),t("end test `testIncludeAction`")})(),await(async()=>{t("start test `testExcludeAction`"),await H.clearValue(),await(0,e._v)(.1);const s=M(N("test0"));F(s),await(0,e._v)(.3);const n=O(s);await(0,e._v)(.1),U(n),await(0,e._v)(.3);const r=await H.getValue();o("Exclude resource action test").expect(r.trim()).toEqual(H.messages.testExcludeAction),t("end test `testExcludeAction`")})(),await(async()=>{t("start test `testShowAllAction`"),await H.clearValue(),await(0,e._v)(.1);const s=M(N("test0"));F(s),await(0,e._v)(.3);const n=$(s);await(0,e._v)(.1),U(n),await(0,e._v)(.3);const r=await H.getValue();o("Show all resource action test").expect(r.trim()).toEqual(H.messages.testShowAllAction),t("end test `testShowAllAction`")})();let n=s.querySelector(".checker-wrapper");o("headerCheckbox availability test",!1).expect(!!n).toEqual(!0),n.click(),await(0,e._v)(.1),await(async()=>{t("start test `testIncludeBulkAction`"),await H.clearValue();const s=x();await(0,e._v)(.1),s.click(),await(0,e._v)(.3);const n=await H.getValue();o("Bulk include resource action test").expect(n.trim()).toEqual(H.messages.testIncludeBulkAction),t("end test `testIncludeBulkAction`")})(),await(async()=>{t("start test `testExcludeBulkAction`"),await H.clearValue();const s=v();await(0,e._v)(.1),s.click(),await(0,e._v)(.3);const n=await H.getValue();o("Bulk exclude resource action test").expect(n.trim()).toEqual(H.messages.testExcludeBulkAction),t("end test `testExcludeBulkAction`")})(),await(async()=>{t("start test `testShowAllBulkAction`"),await H.clearValue();const s=E();await(0,e._v)(.1),s.click(),await(0,e._v)(.3);const n=await H.getValue();o("Bulk show all resource action test").expect(n.trim()).toEqual(H.messages.testShowAllBulkAction),t("end test `testShowAllBulkAction`")})();const a=B(N("test2"));a.click(),await(0,e._v)(.1),n=a.querySelector(".checker-wrapper"),o("headerCheckbox2 availability test",!1).expect(!!n).toEqual(!0),n.click(),await(0,e._v)(.1),await(async()=>{t("start test `test2IncludeBulkAction`"),await H.clearValue();const s=x();await(0,e._v)(.1),s.click(),await(0,e._v)(.3);const n=await H.getValue();o("Bulk include resource action test2").expect(n.trim()).toEqual(H.messages.test2IncludeBulkAction),t("end test `test2IncludeBulkAction`")})(),await(async()=>{t("start test `test2ExcludeBulkAction`"),await H.clearValue();const s=v();await(0,e._v)(.1),s.click(),await(0,e._v)(.3);const n=await H.getValue();o("Bulk exclude resource action test2").expect(n.trim()).toEqual(H.messages.test2ExcludeBulkAction),t("end test `test2ExcludeBulkAction`")})(),await(async()=>{t("start test `test2ShowAllBulkAction`"),await H.clearValue();const s=E();await(0,e._v)(.1),s.click(),await(0,e._v)(.3);const n=await H.getValue();o("Bulk show all resource action test2").expect(n.trim()).toEqual(H.messages.test2ShowAllBulkAction),t("end test `test2ShowAllBulkAction`")})(),await(async()=>{t("start test `testSetWatchers`");let s=m();void 0!==s["custom-test"]&&delete s["custom-test"],w(s),P().click(),await(0,e._v)(.3);const n=L();n.value="custom-test",n.dispatchEvent(new Event("change",{bubbles:!0})),U(_()),q().click(),await(0,e._v)(.3);const r=W();r.value="test-resource-name",r.dispatchEvent(new Event("change",{bubbles:!0}));const a=V();U(a),o("no custom watcher",!1).expect(void 0===s["custom-test"]).toEqual(!0),s=m(),o("Set watchers").expect(void 0!==s["custom-test"]&&'["test-resource-name"]'===JSON.stringify(s["custom-test"])).toEqual(!0),Q("custom-test").click(),await(0,e._v)(.3),(e=>{const{x:t,y:s}=j(e);G("dblclick")(e,t,s)})(L()),await(0,e._v)(.3),s=m(),o("exist custom watcher",!1).expect(void 0!==s["custom-test"]).toEqual(!0),U(C()),s=m(),o("no custom watcher 2",!1).expect(void 0===s["custom-test"]).toEqual(!0),w(s),t("end test `testSetWatchers`"),await(0,e._v)(.3)})(),await(async()=>{t("start test `testRemoveResourcesFields`");const s=f(),n=new Map;Object.keys(s).forEach((e=>{Object.keys(s[e]).forEach((t=>{const s=n.get(e)||new Set;s.add(t),n.set(e,s)}))}));for(const t of Array.from(n)){const[s,n]=t;for(const t of Array.from(n)){const n=I(N(t));let r=m();o(`exists fieldName >${t}< in type >${s}<`,!1).expect(r[s]?.includes(t)).toEqual(!0),U(n),await(0,e._v)(.3),r=m(),o(`not exists fieldName >${t}< in type >${s}<`,!1).expect(r[s]?.includes(t)).toEqual(!1)}}r("Remove resources fields"),t("end test `testRemoveResourcesFields`")})()};H.messages={testIncludeAction:'(TestTable) AND (test0 = "account1")',testExcludeAction:'(TestTable) AND test0 != "account1"',testShowAllAction:'(test0 = "account1")',testIncludeBulkAction:'(TestTable) AND (test0 = "account1" OR test0 = "2" OR test0 = "test\\\\domain.com" OR test0 = "4" OR test0 = "\\"process.exe\\" -a -g https://some.site/some-page")',testExcludeBulkAction:'(TestTable) AND test0 != "account1" AND test0 != "2" AND test0 != "test\\\\domain.com" AND test0 != "4" AND test0 != "\\"process.exe\\" -a -g https://some.site/some-page"',testShowAllBulkAction:'(test0 = "account1" OR test0 = "2" OR test0 = "test\\\\domain.com" OR test0 = "4" OR test0 = "\\"process.exe\\" -a -g https://some.site/some-page")',test2IncludeBulkAction:'(TestTable) AND (test0 = "account1" OR test0 = "2" OR test0 = "test\\\\domain.com" OR test0 = "4" OR test0 = "\\"process.exe\\" -a -g https://some.site/some-page") AND (test2 = "account2" OR test2 = "2" OR test2 = "4")',test2ExcludeBulkAction:'(TestTable) AND test0 != "account1" AND test0 != "2" AND test0 != "test\\\\domain.com" AND test0 != "4" AND test0 != "\\"process.exe\\" -a -g https://some.site/some-page" AND test2 != "account2" AND test2 != "2" AND test2 != "4"',test2ShowAllBulkAction:'(test0 = "account1" OR test0 = "2" OR test0 = "test\\\\domain.com" OR test0 = "4" OR test0 = "\\"process.exe\\" -a -g https://some.site/some-page") AND (test2 = "account2" OR test2 = "2" OR test2 = "4")'},H.clearValue=async()=>{await(async t=>{window.postMessage({type:i.AppSendToBackground,externalType:c.qK,payload:{type:d.P.BGDirectMessageToInline,payload:{type:p.$.ISSetQuery,payload:{value:"TestTable"}}}}),await(0,e._v)(.6)})()};let J=[];var X,K;H.getValue=async()=>{await(async()=>{window.postMessage({type:i.AppSendToBackground,externalType:c.qK,payload:{type:d.P.BGDirectMessageToInline,payload:{type:p.$.ISGetQuery}}}),await(0,e._v)(.6)})();const t=J.pop();if(!t)return"";const{queryValue:s}=t.payload;return s},X=e=>e.type===i.AppTakeQuery,K=()=>J,window.addEventListener("message",(e=>{const t=e.data;"MessageOutside"===t.outside&&X(t)&&K().push(t)})),(async()=>{J=[],await z(),r("ALL TESTS PASSED!")})()})()})();